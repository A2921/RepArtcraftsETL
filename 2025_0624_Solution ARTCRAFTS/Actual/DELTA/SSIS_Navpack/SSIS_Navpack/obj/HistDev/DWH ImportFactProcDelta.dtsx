<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="2/26/2024 12:35:33 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="SRVPOWERBITEST"
  DTS:CreatorName="ARTCRAFTS\powerbi02"
  DTS:DTSID="{62542B2D-F582-4438-87FC-EE04E7FC32CE}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="16.0.5270.0"
  DTS:LocaleID="1040"
  DTS:ObjectName="DWH ImportFactProcDelta"
  DTS:PackageType="5"
  DTS:VersionBuild="98"
  DTS:VersionGUID="{3FFD4EA1-699C-408A-A5AC-B1694E889A6C}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:Variables>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{269D464B-14DE-4DB1-995A-C62A49C680CB}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;MERGE [BI_Model_DWH].[dbo].[FactAffidamentoClienti] AS TARGET USING (&#xA;&#xA;SELECT [ClienteKey]&#xA;      ,[Company Code]&#xA;      ,[Update Date]&#xA;      ,[Amount]&#xA;      ,[Status]&#xA;      ,[Starting Date]&#xA;      ,[Data Visura Protesti]&#xA;      ,[Limit of Credit _]&#xA;      ,[Situation]&#xA;      ,[Memo]&#xA;      ,[Extra Credit]&#xA;      ,[Data Extra Credit]&#xA;      ,[Active]&#xA;      ,[Cerved Credit]&#xA;      ,[Memo 2]&#xA;      ,[Payment Times]&#xA;      ,[Negative Events]&#xA;      ,[Econ-Financial Situation]&#xA;      ,[Risk no consultations]&#xA;      ,[Revenues]&#xA;      ,[Purchases]&#xA;      ,[Mol]&#xA;      ,[Useful Loss]&#xA;      ,[Net Assets]&#xA;      ,[No_ Employees]&#xA;      ,[No_ Requests Last 12 Months]&#xA;      ,[Cash Flow]&#xA;      ,[Ebitda]&#xA;      ,[Inventories]&#xA;      ,[Payables to ML Banks Term]&#xA;      ,[Payables to Banks BT]&#xA;      ,[Payables to Vendors]&#xA;      ,[Other Liabilities]&#xA;      ,[Current Ratio]&#xA;      ,[Net Circular Capital]&#xA;      ,[Protests]&#xA;      ,[Preg Cons]&#xA;      ,[Email Certified]&#xA;      ,[Start Activity]&#xA;      ,[Secondary Seats No_]&#xA;      ,[Ateco Code]&#xA;      ,[Consistence Properties]&#xA;      ,[Insert Date]&#xA;      ,[Receipt Date]&#xA;      ,[Due Date]&#xA;      ,[Company]&#xA;  FROM [BI_Model_Stage].[stg].[vFactAffidamentoClienti] fct&#xA;  inner join ( SELECT MAX([MaxTimestamp]) as maxtimestamp from [BI_Model_Stage].cfg.Config_Delta) cfg&#xA;  on fct.timestamp &gt; cfg.maxtimestamp&#xA;     ) AS SOURCE &#xA;  ON   SOURCE.[ClienteKey]      = TARGET.[ClienteKey]  &#xA;  &#xA;  &#xA;  WHEN MATCHED&#xA;  THEN UPDATE SET &#xA;&#x9; &#xA;&#x9;  &#x9;&#x9;&#x9;&#x9;&#xA;      TARGET.[Company Code]&#x9;&#x9;&#x9;&#x9;&#x9;   = SOURCE.[Company Code]&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Update Date]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;   = SOURCE.[Update Date]&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Amount]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;   = SOURCE.[Amount]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Status]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;   = SOURCE.[Status]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Starting Date]&#x9;&#x9;&#x9;&#x9;&#x9;   = SOURCE.[Starting Date]&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Data Visura Protesti]&#x9;&#x9;&#x9;   = SOURCE.[Data Visura Protesti]&#x9;&#x9;&#xA;      ,TARGET.[Limit of Credit _]&#x9;&#x9;&#x9;&#x9;   = SOURCE.[Limit of Credit _]&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Situation]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;   = SOURCE.[Situation]&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Memo]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;   = SOURCE.[Memo]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Extra Credit]&#x9;&#x9;&#x9;&#x9;&#x9;   = SOURCE.[Extra Credit]&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Data Extra Credit]&#x9;&#x9;&#x9;&#x9;   = SOURCE.[Data Extra Credit]&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Active]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;   = SOURCE.[Active]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Cerved Credit]&#x9;&#x9;&#x9;&#x9;&#x9;   = SOURCE.[Cerved Credit]&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Memo 2]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;   = SOURCE.[Memo 2]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Payment Times]&#x9;&#x9;&#x9;&#x9;&#x9;   = SOURCE.[Payment Times]&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Negative Events]&#x9;&#x9;&#x9;&#x9;&#x9;   = SOURCE.[Negative Events]&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Econ-Financial Situation]&#x9;&#x9;   = SOURCE.[Econ-Financial Situation]&#x9;&#xA;      ,TARGET.[Risk no consultations]&#x9;&#x9;&#x9;   = SOURCE.[Risk no consultations]&#x9;&#x9;&#xA;      ,TARGET.[Revenues]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;   = SOURCE.[Revenues]&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Purchases]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;   = SOURCE.[Purchases]&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Mol]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;   = SOURCE.[Mol]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Useful Loss]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;   = SOURCE.[Useful Loss]&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Net Assets]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;   = SOURCE.[Net Assets]&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[No_ Employees]&#x9;&#x9;&#x9;&#x9;&#x9;   = SOURCE.[No_ Employees]&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[No_ Requests Last 12 Months]&#x9;&#x9;   = SOURCE.[No_ Requests Last 12 Months]&#x9;&#xA;      ,TARGET.[Cash Flow]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;   = SOURCE.[Cash Flow]&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Ebitda]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;   = SOURCE.[Ebitda]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Inventories]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;   = SOURCE.[Inventories]&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Payables to ML Banks Term]&#x9;&#x9;   = SOURCE.[Payables to ML Banks Term]&#x9;&#xA;      ,TARGET.[Payables to Banks BT]&#x9;&#x9;&#x9;   = SOURCE.[Payables to Banks BT]&#x9;&#x9;&#xA;      ,TARGET.[Payables to Vendors]&#x9;&#x9;&#x9;&#x9;   = SOURCE.[Payables to Vendors]&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Other Liabilities]&#x9;&#x9;&#x9;&#x9;   = SOURCE.[Other Liabilities]&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Current Ratio]&#x9;&#x9;&#x9;&#x9;&#x9;   = SOURCE.[Current Ratio]&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Net Circular Capital]&#x9;&#x9;&#x9;   = SOURCE.[Net Circular Capital]&#x9;&#x9;&#xA;      ,TARGET.[Protests]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;   = SOURCE.[Protests]&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Preg Cons]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;   = SOURCE.[Preg Cons]&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Email Certified]&#x9;&#x9;&#x9;&#x9;&#x9;   = SOURCE.[Email Certified]&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Start Activity]&#x9;&#x9;&#x9;&#x9;&#x9;   = SOURCE.[Start Activity]&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Secondary Seats No_]&#x9;&#x9;&#x9;&#x9;   = SOURCE.[Secondary Seats No_]&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Ateco Code]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;   = SOURCE.[Ateco Code]&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Consistence Properties]&#x9;&#x9;&#x9;   = SOURCE.[Consistence Properties]&#x9;&#x9;&#xA;      ,TARGET.[Insert Date]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;   = SOURCE.[Insert Date]&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Receipt Date]&#x9;&#x9;&#x9;&#x9;&#x9;   = SOURCE.[Receipt Date]&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Due Date]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;   = SOURCE.[Due Date]&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Company]            &#x9;&#x9;&#x9;&#x9;   = SOURCE.[Company]            &#x9;&#x9;&#x9;&#xA;                         &#xA;    &#xA;&#x9;   &#xA;&#x9;  WHEN NOT MATCHED&#xA;&#x9;  THEN INSERT (&#xA;&#xA;&#x9;  [ClienteKey]&#xA;      ,[Company Code]&#xA;      ,[Update Date]&#xA;      ,[Amount]&#xA;      ,[Status]&#xA;      ,[Starting Date]&#xA;      ,[Data Visura Protesti]&#xA;      ,[Limit of Credit _]&#xA;      ,[Situation]&#xA;      ,[Memo]&#xA;      ,[Extra Credit]&#xA;      ,[Data Extra Credit]&#xA;      ,[Active]&#xA;      ,[Cerved Credit]&#xA;      ,[Memo 2]&#xA;      ,[Payment Times]&#xA;      ,[Negative Events]&#xA;      ,[Econ-Financial Situation]&#xA;      ,[Risk no consultations]&#xA;      ,[Revenues]&#xA;      ,[Purchases]&#xA;      ,[Mol]&#xA;      ,[Useful Loss]&#xA;      ,[Net Assets]&#xA;      ,[No_ Employees]&#xA;      ,[No_ Requests Last 12 Months]&#xA;      ,[Cash Flow]&#xA;      ,[Ebitda]&#xA;      ,[Inventories]&#xA;      ,[Payables to ML Banks Term]&#xA;      ,[Payables to Banks BT]&#xA;      ,[Payables to Vendors]&#xA;      ,[Other Liabilities]&#xA;      ,[Current Ratio]&#xA;      ,[Net Circular Capital]&#xA;      ,[Protests]&#xA;      ,[Preg Cons]&#xA;      ,[Email Certified]&#xA;      ,[Start Activity]&#xA;      ,[Secondary Seats No_]&#xA;      ,[Ateco Code]&#xA;      ,[Consistence Properties]&#xA;      ,[Insert Date]&#xA;      ,[Receipt Date]&#xA;      ,[Due Date]&#xA;      ,[Company]&#xA;&#x9;  )&#xA;&#x9;  VALUES (&#xA;&#xA;&#x9;   [ClienteKey]&#xA;      ,[Company Code]&#xA;      ,[Update Date]&#xA;      ,[Amount]&#xA;      ,[Status]&#xA;      ,[Starting Date]&#xA;      ,[Data Visura Protesti]&#xA;      ,[Limit of Credit _]&#xA;      ,[Situation]&#xA;      ,[Memo]&#xA;      ,[Extra Credit]&#xA;      ,[Data Extra Credit]&#xA;      ,[Active]&#xA;      ,[Cerved Credit]&#xA;      ,[Memo 2]&#xA;      ,[Payment Times]&#xA;      ,[Negative Events]&#xA;      ,[Econ-Financial Situation]&#xA;      ,[Risk no consultations]&#xA;      ,[Revenues]&#xA;      ,[Purchases]&#xA;      ,[Mol]&#xA;      ,[Useful Loss]&#xA;      ,[Net Assets]&#xA;      ,[No_ Employees]&#xA;      ,[No_ Requests Last 12 Months]&#xA;      ,[Cash Flow]&#xA;      ,[Ebitda]&#xA;      ,[Inventories]&#xA;      ,[Payables to ML Banks Term]&#xA;      ,[Payables to Banks BT]&#xA;      ,[Payables to Vendors]&#xA;      ,[Other Liabilities]&#xA;      ,[Current Ratio]&#xA;      ,[Net Circular Capital]&#xA;      ,[Protests]&#xA;      ,[Preg Cons]&#xA;      ,[Email Certified]&#xA;      ,[Start Activity]&#xA;      ,[Secondary Seats No_]&#xA;      ,[Ateco Code]&#xA;      ,[Consistence Properties]&#xA;      ,[Insert Date]&#xA;      ,[Receipt Date]&#xA;      ,[Due Date]&#xA;      ,[Company]&#xA;&#x9;  );&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="Populate_FactAffidamentoClienti">
      <DTS:VariableValue
        DTS:DataType="8">MERGE [BI_Model_DWH].[dbo].[FactAffidamentoClienti] AS TARGET USING (

SELECT [ClienteKey]
      ,[Company Code]
      ,[Update Date]
      ,[Amount]
      ,[Status]
      ,[Starting Date]
      ,[Data Visura Protesti]
      ,[Limit of Credit _]
      ,[Situation]
      ,[Memo]
      ,[Extra Credit]
      ,[Data Extra Credit]
      ,[Active]
      ,[Cerved Credit]
      ,[Memo 2]
      ,[Payment Times]
      ,[Negative Events]
      ,[Econ-Financial Situation]
      ,[Risk no consultations]
      ,[Revenues]
      ,[Purchases]
      ,[Mol]
      ,[Useful Loss]
      ,[Net Assets]
      ,[No_ Employees]
      ,[No_ Requests Last 12 Months]
      ,[Cash Flow]
      ,[Ebitda]
      ,[Inventories]
      ,[Payables to ML Banks Term]
      ,[Payables to Banks BT]
      ,[Payables to Vendors]
      ,[Other Liabilities]
      ,[Current Ratio]
      ,[Net Circular Capital]
      ,[Protests]
      ,[Preg Cons]
      ,[Email Certified]
      ,[Start Activity]
      ,[Secondary Seats No_]
      ,[Ateco Code]
      ,[Consistence Properties]
      ,[Insert Date]
      ,[Receipt Date]
      ,[Due Date]
      ,[Company]
  FROM [BI_Model_Stage].[stg].[vFactAffidamentoClienti] fct
  inner join ( SELECT MAX([MaxTimestamp]) as maxtimestamp from [BI_Model_Stage].cfg.Config_Delta) cfg
  on fct.timestamp &gt; cfg.maxtimestamp
     ) AS SOURCE 
  ON   SOURCE.[ClienteKey]      = TARGET.[ClienteKey]  
  
  
  WHEN MATCHED
  THEN UPDATE SET 
	 
	  				
      TARGET.[Company Code]					   = SOURCE.[Company Code]				
      ,TARGET.[Update Date]						   = SOURCE.[Update Date]					
      ,TARGET.[Amount]							   = SOURCE.[Amount]						
      ,TARGET.[Status]							   = SOURCE.[Status]						
      ,TARGET.[Starting Date]					   = SOURCE.[Starting Date]				
      ,TARGET.[Data Visura Protesti]			   = SOURCE.[Data Visura Protesti]		
      ,TARGET.[Limit of Credit _]				   = SOURCE.[Limit of Credit _]			
      ,TARGET.[Situation]						   = SOURCE.[Situation]					
      ,TARGET.[Memo]							   = SOURCE.[Memo]						
      ,TARGET.[Extra Credit]					   = SOURCE.[Extra Credit]				
      ,TARGET.[Data Extra Credit]				   = SOURCE.[Data Extra Credit]			
      ,TARGET.[Active]							   = SOURCE.[Active]						
      ,TARGET.[Cerved Credit]					   = SOURCE.[Cerved Credit]				
      ,TARGET.[Memo 2]							   = SOURCE.[Memo 2]						
      ,TARGET.[Payment Times]					   = SOURCE.[Payment Times]				
      ,TARGET.[Negative Events]					   = SOURCE.[Negative Events]				
      ,TARGET.[Econ-Financial Situation]		   = SOURCE.[Econ-Financial Situation]	
      ,TARGET.[Risk no consultations]			   = SOURCE.[Risk no consultations]		
      ,TARGET.[Revenues]						   = SOURCE.[Revenues]					
      ,TARGET.[Purchases]						   = SOURCE.[Purchases]					
      ,TARGET.[Mol]								   = SOURCE.[Mol]							
      ,TARGET.[Useful Loss]						   = SOURCE.[Useful Loss]					
      ,TARGET.[Net Assets]						   = SOURCE.[Net Assets]					
      ,TARGET.[No_ Employees]					   = SOURCE.[No_ Employees]				
      ,TARGET.[No_ Requests Last 12 Months]		   = SOURCE.[No_ Requests Last 12 Months]	
      ,TARGET.[Cash Flow]						   = SOURCE.[Cash Flow]					
      ,TARGET.[Ebitda]							   = SOURCE.[Ebitda]						
      ,TARGET.[Inventories]						   = SOURCE.[Inventories]					
      ,TARGET.[Payables to ML Banks Term]		   = SOURCE.[Payables to ML Banks Term]	
      ,TARGET.[Payables to Banks BT]			   = SOURCE.[Payables to Banks BT]		
      ,TARGET.[Payables to Vendors]				   = SOURCE.[Payables to Vendors]			
      ,TARGET.[Other Liabilities]				   = SOURCE.[Other Liabilities]			
      ,TARGET.[Current Ratio]					   = SOURCE.[Current Ratio]				
      ,TARGET.[Net Circular Capital]			   = SOURCE.[Net Circular Capital]		
      ,TARGET.[Protests]						   = SOURCE.[Protests]					
      ,TARGET.[Preg Cons]						   = SOURCE.[Preg Cons]					
      ,TARGET.[Email Certified]					   = SOURCE.[Email Certified]				
      ,TARGET.[Start Activity]					   = SOURCE.[Start Activity]				
      ,TARGET.[Secondary Seats No_]				   = SOURCE.[Secondary Seats No_]			
      ,TARGET.[Ateco Code]						   = SOURCE.[Ateco Code]					
      ,TARGET.[Consistence Properties]			   = SOURCE.[Consistence Properties]		
      ,TARGET.[Insert Date]						   = SOURCE.[Insert Date]					
      ,TARGET.[Receipt Date]					   = SOURCE.[Receipt Date]				
      ,TARGET.[Due Date]						   = SOURCE.[Due Date]					
      ,TARGET.[Company]            				   = SOURCE.[Company]            			
                         
    
	   
	  WHEN NOT MATCHED
	  THEN INSERT (

	  [ClienteKey]
      ,[Company Code]
      ,[Update Date]
      ,[Amount]
      ,[Status]
      ,[Starting Date]
      ,[Data Visura Protesti]
      ,[Limit of Credit _]
      ,[Situation]
      ,[Memo]
      ,[Extra Credit]
      ,[Data Extra Credit]
      ,[Active]
      ,[Cerved Credit]
      ,[Memo 2]
      ,[Payment Times]
      ,[Negative Events]
      ,[Econ-Financial Situation]
      ,[Risk no consultations]
      ,[Revenues]
      ,[Purchases]
      ,[Mol]
      ,[Useful Loss]
      ,[Net Assets]
      ,[No_ Employees]
      ,[No_ Requests Last 12 Months]
      ,[Cash Flow]
      ,[Ebitda]
      ,[Inventories]
      ,[Payables to ML Banks Term]
      ,[Payables to Banks BT]
      ,[Payables to Vendors]
      ,[Other Liabilities]
      ,[Current Ratio]
      ,[Net Circular Capital]
      ,[Protests]
      ,[Preg Cons]
      ,[Email Certified]
      ,[Start Activity]
      ,[Secondary Seats No_]
      ,[Ateco Code]
      ,[Consistence Properties]
      ,[Insert Date]
      ,[Receipt Date]
      ,[Due Date]
      ,[Company]
	  )
	  VALUES (

	   [ClienteKey]
      ,[Company Code]
      ,[Update Date]
      ,[Amount]
      ,[Status]
      ,[Starting Date]
      ,[Data Visura Protesti]
      ,[Limit of Credit _]
      ,[Situation]
      ,[Memo]
      ,[Extra Credit]
      ,[Data Extra Credit]
      ,[Active]
      ,[Cerved Credit]
      ,[Memo 2]
      ,[Payment Times]
      ,[Negative Events]
      ,[Econ-Financial Situation]
      ,[Risk no consultations]
      ,[Revenues]
      ,[Purchases]
      ,[Mol]
      ,[Useful Loss]
      ,[Net Assets]
      ,[No_ Employees]
      ,[No_ Requests Last 12 Months]
      ,[Cash Flow]
      ,[Ebitda]
      ,[Inventories]
      ,[Payables to ML Banks Term]
      ,[Payables to Banks BT]
      ,[Payables to Vendors]
      ,[Other Liabilities]
      ,[Current Ratio]
      ,[Net Circular Capital]
      ,[Protests]
      ,[Preg Cons]
      ,[Email Certified]
      ,[Start Activity]
      ,[Secondary Seats No_]
      ,[Ateco Code]
      ,[Consistence Properties]
      ,[Insert Date]
      ,[Receipt Date]
      ,[Due Date]
      ,[Company]
	  );</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{13102262-AD17-4F2E-B43F-9C797D4A42E9}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;MERGE [BI_Model_DWH].[dbo].[FactBollaAcquisto_NEW] AS TARGET USING (&#xA;&#xA;SELECT [BollaAcquistoKey]&#xA;      ,[ArticoloKey]&#xA;      ,[MagazzinoKey]&#xA;      ,[OrdineAcquistoKey]&#xA;      ,[UnitàDiMisuraKey]&#xA;      ,[CompanyKey]&#xA;      ,[FornitoreKey]&#xA;      ,[StagioneKey]&#xA;      ,[TestataBollaAcquisto]&#xA;      ,[RigaBollaAcquisto]&#xA;      ,[Tipo]&#xA;      ,[TipoCalcoloIVA]&#xA;      ,[TipoTransazione]&#xA;      ,[ModalitàDiTrASporto]&#xA;      ,[CodiceMotivoReso]&#xA;      ,[DescrizioneBollaAcquisto]&#xA;      ,[DataPubblicazione]&#xA;      ,[DataAttesaRicevimento]&#xA;      ,[DataRichiestaRicevimento]&#xA;      ,[DataConcordataRicevimento]&#xA;      ,[DataPianificataRicevimento]&#xA;      ,[DataOrdineAcquisto]&#xA;      ,[dataFinePrecarico]&#xA;      ,[M_Quantità]&#xA;      ,[Importo Lordo In Valuta]&#xA;      ,[Importo Sconto In Valuta]&#xA;      ,[Importo IVA In Valuta]&#xA;      ,[Importo Lordo Euro]&#xA;      ,[Importo Sconto Euro]&#xA;      ,[Importo IVA Euro]&#xA;      ,[Nr Precarico]&#xA;      ,[DeltaData]&#xA;      ,[DeltaDataxQTY]&#xA;      ,[Area]&#xA;      ,[Tipo Bolla]&#xA;      ,[Currency Code]&#xA;      ,[Currency Factor]&#xA;  FROM [BI_Model_Stage].[stg].[vFactBollaAcquisto] fct&#xA;  inner join ( SELECT MAX([MaxTimestamp]) as maxtimestamp from [BI_Model_Stage].cfg.Config_Delta) cfg&#xA;  on fct.timestamp &gt; cfg.maxtimestamp&#xA;     ) AS SOURCE &#xA;  ON SOURCE.[BollaAcquistoKey]=TARGET.[BollaAcquistoKey]&#xA;  &#xA;  WHEN MATCHED&#xA;  THEN UPDATE SET &#xA;&#x9;&#xA;      TARGET.[ArticoloKey]                 = SOURCE.[ArticoloKey]&#xA;    ,  TARGET.[MagazzinoKey]                = SOURCE.[MagazzinoKey]&#xA;    ,  TARGET.[OrdineAcquistoKey]           = SOURCE.[OrdineAcquistoKey]&#xA;    ,  TARGET.[UnitàDiMisuraKey]            = SOURCE.[UnitàDiMisuraKey]&#xA;    &#xA;    ,  TARGET.[FornitoreKey]                = SOURCE.[FornitoreKey]&#xA;    ,  TARGET.[StagioneKey]                 = SOURCE.[StagioneKey]&#xA;     &#xA;    ,  TARGET.[Tipo]                        = SOURCE.[Tipo]&#xA;    ,  TARGET.[TipoCalcoloIVA]              = SOURCE.[TipoCalcoloIVA]&#xA;    ,  TARGET.[TipoTransazione]             = SOURCE.[TipoTransazione]&#xA;    ,  TARGET.[ModalitàDiTrASporto]         = SOURCE.[ModalitàDiTrASporto]&#xA;    ,  TARGET.[CodiceMotivoReso]            = SOURCE.[CodiceMotivoReso]&#xA;    ,  TARGET.[DescrizioneBollaAcquisto]    = SOURCE.[DescrizioneBollaAcquisto]&#xA;    ,  TARGET.[DataPubblicazione]           = SOURCE.[DataPubblicazione]&#xA;    ,  TARGET.[DataAttesaRicevimento]       = SOURCE.[DataAttesaRicevimento]&#xA;    ,  TARGET.[DataRichiestaRicevimento]    = SOURCE.[DataRichiestaRicevimento]&#xA;    ,  TARGET.[DataConcordataRicevimento]   = SOURCE.[DataConcordataRicevimento]&#xA;    ,  TARGET.[DataPianificataRicevimento]  = SOURCE.[DataPianificataRicevimento]&#xA;    ,  TARGET.[DataOrdineAcquisto]          = SOURCE.[DataOrdineAcquisto]&#xA;    ,  TARGET.[dataFinePrecarico]           = SOURCE.[dataFinePrecarico]&#xA;    ,  TARGET.[M_Quantità]                  = SOURCE.[M_Quantità]&#xA;    ,  TARGET.[Importo Lordo In Valuta]     = SOURCE.[Importo Lordo In Valuta]&#xA;    ,  TARGET.[Importo Sconto In Valuta]    = SOURCE.[Importo Sconto In Valuta]&#xA;    ,  TARGET.[Importo IVA In Valuta]       = SOURCE.[Importo IVA In Valuta]&#xA;    ,  TARGET.[Importo Lordo Euro]          = SOURCE.[Importo Lordo Euro]&#xA;    ,  TARGET.[Importo Sconto Euro]         = SOURCE.[Importo Sconto Euro]&#xA;    ,  TARGET.[Importo IVA Euro]            = SOURCE.[Importo IVA Euro]&#xA;    ,  TARGET.[Nr Precarico]                = SOURCE.[Nr Precarico]&#xA;    ,  TARGET.[DeltaData]                   = SOURCE.[DeltaData]&#xA;    ,  TARGET.[DeltaDataxQTY]               = SOURCE.[DeltaDataxQTY]&#xA;    ,  TARGET.[Area]                        = SOURCE.[Area]&#xA;    ,  TARGET.[Tipo Bolla]                  = SOURCE.[Tipo Bolla]&#xA;    ,  TARGET.[Currency Code]               = SOURCE.[Currency Code]&#xA;    ,  TARGET.[Currency Factor]             = SOURCE.[Currency Factor]&#xA;    &#xA;&#x9;   &#xA;&#x9;  WHEN NOT MATCHED&#xA;&#x9;  THEN INSERT (&#xA;&#x9;&#xA;&#x9;  [BollaAcquistoKey]&#xA;      ,[ArticoloKey]&#xA;      ,[MagazzinoKey]&#xA;      ,[OrdineAcquistoKey]&#xA;      ,[UnitàDiMisuraKey]&#xA;      ,[CompanyKey]&#xA;      ,[FornitoreKey]&#xA;      ,[StagioneKey]&#xA;      ,[TestataBollaAcquisto]&#xA;      ,[RigaBollaAcquisto]&#xA;      ,[Tipo]&#xA;      ,[TipoCalcoloIVA]&#xA;      ,[TipoTransazione]&#xA;      ,[ModalitàDiTrASporto]&#xA;      ,[CodiceMotivoReso]&#xA;      ,[DescrizioneBollaAcquisto]&#xA;      ,[DataPubblicazione]&#xA;      ,[DataAttesaRicevimento]&#xA;      ,[DataRichiestaRicevimento]&#xA;      ,[DataConcordataRicevimento]&#xA;      ,[DataPianificataRicevimento]&#xA;      ,[DataOrdineAcquisto]&#xA;      ,[dataFinePrecarico]&#xA;      ,[M_Quantità]&#xA;      ,[Importo Lordo In Valuta]&#xA;      ,[Importo Sconto In Valuta]&#xA;      ,[Importo IVA In Valuta]&#xA;      ,[Importo Lordo Euro]&#xA;      ,[Importo Sconto Euro]&#xA;      ,[Importo IVA Euro]&#xA;      ,[Nr Precarico]&#xA;      ,[DeltaData]&#xA;      ,[DeltaDataxQTY]&#xA;      ,[Area]&#xA;      ,[Tipo Bolla]&#xA;      ,[Currency Code]&#xA;      ,[Currency Factor]&#xA;&#x9;  )&#xA;&#x9;  VALUES (&#xA;&#xA;&#x9;   [BollaAcquistoKey]&#xA;      ,[ArticoloKey]&#xA;      ,[MagazzinoKey]&#xA;      ,[OrdineAcquistoKey]&#xA;      ,[UnitàDiMisuraKey]&#xA;      ,[CompanyKey]&#xA;      ,[FornitoreKey]&#xA;      ,[StagioneKey]&#xA;      ,[TestataBollaAcquisto]&#xA;      ,[RigaBollaAcquisto]&#xA;      ,[Tipo]&#xA;      ,[TipoCalcoloIVA]&#xA;      ,[TipoTransazione]&#xA;      ,[ModalitàDiTrASporto]&#xA;      ,[CodiceMotivoReso]&#xA;      ,[DescrizioneBollaAcquisto]&#xA;      ,[DataPubblicazione]&#xA;      ,[DataAttesaRicevimento]&#xA;      ,[DataRichiestaRicevimento]&#xA;      ,[DataConcordataRicevimento]&#xA;      ,[DataPianificataRicevimento]&#xA;      ,[DataOrdineAcquisto]&#xA;      ,[dataFinePrecarico]&#xA;      ,[M_Quantità]&#xA;      ,[Importo Lordo In Valuta]&#xA;      ,[Importo Sconto In Valuta]&#xA;      ,[Importo IVA In Valuta]&#xA;      ,[Importo Lordo Euro]&#xA;      ,[Importo Sconto Euro]&#xA;      ,[Importo IVA Euro]&#xA;      ,[Nr Precarico]&#xA;      ,[DeltaData]&#xA;      ,[DeltaDataxQTY]&#xA;      ,[Area]&#xA;      ,[Tipo Bolla]&#xA;      ,[Currency Code]&#xA;      ,[Currency Factor]&#xA;&#x9;  );&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="Populate_FactBollaAcquisto">
      <DTS:VariableValue
        DTS:DataType="8">MERGE [BI_Model_DWH].[dbo].[FactBollaAcquisto_NEW] AS TARGET USING (

SELECT [BollaAcquistoKey]
      ,[ArticoloKey]
      ,[MagazzinoKey]
      ,[OrdineAcquistoKey]
      ,[UnitàDiMisuraKey]
      ,[CompanyKey]
      ,[FornitoreKey]
      ,[StagioneKey]
      ,[TestataBollaAcquisto]
      ,[RigaBollaAcquisto]
      ,[Tipo]
      ,[TipoCalcoloIVA]
      ,[TipoTransazione]
      ,[ModalitàDiTrASporto]
      ,[CodiceMotivoReso]
      ,[DescrizioneBollaAcquisto]
      ,[DataPubblicazione]
      ,[DataAttesaRicevimento]
      ,[DataRichiestaRicevimento]
      ,[DataConcordataRicevimento]
      ,[DataPianificataRicevimento]
      ,[DataOrdineAcquisto]
      ,[dataFinePrecarico]
      ,[M_Quantità]
      ,[Importo Lordo In Valuta]
      ,[Importo Sconto In Valuta]
      ,[Importo IVA In Valuta]
      ,[Importo Lordo Euro]
      ,[Importo Sconto Euro]
      ,[Importo IVA Euro]
      ,[Nr Precarico]
      ,[DeltaData]
      ,[DeltaDataxQTY]
      ,[Area]
      ,[Tipo Bolla]
      ,[Currency Code]
      ,[Currency Factor]
  FROM [BI_Model_Stage].[stg].[vFactBollaAcquisto] fct
  inner join ( SELECT MAX([MaxTimestamp]) as maxtimestamp from [BI_Model_Stage].cfg.Config_Delta) cfg
  on fct.timestamp &gt; cfg.maxtimestamp
     ) AS SOURCE 
  ON SOURCE.[BollaAcquistoKey]=TARGET.[BollaAcquistoKey]
  
  WHEN MATCHED
  THEN UPDATE SET 
	
      TARGET.[ArticoloKey]                 = SOURCE.[ArticoloKey]
    ,  TARGET.[MagazzinoKey]                = SOURCE.[MagazzinoKey]
    ,  TARGET.[OrdineAcquistoKey]           = SOURCE.[OrdineAcquistoKey]
    ,  TARGET.[UnitàDiMisuraKey]            = SOURCE.[UnitàDiMisuraKey]
    
    ,  TARGET.[FornitoreKey]                = SOURCE.[FornitoreKey]
    ,  TARGET.[StagioneKey]                 = SOURCE.[StagioneKey]
     
    ,  TARGET.[Tipo]                        = SOURCE.[Tipo]
    ,  TARGET.[TipoCalcoloIVA]              = SOURCE.[TipoCalcoloIVA]
    ,  TARGET.[TipoTransazione]             = SOURCE.[TipoTransazione]
    ,  TARGET.[ModalitàDiTrASporto]         = SOURCE.[ModalitàDiTrASporto]
    ,  TARGET.[CodiceMotivoReso]            = SOURCE.[CodiceMotivoReso]
    ,  TARGET.[DescrizioneBollaAcquisto]    = SOURCE.[DescrizioneBollaAcquisto]
    ,  TARGET.[DataPubblicazione]           = SOURCE.[DataPubblicazione]
    ,  TARGET.[DataAttesaRicevimento]       = SOURCE.[DataAttesaRicevimento]
    ,  TARGET.[DataRichiestaRicevimento]    = SOURCE.[DataRichiestaRicevimento]
    ,  TARGET.[DataConcordataRicevimento]   = SOURCE.[DataConcordataRicevimento]
    ,  TARGET.[DataPianificataRicevimento]  = SOURCE.[DataPianificataRicevimento]
    ,  TARGET.[DataOrdineAcquisto]          = SOURCE.[DataOrdineAcquisto]
    ,  TARGET.[dataFinePrecarico]           = SOURCE.[dataFinePrecarico]
    ,  TARGET.[M_Quantità]                  = SOURCE.[M_Quantità]
    ,  TARGET.[Importo Lordo In Valuta]     = SOURCE.[Importo Lordo In Valuta]
    ,  TARGET.[Importo Sconto In Valuta]    = SOURCE.[Importo Sconto In Valuta]
    ,  TARGET.[Importo IVA In Valuta]       = SOURCE.[Importo IVA In Valuta]
    ,  TARGET.[Importo Lordo Euro]          = SOURCE.[Importo Lordo Euro]
    ,  TARGET.[Importo Sconto Euro]         = SOURCE.[Importo Sconto Euro]
    ,  TARGET.[Importo IVA Euro]            = SOURCE.[Importo IVA Euro]
    ,  TARGET.[Nr Precarico]                = SOURCE.[Nr Precarico]
    ,  TARGET.[DeltaData]                   = SOURCE.[DeltaData]
    ,  TARGET.[DeltaDataxQTY]               = SOURCE.[DeltaDataxQTY]
    ,  TARGET.[Area]                        = SOURCE.[Area]
    ,  TARGET.[Tipo Bolla]                  = SOURCE.[Tipo Bolla]
    ,  TARGET.[Currency Code]               = SOURCE.[Currency Code]
    ,  TARGET.[Currency Factor]             = SOURCE.[Currency Factor]
    
	   
	  WHEN NOT MATCHED
	  THEN INSERT (
	
	  [BollaAcquistoKey]
      ,[ArticoloKey]
      ,[MagazzinoKey]
      ,[OrdineAcquistoKey]
      ,[UnitàDiMisuraKey]
      ,[CompanyKey]
      ,[FornitoreKey]
      ,[StagioneKey]
      ,[TestataBollaAcquisto]
      ,[RigaBollaAcquisto]
      ,[Tipo]
      ,[TipoCalcoloIVA]
      ,[TipoTransazione]
      ,[ModalitàDiTrASporto]
      ,[CodiceMotivoReso]
      ,[DescrizioneBollaAcquisto]
      ,[DataPubblicazione]
      ,[DataAttesaRicevimento]
      ,[DataRichiestaRicevimento]
      ,[DataConcordataRicevimento]
      ,[DataPianificataRicevimento]
      ,[DataOrdineAcquisto]
      ,[dataFinePrecarico]
      ,[M_Quantità]
      ,[Importo Lordo In Valuta]
      ,[Importo Sconto In Valuta]
      ,[Importo IVA In Valuta]
      ,[Importo Lordo Euro]
      ,[Importo Sconto Euro]
      ,[Importo IVA Euro]
      ,[Nr Precarico]
      ,[DeltaData]
      ,[DeltaDataxQTY]
      ,[Area]
      ,[Tipo Bolla]
      ,[Currency Code]
      ,[Currency Factor]
	  )
	  VALUES (

	   [BollaAcquistoKey]
      ,[ArticoloKey]
      ,[MagazzinoKey]
      ,[OrdineAcquistoKey]
      ,[UnitàDiMisuraKey]
      ,[CompanyKey]
      ,[FornitoreKey]
      ,[StagioneKey]
      ,[TestataBollaAcquisto]
      ,[RigaBollaAcquisto]
      ,[Tipo]
      ,[TipoCalcoloIVA]
      ,[TipoTransazione]
      ,[ModalitàDiTrASporto]
      ,[CodiceMotivoReso]
      ,[DescrizioneBollaAcquisto]
      ,[DataPubblicazione]
      ,[DataAttesaRicevimento]
      ,[DataRichiestaRicevimento]
      ,[DataConcordataRicevimento]
      ,[DataPianificataRicevimento]
      ,[DataOrdineAcquisto]
      ,[dataFinePrecarico]
      ,[M_Quantità]
      ,[Importo Lordo In Valuta]
      ,[Importo Sconto In Valuta]
      ,[Importo IVA In Valuta]
      ,[Importo Lordo Euro]
      ,[Importo Sconto Euro]
      ,[Importo IVA Euro]
      ,[Nr Precarico]
      ,[DeltaData]
      ,[DeltaDataxQTY]
      ,[Area]
      ,[Tipo Bolla]
      ,[Currency Code]
      ,[Currency Factor]
	  );</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{60BD6236-45E9-4196-A09F-A0B034A1380C}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;MERGE [BI_Model_DWH].[dbo].[FactBudgetContabilità] AS TARGET USING (&#xA;&#xA;SELECT [StagioneKey]&#xA;      ,[ContoKey]&#xA;      ,[pccdcKey]&#xA;      ,[Currency Code]&#xA;      ,[User ID]&#xA;      ,[Entry No_]&#xA;      ,[Budget Name]&#xA;      ,[Date]&#xA;      ,[Marchio]&#xA;      ,[Amount]&#xA;      ,[Description]&#xA;      ,[Business Unit Code]&#xA;      ,[Budget Dimension 1 Code]&#xA;      ,[Budget Dimension 2 Code]&#xA;      ,[Budget Dimension 3 Code]&#xA;      ,[Budget Dimension 4 Code]&#xA;      ,[Last Date Modified]&#xA;      ,[Amount OCY]&#xA;      ,[SUBC Currency Code]&#xA;      ,[Amount SUBC Currency Code]&#xA;      ,[Exclude From Budget Check]&#xA;      ,[Purchase Document Type]&#xA;      ,[Purchase Document No_]&#xA;      ,[Company]&#xA;  FROM [BI_Model_Stage].[stg].[vFactBudgetContabilità] fct&#xA;  inner join ( SELECT MAX([MaxTimestamp]) as maxtimestamp from [BI_Model_Stage].cfg.Config_Delta) cfg&#xA;  on fct.timestamp &gt; cfg.maxtimestamp&#xA;     ) AS SOURCE &#xA;  ON    SOURCE.[Entry No_]     = TARGET.[Entry No_]  &#xA;  AND   SOURCE.[Budget Name]   = TARGET.[Budget Name]&#xA;  &#xA;  WHEN MATCHED&#xA;  THEN UPDATE SET &#xA;&#xA;&#x9;  TARGET.[StagioneKey]               = SOURCE.[StagioneKey]&#xA;   , TARGET.[ContoKey]                  = SOURCE.[ContoKey]&#xA;   , TARGET.[pccdcKey]                  = SOURCE.[pccdcKey]&#xA;   , TARGET.[Currency Code]             = SOURCE.[Currency Code]&#xA;   , TARGET.[User ID]                   = SOURCE.[User ID]&#xA;  &#xA;   , TARGET.[Date]                      = SOURCE.[Date]&#xA;   , TARGET.[Marchio]                   = SOURCE.[Marchio]&#xA;   , TARGET.[Amount]                    = SOURCE.[Amount]&#xA;   , TARGET.[Description]               = SOURCE.[Description]&#xA;   , TARGET.[Business Unit Code]        = SOURCE.[Business Unit Code]&#xA;   , TARGET.[Budget Dimension 1 Code]   = SOURCE.[Budget Dimension 1 Code]&#xA;   , TARGET.[Budget Dimension 2 Code]   = SOURCE.[Budget Dimension 2 Code]&#xA;   , TARGET.[Budget Dimension 3 Code]   = SOURCE.[Budget Dimension 3 Code]&#xA;   , TARGET.[Budget Dimension 4 Code]   = SOURCE.[Budget Dimension 4 Code]&#xA;   , TARGET.[Last Date Modified]        = SOURCE.[Last Date Modified]&#xA;   , TARGET.[Amount OCY]                = SOURCE.[Amount OCY]&#xA;   , TARGET.[SUBC Currency Code]        = SOURCE.[SUBC Currency Code]&#xA;   , TARGET.[Amount SUBC Currency Code] = SOURCE.[Amount SUBC Currency Code]&#xA;   , TARGET.[Exclude From Budget Check] = SOURCE.[Exclude From Budget Check]&#xA;   , TARGET.[Purchase Document Type]    = SOURCE.[Purchase Document Type]&#xA;   , TARGET.[Purchase Document No_]     = SOURCE.[Purchase Document No_]&#xA;&#xA;    &#xA;&#x9;   &#xA;&#x9;  WHEN NOT MATCHED&#xA;&#x9;  THEN INSERT (&#xA;&#x9;&#xA;&#x9;  [StagioneKey]&#xA;      ,[ContoKey]&#xA;      ,[pccdcKey]&#xA;      ,[Currency Code]&#xA;      ,[User ID]&#xA;      ,[Entry No_]&#xA;      ,[Budget Name]&#xA;      ,[Date]&#xA;      ,[Marchio]&#xA;      ,[Amount]&#xA;      ,[Description]&#xA;      ,[Business Unit Code]&#xA;      ,[Budget Dimension 1 Code]&#xA;      ,[Budget Dimension 2 Code]&#xA;      ,[Budget Dimension 3 Code]&#xA;      ,[Budget Dimension 4 Code]&#xA;      ,[Last Date Modified]&#xA;      ,[Amount OCY]&#xA;      ,[SUBC Currency Code]&#xA;      ,[Amount SUBC Currency Code]&#xA;      ,[Exclude From Budget Check]&#xA;      ,[Purchase Document Type]&#xA;      ,[Purchase Document No_]&#xA;      ,[Company]&#xA;&#x9;  )&#xA;&#x9;  VALUES (&#xA;&#xA;&#x9;   [StagioneKey]&#xA;      ,[ContoKey]&#xA;      ,[pccdcKey]&#xA;      ,[Currency Code]&#xA;      ,[User ID]&#xA;      ,[Entry No_]&#xA;      ,[Budget Name]&#xA;      ,[Date]&#xA;      ,[Marchio]&#xA;      ,[Amount]&#xA;      ,[Description]&#xA;      ,[Business Unit Code]&#xA;      ,[Budget Dimension 1 Code]&#xA;      ,[Budget Dimension 2 Code]&#xA;      ,[Budget Dimension 3 Code]&#xA;      ,[Budget Dimension 4 Code]&#xA;      ,[Last Date Modified]&#xA;      ,[Amount OCY]&#xA;      ,[SUBC Currency Code]&#xA;      ,[Amount SUBC Currency Code]&#xA;      ,[Exclude From Budget Check]&#xA;      ,[Purchase Document Type]&#xA;      ,[Purchase Document No_]&#xA;      ,[Company]&#xA;&#x9;  );&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="Populate_FactBudgetContabilità">
      <DTS:VariableValue
        DTS:DataType="8">MERGE [BI_Model_DWH].[dbo].[FactBudgetContabilità] AS TARGET USING (

SELECT [StagioneKey]
      ,[ContoKey]
      ,[pccdcKey]
      ,[Currency Code]
      ,[User ID]
      ,[Entry No_]
      ,[Budget Name]
      ,[Date]
      ,[Marchio]
      ,[Amount]
      ,[Description]
      ,[Business Unit Code]
      ,[Budget Dimension 1 Code]
      ,[Budget Dimension 2 Code]
      ,[Budget Dimension 3 Code]
      ,[Budget Dimension 4 Code]
      ,[Last Date Modified]
      ,[Amount OCY]
      ,[SUBC Currency Code]
      ,[Amount SUBC Currency Code]
      ,[Exclude From Budget Check]
      ,[Purchase Document Type]
      ,[Purchase Document No_]
      ,[Company]
  FROM [BI_Model_Stage].[stg].[vFactBudgetContabilità] fct
  inner join ( SELECT MAX([MaxTimestamp]) as maxtimestamp from [BI_Model_Stage].cfg.Config_Delta) cfg
  on fct.timestamp &gt; cfg.maxtimestamp
     ) AS SOURCE 
  ON    SOURCE.[Entry No_]     = TARGET.[Entry No_]  
  AND   SOURCE.[Budget Name]   = TARGET.[Budget Name]
  
  WHEN MATCHED
  THEN UPDATE SET 

	  TARGET.[StagioneKey]               = SOURCE.[StagioneKey]
   , TARGET.[ContoKey]                  = SOURCE.[ContoKey]
   , TARGET.[pccdcKey]                  = SOURCE.[pccdcKey]
   , TARGET.[Currency Code]             = SOURCE.[Currency Code]
   , TARGET.[User ID]                   = SOURCE.[User ID]
  
   , TARGET.[Date]                      = SOURCE.[Date]
   , TARGET.[Marchio]                   = SOURCE.[Marchio]
   , TARGET.[Amount]                    = SOURCE.[Amount]
   , TARGET.[Description]               = SOURCE.[Description]
   , TARGET.[Business Unit Code]        = SOURCE.[Business Unit Code]
   , TARGET.[Budget Dimension 1 Code]   = SOURCE.[Budget Dimension 1 Code]
   , TARGET.[Budget Dimension 2 Code]   = SOURCE.[Budget Dimension 2 Code]
   , TARGET.[Budget Dimension 3 Code]   = SOURCE.[Budget Dimension 3 Code]
   , TARGET.[Budget Dimension 4 Code]   = SOURCE.[Budget Dimension 4 Code]
   , TARGET.[Last Date Modified]        = SOURCE.[Last Date Modified]
   , TARGET.[Amount OCY]                = SOURCE.[Amount OCY]
   , TARGET.[SUBC Currency Code]        = SOURCE.[SUBC Currency Code]
   , TARGET.[Amount SUBC Currency Code] = SOURCE.[Amount SUBC Currency Code]
   , TARGET.[Exclude From Budget Check] = SOURCE.[Exclude From Budget Check]
   , TARGET.[Purchase Document Type]    = SOURCE.[Purchase Document Type]
   , TARGET.[Purchase Document No_]     = SOURCE.[Purchase Document No_]

    
	   
	  WHEN NOT MATCHED
	  THEN INSERT (
	
	  [StagioneKey]
      ,[ContoKey]
      ,[pccdcKey]
      ,[Currency Code]
      ,[User ID]
      ,[Entry No_]
      ,[Budget Name]
      ,[Date]
      ,[Marchio]
      ,[Amount]
      ,[Description]
      ,[Business Unit Code]
      ,[Budget Dimension 1 Code]
      ,[Budget Dimension 2 Code]
      ,[Budget Dimension 3 Code]
      ,[Budget Dimension 4 Code]
      ,[Last Date Modified]
      ,[Amount OCY]
      ,[SUBC Currency Code]
      ,[Amount SUBC Currency Code]
      ,[Exclude From Budget Check]
      ,[Purchase Document Type]
      ,[Purchase Document No_]
      ,[Company]
	  )
	  VALUES (

	   [StagioneKey]
      ,[ContoKey]
      ,[pccdcKey]
      ,[Currency Code]
      ,[User ID]
      ,[Entry No_]
      ,[Budget Name]
      ,[Date]
      ,[Marchio]
      ,[Amount]
      ,[Description]
      ,[Business Unit Code]
      ,[Budget Dimension 1 Code]
      ,[Budget Dimension 2 Code]
      ,[Budget Dimension 3 Code]
      ,[Budget Dimension 4 Code]
      ,[Last Date Modified]
      ,[Amount OCY]
      ,[SUBC Currency Code]
      ,[Amount SUBC Currency Code]
      ,[Exclude From Budget Check]
      ,[Purchase Document Type]
      ,[Purchase Document No_]
      ,[Company]
	  );</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{21FB67E0-E41D-426B-ACFA-F8E69AEAF499}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;MERGE [BI_Model_DWH].[dbo].[FactContabilitàCliente] AS TARGET USING (&#xA;&#xA;SELECT [Posting Date]&#xA;      ,[ClienteKey]&#xA;      ,[ContoKey]&#xA;      ,[Description]&#xA;      ,[Marchio]&#xA;      ,[Reason Code]&#xA;      ,[User ID]&#xA;      ,[TipoOperazioneContabile]&#xA;      ,[Entry no Cust Ledger Entry]&#xA;      ,[Document Type]&#xA;      ,[Document No_]&#xA;      ,[Journal Batch Name]&#xA;      ,[Transaction No_]&#xA;      ,[Letter No_]&#xA;      ,[Currency Code]&#xA;      ,[Customer No_]&#xA;      ,[Remaining Pmt_ Disc_ Possible]&#xA;      ,[Max_ Payment Tolerance]&#xA;      ,[Bank Receipt]&#xA;      ,[Bank Receipt Issued]&#xA;      ,[Contract Bonus Line]&#xA;      ,[Entry Type]&#xA;      ,[Amount]&#xA;      ,[importoCreditiClienti]&#xA;      ,[Debit Amount]&#xA;      ,[Credit Amount]&#xA;      ,[Debit Amount (LCY)]&#xA;      ,[Credit Amount (LCY)]&#xA;      ,[Initial Entry Due Date]&#xA;      ,[Initial Entry Global Dim_ 1]&#xA;      ,[Initial Entry Global Dim_ 2]&#xA;      ,[Gen_ Bus_ Posting Group]&#xA;      ,[Gen_ Prod_ Posting Group]&#xA;      ,[Use Tax]&#xA;      ,[VAT Bus_ Posting Group]&#xA;      ,[VAT Prod_ Posting Group]&#xA;      ,[Initial Document Type]&#xA;      ,[Applied Cust_ Ledger Entry No_]&#xA;      ,[Unapplied]&#xA;      ,[Unapplied by Entry No_]&#xA;      ,[Tax Jurisdiction Code]&#xA;      ,[Application No_]&#xA;      ,[Ledger Entry Amount]&#xA;      ,[Tipo Operazione CDV]&#xA;      ,[Company]&#xA;&#x9;  ,[Entry No_]&#xA;&#x9;  ,[open]&#xA;&#x9;  ,[Payment Method Code]&#xA;&#x9;  ,[flagRIBA]&#xA;  FROM [BI_Model_Stage].[stg].[vFactContabilitàCliente] fct&#xA;  inner join ( SELECT MAX([MaxTimestamp]) as maxtimestamp from [BI_Model_Stage].cfg.Config_Delta) cfg&#xA;  on fct.timestamp &gt; cfg.maxtimestamp&#xA;     ) AS SOURCE &#xA;  ON   SOURCE.[Entry no Cust Ledger Entry]      = TARGET.[Entry no Cust Ledger Entry]   &#xA;  AND SOURCE.[Entry No_] = TARGET.[Entry No_]&#xA;  AND  SOURCE.[Document No_]   = TARGET.[Document No_]&#xA;  AND  SOURCE.[Company]        = TARGET.[Company]     &#xA;  &#xA;  WHEN MATCHED&#xA;  THEN UPDATE SET &#xA;&#xA;&#x9;   TARGET.[Posting Date]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; = SOURCE.[Posting Date]&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[ClienteKey]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; = SOURCE.[ClienteKey]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[ContoKey]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; = SOURCE.[ContoKey]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Description]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; = SOURCE.[Description]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Marchio]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; = SOURCE.[Marchio]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Reason Code]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; = SOURCE.[Reason Code]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[User ID]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; = SOURCE.[User ID]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[TipoOperazioneContabile]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; = SOURCE.[TipoOperazioneContabile]&#x9;&#x9;&#x9;&#xA;      &#x9;&#x9;&#xA;      ,TARGET.[Document Type]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; = SOURCE.[Document Type]&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      &#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Journal Batch Name]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; = SOURCE.[Journal Batch Name]&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Transaction No_]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; = SOURCE.[Transaction No_]&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Letter No_]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; = SOURCE.[Letter No_]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Currency Code]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; = SOURCE.[Currency Code]&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Customer No_]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; = SOURCE.[Customer No_]&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Remaining Pmt_ Disc_ Possible]&#x9;&#x9;&#x9;&#x9; = SOURCE.[Remaining Pmt_ Disc_ Possible]&#x9;&#xA;      ,TARGET.[Max_ Payment Tolerance]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; = SOURCE.[Max_ Payment Tolerance]&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Bank Receipt]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; = SOURCE.[Bank Receipt]&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Bank Receipt Issued]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; = SOURCE.[Bank Receipt Issued]&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Contract Bonus Line]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; = SOURCE.[Contract Bonus Line]&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Entry Type]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; = SOURCE.[Entry Type]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Amount]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; = SOURCE.[Amount]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[importoCreditiClienti]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; = SOURCE.[importoCreditiClienti]&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Debit Amount]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; = SOURCE.[Debit Amount]&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Credit Amount]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; = SOURCE.[Credit Amount]&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Debit Amount (LCY)]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; = SOURCE.[Debit Amount (LCY)]&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Credit Amount (LCY)]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; = SOURCE.[Credit Amount (LCY)]&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Initial Entry Due Date]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; = SOURCE.[Initial Entry Due Date]&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Initial Entry Global Dim_ 1]&#x9;&#x9;&#x9;&#x9;&#x9; = SOURCE.[Initial Entry Global Dim_ 1]&#x9;&#x9;&#xA;      ,TARGET.[Initial Entry Global Dim_ 2]&#x9;&#x9;&#x9;&#x9;&#x9; = SOURCE.[Initial Entry Global Dim_ 2]&#x9;&#x9;&#xA;      ,TARGET.[Gen_ Bus_ Posting Group]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; = SOURCE.[Gen_ Bus_ Posting Group]&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Gen_ Prod_ Posting Group]&#x9;&#x9;&#x9;&#x9;&#x9; = SOURCE.[Gen_ Prod_ Posting Group]&#x9;&#x9;&#xA;      ,TARGET.[Use Tax]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; = SOURCE.[Use Tax]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[VAT Bus_ Posting Group]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; = SOURCE.[VAT Bus_ Posting Group]&#x9;&#x9;&#x9;&#xA;      ,TARGET.[VAT Prod_ Posting Group]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; = SOURCE.[VAT Prod_ Posting Group]&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Initial Document Type]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; = SOURCE.[Initial Document Type]&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Applied Cust_ Ledger Entry No_]&#x9;&#x9;&#x9;&#x9; = SOURCE.[Applied Cust_ Ledger Entry No_]&#x9;&#xA;      ,TARGET.[Unapplied]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; = SOURCE.[Unapplied]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Unapplied by Entry No_]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; = SOURCE.[Unapplied by Entry No_]&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Tax Jurisdiction Code]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; = SOURCE.[Tax Jurisdiction Code]&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Application No_]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; = SOURCE.[Application No_]&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Ledger Entry Amount]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; = SOURCE.[Ledger Entry Amount]&#x9;&#x9;&#x9;&#x9;&#xA;      ,TARGET.[Tipo Operazione CDV]&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; = SOURCE.[Tipo Operazione CDV]&#x9;&#xA;&#x9;  ,TARGET.[open] = SOURCE.[open]&#xA;&#x9;  ,TARGET.[Payment Method Code] = SOURCE.[Payment Method Code]&#xA;&#x9;  ,target.[flagRIBA] = source.[flagRIBA]&#xA;      &#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;            &#xA;    &#xA;&#x9;   &#xA;&#x9;  WHEN NOT MATCHED&#xA;&#x9;  THEN INSERT (&#xA;&#x9;&#xA;&#x9;  [Posting Date]&#xA;      ,[ClienteKey]&#xA;      ,[ContoKey]&#xA;      ,[Description]&#xA;      ,[Marchio]&#xA;      ,[Reason Code]&#xA;      ,[User ID]&#xA;      ,[TipoOperazioneContabile]&#xA;      ,[Entry no Cust Ledger Entry]&#xA;      ,[Document Type]&#xA;      ,[Document No_]&#xA;      ,[Journal Batch Name]&#xA;      ,[Transaction No_]&#xA;      ,[Letter No_]&#xA;      ,[Currency Code]&#xA;      ,[Customer No_]&#xA;      ,[Remaining Pmt_ Disc_ Possible]&#xA;      ,[Max_ Payment Tolerance]&#xA;      ,[Bank Receipt]&#xA;      ,[Bank Receipt Issued]&#xA;      ,[Contract Bonus Line]&#xA;      ,[Entry Type]&#xA;      ,[Amount]&#xA;      ,[importoCreditiClienti]&#xA;      ,[Debit Amount]&#xA;      ,[Credit Amount]&#xA;      ,[Debit Amount (LCY)]&#xA;      ,[Credit Amount (LCY)]&#xA;      ,[Initial Entry Due Date]&#xA;      ,[Initial Entry Global Dim_ 1]&#xA;      ,[Initial Entry Global Dim_ 2]&#xA;      ,[Gen_ Bus_ Posting Group]&#xA;      ,[Gen_ Prod_ Posting Group]&#xA;      ,[Use Tax]&#xA;      ,[VAT Bus_ Posting Group]&#xA;      ,[VAT Prod_ Posting Group]&#xA;      ,[Initial Document Type]&#xA;      ,[Applied Cust_ Ledger Entry No_]&#xA;      ,[Unapplied]&#xA;      ,[Unapplied by Entry No_]&#xA;      ,[Tax Jurisdiction Code]&#xA;      ,[Application No_]&#xA;      ,[Ledger Entry Amount]&#xA;      ,[Tipo Operazione CDV]&#xA;      ,[Company] &#xA;&#x9;  ,[Entry No_]&#xA;&#x9;  ,[open]&#xA;&#x9;  ,[Payment Method Code]&#xA;&#x9;  ,[flagRIBA]&#xA;&#x9;  )&#xA;&#x9;  VALUES (&#xA;&#x9;&#xA;&#x9;   [Posting Date]&#xA;      ,[ClienteKey]&#xA;      ,[ContoKey]&#xA;      ,[Description]&#xA;      ,[Marchio]&#xA;      ,[Reason Code]&#xA;      ,[User ID]&#xA;      ,[TipoOperazioneContabile]&#xA;      ,[Entry no Cust Ledger Entry]&#xA;      ,[Document Type]&#xA;      ,[Document No_]&#xA;      ,[Journal Batch Name]&#xA;      ,[Transaction No_]&#xA;      ,[Letter No_]&#xA;      ,[Currency Code]&#xA;      ,[Customer No_]&#xA;      ,[Remaining Pmt_ Disc_ Possible]&#xA;      ,[Max_ Payment Tolerance]&#xA;      ,[Bank Receipt]&#xA;      ,[Bank Receipt Issued]&#xA;      ,[Contract Bonus Line]&#xA;      ,[Entry Type]&#xA;      ,[Amount]&#xA;      ,[importoCreditiClienti]&#xA;      ,[Debit Amount]&#xA;      ,[Credit Amount]&#xA;      ,[Debit Amount (LCY)]&#xA;      ,[Credit Amount (LCY)]&#xA;      ,[Initial Entry Due Date]&#xA;      ,[Initial Entry Global Dim_ 1]&#xA;      ,[Initial Entry Global Dim_ 2]&#xA;      ,[Gen_ Bus_ Posting Group]&#xA;      ,[Gen_ Prod_ Posting Group]&#xA;      ,[Use Tax]&#xA;      ,[VAT Bus_ Posting Group]&#xA;      ,[VAT Prod_ Posting Group]&#xA;      ,[Initial Document Type]&#xA;      ,[Applied Cust_ Ledger Entry No_]&#xA;      ,[Unapplied]&#xA;      ,[Unapplied by Entry No_]&#xA;      ,[Tax Jurisdiction Code]&#xA;      ,[Application No_]&#xA;      ,[Ledger Entry Amount]&#xA;      ,[Tipo Operazione CDV]&#xA;      ,[Company]&#xA;&#x9;  ,[Entry No_]&#xA;&#x9;  ,[open]&#xA;&#x9;  ,[Payment Method Code]&#xA;&#x9;  ,[flagRIBA]&#xA;&#x9;  );&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="Populate_FactContabilitaCliente">
      <DTS:VariableValue
        DTS:DataType="8">MERGE [BI_Model_DWH].[dbo].[FactContabilitàCliente] AS TARGET USING (

SELECT [Posting Date]
      ,[ClienteKey]
      ,[ContoKey]
      ,[Description]
      ,[Marchio]
      ,[Reason Code]
      ,[User ID]
      ,[TipoOperazioneContabile]
      ,[Entry no Cust Ledger Entry]
      ,[Document Type]
      ,[Document No_]
      ,[Journal Batch Name]
      ,[Transaction No_]
      ,[Letter No_]
      ,[Currency Code]
      ,[Customer No_]
      ,[Remaining Pmt_ Disc_ Possible]
      ,[Max_ Payment Tolerance]
      ,[Bank Receipt]
      ,[Bank Receipt Issued]
      ,[Contract Bonus Line]
      ,[Entry Type]
      ,[Amount]
      ,[importoCreditiClienti]
      ,[Debit Amount]
      ,[Credit Amount]
      ,[Debit Amount (LCY)]
      ,[Credit Amount (LCY)]
      ,[Initial Entry Due Date]
      ,[Initial Entry Global Dim_ 1]
      ,[Initial Entry Global Dim_ 2]
      ,[Gen_ Bus_ Posting Group]
      ,[Gen_ Prod_ Posting Group]
      ,[Use Tax]
      ,[VAT Bus_ Posting Group]
      ,[VAT Prod_ Posting Group]
      ,[Initial Document Type]
      ,[Applied Cust_ Ledger Entry No_]
      ,[Unapplied]
      ,[Unapplied by Entry No_]
      ,[Tax Jurisdiction Code]
      ,[Application No_]
      ,[Ledger Entry Amount]
      ,[Tipo Operazione CDV]
      ,[Company]
	  ,[Entry No_]
	  ,[open]
	  ,[Payment Method Code]
	  ,[flagRIBA]
  FROM [BI_Model_Stage].[stg].[vFactContabilitàCliente] fct
  inner join ( SELECT MAX([MaxTimestamp]) as maxtimestamp from [BI_Model_Stage].cfg.Config_Delta) cfg
  on fct.timestamp &gt; cfg.maxtimestamp
     ) AS SOURCE 
  ON   SOURCE.[Entry no Cust Ledger Entry]      = TARGET.[Entry no Cust Ledger Entry]   
  AND SOURCE.[Entry No_] = TARGET.[Entry No_]
  AND  SOURCE.[Document No_]   = TARGET.[Document No_]
  AND  SOURCE.[Company]        = TARGET.[Company]     
  
  WHEN MATCHED
  THEN UPDATE SET 

	   TARGET.[Posting Date]								 = SOURCE.[Posting Date]					
      ,TARGET.[ClienteKey]									 = SOURCE.[ClienteKey]						
      ,TARGET.[ContoKey]								 = SOURCE.[ContoKey]						
      ,TARGET.[Description]									 = SOURCE.[Description]						
      ,TARGET.[Marchio]										 = SOURCE.[Marchio]							
      ,TARGET.[Reason Code]									 = SOURCE.[Reason Code]						
      ,TARGET.[User ID]										 = SOURCE.[User ID]							
      ,TARGET.[TipoOperazioneContabile]						 = SOURCE.[TipoOperazioneContabile]			
      		
      ,TARGET.[Document Type]								 = SOURCE.[Document Type]					
      					
      ,TARGET.[Journal Batch Name]							 = SOURCE.[Journal Batch Name]				
      ,TARGET.[Transaction No_]								 = SOURCE.[Transaction No_]					
      ,TARGET.[Letter No_]									 = SOURCE.[Letter No_]						
      ,TARGET.[Currency Code]								 = SOURCE.[Currency Code]					
      ,TARGET.[Customer No_]								 = SOURCE.[Customer No_]					
      ,TARGET.[Remaining Pmt_ Disc_ Possible]				 = SOURCE.[Remaining Pmt_ Disc_ Possible]	
      ,TARGET.[Max_ Payment Tolerance]						 = SOURCE.[Max_ Payment Tolerance]			
      ,TARGET.[Bank Receipt]								 = SOURCE.[Bank Receipt]					
      ,TARGET.[Bank Receipt Issued]							 = SOURCE.[Bank Receipt Issued]				
      ,TARGET.[Contract Bonus Line]							 = SOURCE.[Contract Bonus Line]				
      ,TARGET.[Entry Type]									 = SOURCE.[Entry Type]						
      ,TARGET.[Amount]										 = SOURCE.[Amount]							
      ,TARGET.[importoCreditiClienti]						 = SOURCE.[importoCreditiClienti]			
      ,TARGET.[Debit Amount]								 = SOURCE.[Debit Amount]					
      ,TARGET.[Credit Amount]								 = SOURCE.[Credit Amount]					
      ,TARGET.[Debit Amount (LCY)]							 = SOURCE.[Debit Amount (LCY)]				
      ,TARGET.[Credit Amount (LCY)]							 = SOURCE.[Credit Amount (LCY)]				
      ,TARGET.[Initial Entry Due Date]						 = SOURCE.[Initial Entry Due Date]			
      ,TARGET.[Initial Entry Global Dim_ 1]					 = SOURCE.[Initial Entry Global Dim_ 1]		
      ,TARGET.[Initial Entry Global Dim_ 2]					 = SOURCE.[Initial Entry Global Dim_ 2]		
      ,TARGET.[Gen_ Bus_ Posting Group]						 = SOURCE.[Gen_ Bus_ Posting Group]			
      ,TARGET.[Gen_ Prod_ Posting Group]					 = SOURCE.[Gen_ Prod_ Posting Group]		
      ,TARGET.[Use Tax]										 = SOURCE.[Use Tax]							
      ,TARGET.[VAT Bus_ Posting Group]						 = SOURCE.[VAT Bus_ Posting Group]			
      ,TARGET.[VAT Prod_ Posting Group]						 = SOURCE.[VAT Prod_ Posting Group]			
      ,TARGET.[Initial Document Type]						 = SOURCE.[Initial Document Type]			
      ,TARGET.[Applied Cust_ Ledger Entry No_]				 = SOURCE.[Applied Cust_ Ledger Entry No_]	
      ,TARGET.[Unapplied]									 = SOURCE.[Unapplied]						
      ,TARGET.[Unapplied by Entry No_]						 = SOURCE.[Unapplied by Entry No_]			
      ,TARGET.[Tax Jurisdiction Code]						 = SOURCE.[Tax Jurisdiction Code]			
      ,TARGET.[Application No_]								 = SOURCE.[Application No_]					
      ,TARGET.[Ledger Entry Amount]							 = SOURCE.[Ledger Entry Amount]				
      ,TARGET.[Tipo Operazione CDV]							 = SOURCE.[Tipo Operazione CDV]	
	  ,TARGET.[open] = SOURCE.[open]
	  ,TARGET.[Payment Method Code] = SOURCE.[Payment Method Code]
	  ,target.[flagRIBA] = source.[flagRIBA]
      						
            
    
	   
	  WHEN NOT MATCHED
	  THEN INSERT (
	
	  [Posting Date]
      ,[ClienteKey]
      ,[ContoKey]
      ,[Description]
      ,[Marchio]
      ,[Reason Code]
      ,[User ID]
      ,[TipoOperazioneContabile]
      ,[Entry no Cust Ledger Entry]
      ,[Document Type]
      ,[Document No_]
      ,[Journal Batch Name]
      ,[Transaction No_]
      ,[Letter No_]
      ,[Currency Code]
      ,[Customer No_]
      ,[Remaining Pmt_ Disc_ Possible]
      ,[Max_ Payment Tolerance]
      ,[Bank Receipt]
      ,[Bank Receipt Issued]
      ,[Contract Bonus Line]
      ,[Entry Type]
      ,[Amount]
      ,[importoCreditiClienti]
      ,[Debit Amount]
      ,[Credit Amount]
      ,[Debit Amount (LCY)]
      ,[Credit Amount (LCY)]
      ,[Initial Entry Due Date]
      ,[Initial Entry Global Dim_ 1]
      ,[Initial Entry Global Dim_ 2]
      ,[Gen_ Bus_ Posting Group]
      ,[Gen_ Prod_ Posting Group]
      ,[Use Tax]
      ,[VAT Bus_ Posting Group]
      ,[VAT Prod_ Posting Group]
      ,[Initial Document Type]
      ,[Applied Cust_ Ledger Entry No_]
      ,[Unapplied]
      ,[Unapplied by Entry No_]
      ,[Tax Jurisdiction Code]
      ,[Application No_]
      ,[Ledger Entry Amount]
      ,[Tipo Operazione CDV]
      ,[Company] 
	  ,[Entry No_]
	  ,[open]
	  ,[Payment Method Code]
	  ,[flagRIBA]
	  )
	  VALUES (
	
	   [Posting Date]
      ,[ClienteKey]
      ,[ContoKey]
      ,[Description]
      ,[Marchio]
      ,[Reason Code]
      ,[User ID]
      ,[TipoOperazioneContabile]
      ,[Entry no Cust Ledger Entry]
      ,[Document Type]
      ,[Document No_]
      ,[Journal Batch Name]
      ,[Transaction No_]
      ,[Letter No_]
      ,[Currency Code]
      ,[Customer No_]
      ,[Remaining Pmt_ Disc_ Possible]
      ,[Max_ Payment Tolerance]
      ,[Bank Receipt]
      ,[Bank Receipt Issued]
      ,[Contract Bonus Line]
      ,[Entry Type]
      ,[Amount]
      ,[importoCreditiClienti]
      ,[Debit Amount]
      ,[Credit Amount]
      ,[Debit Amount (LCY)]
      ,[Credit Amount (LCY)]
      ,[Initial Entry Due Date]
      ,[Initial Entry Global Dim_ 1]
      ,[Initial Entry Global Dim_ 2]
      ,[Gen_ Bus_ Posting Group]
      ,[Gen_ Prod_ Posting Group]
      ,[Use Tax]
      ,[VAT Bus_ Posting Group]
      ,[VAT Prod_ Posting Group]
      ,[Initial Document Type]
      ,[Applied Cust_ Ledger Entry No_]
      ,[Unapplied]
      ,[Unapplied by Entry No_]
      ,[Tax Jurisdiction Code]
      ,[Application No_]
      ,[Ledger Entry Amount]
      ,[Tipo Operazione CDV]
      ,[Company]
	  ,[Entry No_]
	  ,[open]
	  ,[Payment Method Code]
	  ,[flagRIBA]
	  );</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{27E6D38C-E33A-4A60-BED4-2A1909151FE0}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;MERGE [BI_Model_DWH].[dbo].[FactContabilitàFornitore] AS TARGET USING (&#xA;&#xA;SELECT [Posting Date]&#xA;      ,[FornitoreKey]&#xA;      ,[StagioneKey]&#xA;      ,[pccdckey]&#xA;      ,[Reason Code]&#xA;      ,[User ID]&#xA;      ,[tipoOperazioneContabile]&#xA;      ,[tipoOperazioneContabile_det]&#xA;      ,[Entry No_]&#xA;      ,[Dettaglio_Document Type]&#xA;      ,[Document Type]&#xA;      ,[Document No_]&#xA;      ,[Journal Batch Name]&#xA;      ,[Transaction No_]&#xA;      ,[Currency Code]&#xA;      ,[Remaining Pmt_ Disc_ Possible]&#xA;      ,[Max_ Payment Tolerance]&#xA;      ,[Contract Bonus Line]&#xA;      ,[Vendor No_]&#xA;      ,[Vendor Ledger Entry No_]&#xA;      ,[Entry Type]&#xA;      ,[Amount]&#xA;      ,[Amount (LCY)]&#xA;      ,[Debit Amount]&#xA;      ,[Credit Amount]&#xA;      ,[Debit Amount (LCY)]&#xA;      ,[Credit Amount (LCY)]&#xA;      ,[Initial Entry Due Date]&#xA;      ,[Gen_ Bus_ Posting Group]&#xA;      ,[Gen_ Prod_ Posting Group]&#xA;      ,[Use Tax]&#xA;      ,[VAT Bus_ Posting Group]&#xA;      ,[VAT Prod_ Posting Group]&#xA;      ,[Initial Document Type]&#xA;      ,[Applied Vend_ Ledger Entry No_]&#xA;      ,[Unapplied]&#xA;      ,[Unapplied by Entry No_]&#xA;      ,[Tax Jurisdiction Code]&#xA;      ,[Application No_]&#xA;      ,[Ledger Entry Amount]&#xA;      ,[Tipo Operazione CDV]&#xA;      ,[Company]&#xA;  FROM [BI_Model_Stage].[stg].[vFactContabilitàFornitore] fct&#xA;  inner join ( SELECT MAX([MaxTimestamp]) as maxtimestamp from [BI_Model_Stage].cfg.Config_Delta) cfg&#xA;  on fct.timestamp &gt; cfg.maxtimestamp&#xA;     ) AS SOURCE &#xA;  ON   SOURCE.[Entry No_]      = TARGET.[Entry No_]  &#xA;  AND  SOURCE.[Document No_]   = TARGET.[Document No_]&#xA;  AND  SOURCE.[Company]        = TARGET.[Company]     &#xA;  &#xA;  WHEN MATCHED&#xA;  THEN UPDATE SET &#xA;&#xA;&#x9;   TARGET.[Posting Date]                               = SOURCE.[Posting Date]                   &#xA;      ,TARGET.[FornitoreKey]                               = SOURCE.[FornitoreKey]                   &#xA;      ,TARGET.[StagioneKey]                                = SOURCE.[StagioneKey]                    &#xA;      ,TARGET.[pccdckey]                                   = SOURCE.[pccdckey]                       &#xA;      ,TARGET.[Reason Code]                                = SOURCE.[Reason Code]                    &#xA;      ,TARGET.[User ID]                                    = SOURCE.[User ID]                        &#xA;      ,TARGET.[tipoOperazioneContabile]                    = SOURCE.[tipoOperazioneContabile]        &#xA;      ,TARGET.[tipoOperazioneContabile_det]                = SOURCE.[tipoOperazioneContabile_det]    &#xA;                     &#xA;      ,TARGET.[Dettaglio_Document Type]                    = SOURCE.[Dettaglio_Document Type]        &#xA;      ,TARGET.[Document Type]                              = SOURCE.[Document Type]                  &#xA;                     &#xA;      ,TARGET.[Journal Batch Name]                         = SOURCE.[Journal Batch Name]             &#xA;      ,TARGET.[Transaction No_]                            = SOURCE.[Transaction No_]                &#xA;      ,TARGET.[Currency Code]                              = SOURCE.[Currency Code]                  &#xA;      ,TARGET.[Remaining Pmt_ Disc_ Possible]              = SOURCE.[Remaining Pmt_ Disc_ Possible]  &#xA;      ,TARGET.[Max_ Payment Tolerance]                     = SOURCE.[Max_ Payment Tolerance]         &#xA;      ,TARGET.[Contract Bonus Line]                        = SOURCE.[Contract Bonus Line]            &#xA;      ,TARGET.[Vendor No_]                                 = SOURCE.[Vendor No_]                     &#xA;      ,TARGET.[Vendor Ledger Entry No_]                    = SOURCE.[Vendor Ledger Entry No_]        &#xA;      ,TARGET.[Entry Type]                                 = SOURCE.[Entry Type]                     &#xA;      ,TARGET.[Amount]                                     = SOURCE.[Amount]                         &#xA;      ,TARGET.[Amount (LCY)]                               = SOURCE.[Amount (LCY)]                   &#xA;      ,TARGET.[Debit Amount]                               = SOURCE.[Debit Amount]                   &#xA;      ,TARGET.[Credit Amount]                              = SOURCE.[Credit Amount]                  &#xA;      ,TARGET.[Debit Amount (LCY)]                         = SOURCE.[Debit Amount (LCY)]             &#xA;      ,TARGET.[Credit Amount (LCY)]                        = SOURCE.[Credit Amount (LCY)]            &#xA;      ,TARGET.[Initial Entry Due Date]                     = SOURCE.[Initial Entry Due Date]         &#xA;      ,TARGET.[Gen_ Bus_ Posting Group]                    = SOURCE.[Gen_ Bus_ Posting Group]        &#xA;      ,TARGET.[Gen_ Prod_ Posting Group]                   = SOURCE.[Gen_ Prod_ Posting Group]       &#xA;      ,TARGET.[Use Tax]                                    = SOURCE.[Use Tax]                        &#xA;      ,TARGET.[VAT Bus_ Posting Group]                     = SOURCE.[VAT Bus_ Posting Group]         &#xA;      ,TARGET.[VAT Prod_ Posting Group]                    = SOURCE.[VAT Prod_ Posting Group]        &#xA;      ,TARGET.[Initial Document Type]                      = SOURCE.[Initial Document Type]          &#xA;      ,TARGET.[Applied Vend_ Ledger Entry No_]             = SOURCE.[Applied Vend_ Ledger Entry No_] &#xA;      ,TARGET.[Unapplied]                                  = SOURCE.[Unapplied]                      &#xA;      ,TARGET.[Unapplied by Entry No_]                     = SOURCE.    [Unapplied by Entry No_]         &#xA;      ,TARGET.[Tax Jurisdiction Code]                      = SOURCE.    [Tax Jurisdiction Code]          &#xA;      ,TARGET.[Application No_]                            = SOURCE.    [Application No_]                &#xA;      ,TARGET.[Ledger Entry Amount]                        = SOURCE.    [Ledger Entry Amount]            &#xA;      ,TARGET.[Tipo Operazione CDV]                        = SOURCE.    [Tipo Operazione CDV]            &#xA;                           &#xA;    &#xA;&#x9;   &#xA;&#x9;  WHEN NOT MATCHED&#xA;&#x9;  THEN INSERT (&#xA;&#x9;&#xA;&#x9;  [Posting Date]&#xA;      ,[FornitoreKey]&#xA;      ,[StagioneKey]&#xA;      ,[pccdckey]&#xA;      ,[Reason Code]&#xA;      ,[User ID]&#xA;      ,[tipoOperazioneContabile]&#xA;      ,[tipoOperazioneContabile_det]&#xA;      ,[Entry No_]&#xA;      ,[Dettaglio_Document Type]&#xA;      ,[Document Type]&#xA;      ,[Document No_]&#xA;      ,[Journal Batch Name]&#xA;      ,[Transaction No_]&#xA;      ,[Currency Code]&#xA;      ,[Remaining Pmt_ Disc_ Possible]&#xA;      ,[Max_ Payment Tolerance]&#xA;      ,[Contract Bonus Line]&#xA;      ,[Vendor No_]&#xA;      ,[Vendor Ledger Entry No_]&#xA;      ,[Entry Type]&#xA;      ,[Amount]&#xA;      ,[Amount (LCY)]&#xA;      ,[Debit Amount]&#xA;      ,[Credit Amount]&#xA;      ,[Debit Amount (LCY)]&#xA;      ,[Credit Amount (LCY)]&#xA;      ,[Initial Entry Due Date]&#xA;      ,[Gen_ Bus_ Posting Group]&#xA;      ,[Gen_ Prod_ Posting Group]&#xA;      ,[Use Tax]&#xA;      ,[VAT Bus_ Posting Group]&#xA;      ,[VAT Prod_ Posting Group]&#xA;      ,[Initial Document Type]&#xA;      ,[Applied Vend_ Ledger Entry No_]&#xA;      ,[Unapplied]&#xA;      ,[Unapplied by Entry No_]&#xA;      ,[Tax Jurisdiction Code]&#xA;      ,[Application No_]&#xA;      ,[Ledger Entry Amount]&#xA;      ,[Tipo Operazione CDV]&#xA;      ,[Company]&#xA;&#x9;  )&#xA;&#x9;  VALUES (&#xA;&#xA;&#x9;   [Posting Date]&#xA;      ,[FornitoreKey]&#xA;      ,[StagioneKey]&#xA;      ,[pccdckey]&#xA;      ,[Reason Code]&#xA;      ,[User ID]&#xA;      ,[tipoOperazioneContabile]&#xA;      ,[tipoOperazioneContabile_det]&#xA;      ,[Entry No_]&#xA;      ,[Dettaglio_Document Type]&#xA;      ,[Document Type]&#xA;      ,[Document No_]&#xA;      ,[Journal Batch Name]&#xA;      ,[Transaction No_]&#xA;      ,[Currency Code]&#xA;      ,[Remaining Pmt_ Disc_ Possible]&#xA;      ,[Max_ Payment Tolerance]&#xA;      ,[Contract Bonus Line]&#xA;      ,[Vendor No_]&#xA;      ,[Vendor Ledger Entry No_]&#xA;      ,[Entry Type]&#xA;      ,[Amount]&#xA;      ,[Amount (LCY)]&#xA;      ,[Debit Amount]&#xA;      ,[Credit Amount]&#xA;      ,[Debit Amount (LCY)]&#xA;      ,[Credit Amount (LCY)]&#xA;      ,[Initial Entry Due Date]&#xA;      ,[Gen_ Bus_ Posting Group]&#xA;      ,[Gen_ Prod_ Posting Group]&#xA;      ,[Use Tax]&#xA;      ,[VAT Bus_ Posting Group]&#xA;      ,[VAT Prod_ Posting Group]&#xA;      ,[Initial Document Type]&#xA;      ,[Applied Vend_ Ledger Entry No_]&#xA;      ,[Unapplied]&#xA;      ,[Unapplied by Entry No_]&#xA;      ,[Tax Jurisdiction Code]&#xA;      ,[Application No_]&#xA;      ,[Ledger Entry Amount]&#xA;      ,[Tipo Operazione CDV]&#xA;      ,[Company]&#xA;&#x9;  );&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="Populate_FactContabilitaFornitore">
      <DTS:VariableValue
        DTS:DataType="8">MERGE [BI_Model_DWH].[dbo].[FactContabilitàFornitore] AS TARGET USING (

SELECT [Posting Date]
      ,[FornitoreKey]
      ,[StagioneKey]
      ,[pccdckey]
      ,[Reason Code]
      ,[User ID]
      ,[tipoOperazioneContabile]
      ,[tipoOperazioneContabile_det]
      ,[Entry No_]
      ,[Dettaglio_Document Type]
      ,[Document Type]
      ,[Document No_]
      ,[Journal Batch Name]
      ,[Transaction No_]
      ,[Currency Code]
      ,[Remaining Pmt_ Disc_ Possible]
      ,[Max_ Payment Tolerance]
      ,[Contract Bonus Line]
      ,[Vendor No_]
      ,[Vendor Ledger Entry No_]
      ,[Entry Type]
      ,[Amount]
      ,[Amount (LCY)]
      ,[Debit Amount]
      ,[Credit Amount]
      ,[Debit Amount (LCY)]
      ,[Credit Amount (LCY)]
      ,[Initial Entry Due Date]
      ,[Gen_ Bus_ Posting Group]
      ,[Gen_ Prod_ Posting Group]
      ,[Use Tax]
      ,[VAT Bus_ Posting Group]
      ,[VAT Prod_ Posting Group]
      ,[Initial Document Type]
      ,[Applied Vend_ Ledger Entry No_]
      ,[Unapplied]
      ,[Unapplied by Entry No_]
      ,[Tax Jurisdiction Code]
      ,[Application No_]
      ,[Ledger Entry Amount]
      ,[Tipo Operazione CDV]
      ,[Company]
  FROM [BI_Model_Stage].[stg].[vFactContabilitàFornitore] fct
  inner join ( SELECT MAX([MaxTimestamp]) as maxtimestamp from [BI_Model_Stage].cfg.Config_Delta) cfg
  on fct.timestamp &gt; cfg.maxtimestamp
     ) AS SOURCE 
  ON   SOURCE.[Entry No_]      = TARGET.[Entry No_]  
  AND  SOURCE.[Document No_]   = TARGET.[Document No_]
  AND  SOURCE.[Company]        = TARGET.[Company]     
  
  WHEN MATCHED
  THEN UPDATE SET 

	   TARGET.[Posting Date]                               = SOURCE.[Posting Date]                   
      ,TARGET.[FornitoreKey]                               = SOURCE.[FornitoreKey]                   
      ,TARGET.[StagioneKey]                                = SOURCE.[StagioneKey]                    
      ,TARGET.[pccdckey]                                   = SOURCE.[pccdckey]                       
      ,TARGET.[Reason Code]                                = SOURCE.[Reason Code]                    
      ,TARGET.[User ID]                                    = SOURCE.[User ID]                        
      ,TARGET.[tipoOperazioneContabile]                    = SOURCE.[tipoOperazioneContabile]        
      ,TARGET.[tipoOperazioneContabile_det]                = SOURCE.[tipoOperazioneContabile_det]    
                     
      ,TARGET.[Dettaglio_Document Type]                    = SOURCE.[Dettaglio_Document Type]        
      ,TARGET.[Document Type]                              = SOURCE.[Document Type]                  
                     
      ,TARGET.[Journal Batch Name]                         = SOURCE.[Journal Batch Name]             
      ,TARGET.[Transaction No_]                            = SOURCE.[Transaction No_]                
      ,TARGET.[Currency Code]                              = SOURCE.[Currency Code]                  
      ,TARGET.[Remaining Pmt_ Disc_ Possible]              = SOURCE.[Remaining Pmt_ Disc_ Possible]  
      ,TARGET.[Max_ Payment Tolerance]                     = SOURCE.[Max_ Payment Tolerance]         
      ,TARGET.[Contract Bonus Line]                        = SOURCE.[Contract Bonus Line]            
      ,TARGET.[Vendor No_]                                 = SOURCE.[Vendor No_]                     
      ,TARGET.[Vendor Ledger Entry No_]                    = SOURCE.[Vendor Ledger Entry No_]        
      ,TARGET.[Entry Type]                                 = SOURCE.[Entry Type]                     
      ,TARGET.[Amount]                                     = SOURCE.[Amount]                         
      ,TARGET.[Amount (LCY)]                               = SOURCE.[Amount (LCY)]                   
      ,TARGET.[Debit Amount]                               = SOURCE.[Debit Amount]                   
      ,TARGET.[Credit Amount]                              = SOURCE.[Credit Amount]                  
      ,TARGET.[Debit Amount (LCY)]                         = SOURCE.[Debit Amount (LCY)]             
      ,TARGET.[Credit Amount (LCY)]                        = SOURCE.[Credit Amount (LCY)]            
      ,TARGET.[Initial Entry Due Date]                     = SOURCE.[Initial Entry Due Date]         
      ,TARGET.[Gen_ Bus_ Posting Group]                    = SOURCE.[Gen_ Bus_ Posting Group]        
      ,TARGET.[Gen_ Prod_ Posting Group]                   = SOURCE.[Gen_ Prod_ Posting Group]       
      ,TARGET.[Use Tax]                                    = SOURCE.[Use Tax]                        
      ,TARGET.[VAT Bus_ Posting Group]                     = SOURCE.[VAT Bus_ Posting Group]         
      ,TARGET.[VAT Prod_ Posting Group]                    = SOURCE.[VAT Prod_ Posting Group]        
      ,TARGET.[Initial Document Type]                      = SOURCE.[Initial Document Type]          
      ,TARGET.[Applied Vend_ Ledger Entry No_]             = SOURCE.[Applied Vend_ Ledger Entry No_] 
      ,TARGET.[Unapplied]                                  = SOURCE.[Unapplied]                      
      ,TARGET.[Unapplied by Entry No_]                     = SOURCE.    [Unapplied by Entry No_]         
      ,TARGET.[Tax Jurisdiction Code]                      = SOURCE.    [Tax Jurisdiction Code]          
      ,TARGET.[Application No_]                            = SOURCE.    [Application No_]                
      ,TARGET.[Ledger Entry Amount]                        = SOURCE.    [Ledger Entry Amount]            
      ,TARGET.[Tipo Operazione CDV]                        = SOURCE.    [Tipo Operazione CDV]            
                           
    
	   
	  WHEN NOT MATCHED
	  THEN INSERT (
	
	  [Posting Date]
      ,[FornitoreKey]
      ,[StagioneKey]
      ,[pccdckey]
      ,[Reason Code]
      ,[User ID]
      ,[tipoOperazioneContabile]
      ,[tipoOperazioneContabile_det]
      ,[Entry No_]
      ,[Dettaglio_Document Type]
      ,[Document Type]
      ,[Document No_]
      ,[Journal Batch Name]
      ,[Transaction No_]
      ,[Currency Code]
      ,[Remaining Pmt_ Disc_ Possible]
      ,[Max_ Payment Tolerance]
      ,[Contract Bonus Line]
      ,[Vendor No_]
      ,[Vendor Ledger Entry No_]
      ,[Entry Type]
      ,[Amount]
      ,[Amount (LCY)]
      ,[Debit Amount]
      ,[Credit Amount]
      ,[Debit Amount (LCY)]
      ,[Credit Amount (LCY)]
      ,[Initial Entry Due Date]
      ,[Gen_ Bus_ Posting Group]
      ,[Gen_ Prod_ Posting Group]
      ,[Use Tax]
      ,[VAT Bus_ Posting Group]
      ,[VAT Prod_ Posting Group]
      ,[Initial Document Type]
      ,[Applied Vend_ Ledger Entry No_]
      ,[Unapplied]
      ,[Unapplied by Entry No_]
      ,[Tax Jurisdiction Code]
      ,[Application No_]
      ,[Ledger Entry Amount]
      ,[Tipo Operazione CDV]
      ,[Company]
	  )
	  VALUES (

	   [Posting Date]
      ,[FornitoreKey]
      ,[StagioneKey]
      ,[pccdckey]
      ,[Reason Code]
      ,[User ID]
      ,[tipoOperazioneContabile]
      ,[tipoOperazioneContabile_det]
      ,[Entry No_]
      ,[Dettaglio_Document Type]
      ,[Document Type]
      ,[Document No_]
      ,[Journal Batch Name]
      ,[Transaction No_]
      ,[Currency Code]
      ,[Remaining Pmt_ Disc_ Possible]
      ,[Max_ Payment Tolerance]
      ,[Contract Bonus Line]
      ,[Vendor No_]
      ,[Vendor Ledger Entry No_]
      ,[Entry Type]
      ,[Amount]
      ,[Amount (LCY)]
      ,[Debit Amount]
      ,[Credit Amount]
      ,[Debit Amount (LCY)]
      ,[Credit Amount (LCY)]
      ,[Initial Entry Due Date]
      ,[Gen_ Bus_ Posting Group]
      ,[Gen_ Prod_ Posting Group]
      ,[Use Tax]
      ,[VAT Bus_ Posting Group]
      ,[VAT Prod_ Posting Group]
      ,[Initial Document Type]
      ,[Applied Vend_ Ledger Entry No_]
      ,[Unapplied]
      ,[Unapplied by Entry No_]
      ,[Tax Jurisdiction Code]
      ,[Application No_]
      ,[Ledger Entry Amount]
      ,[Tipo Operazione CDV]
      ,[Company]
	  );</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{59FD8CDB-3F53-4165-BA05-D5B2981AD60B}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;MERGE [BI_Model_DWH].[dbo].[FactContabilità] AS TARGET USING (&#xA;&#xA;SELECT [Gen_ Bus_ Posting Group]&#xA;      ,[Tax Area Code]&#xA;      ,[Tax Liable]&#xA;      ,[VAT Bus_ Posting Group]&#xA;      ,[Posting Date]&#xA;      ,[Bal_ Account No_]&#xA;      ,[Reason Code]&#xA;      ,[Bal_ Account Type]&#xA;      ,[dataDocumento]&#xA;      ,[No_ Series]&#xA;      ,[User ID]&#xA;      ,[Entry No_]&#xA;      ,[ContoKey]&#xA;      ,[pccdcKey]&#xA;      ,[subcanaleKey]&#xA;      ,[canaleKey]&#xA;      ,[StagioneVenditaKey]&#xA;      ,[Stagione]&#xA;      ,[tipoDocumento]&#xA;      ,[Document No_]&#xA;      ,[Description]&#xA;      ,[Amount]&#xA;      ,[Marchio]&#xA;      ,[System-Created Entry]&#xA;      ,[Prior-Year Entry]&#xA;      ,[Job No_]&#xA;      ,[Quantity]&#xA;      ,[VAT Amount]&#xA;      ,[Business Unit Code]&#xA;      ,[Journal Batch Name]&#xA;      ,[Gen_ Posting Type]&#xA;      ,[Gen_ Prod_ Posting Group]&#xA;      ,[Transaction No_]&#xA;      ,[Debit Amount]&#xA;      ,[Credit Amount]&#xA;      ,[External Document No_]&#xA;      ,[Source Code]&#xA;      ,[SourceType]&#xA;      ,[Source No_]&#xA;      ,[Tax Group Code]&#xA;      ,[Use Tax]&#xA;      ,[VAT Prod_ Posting Group]&#xA;      ,[Additional-Currency Amount]&#xA;      ,[Add_-Currency Debit Amount]&#xA;      ,[Add_-Currency Credit Amount]&#xA;      ,[Close Income Statement Dim_ ID]&#xA;      ,[IC Partner Code]&#xA;      ,[Reversed]&#xA;      ,[Reversed by Entry No_]&#xA;      ,[Reversed Entry No_]&#xA;      ,[Prod_ Order No_]&#xA;      ,[FA Entry Type]&#xA;      ,[FA Entry No_]&#xA;      ,[Official Date]&#xA;      ,[Positive]&#xA;      ,[Last Modified DateTime]&#xA;      ,[Description 2]&#xA;      ,[Due Date]&#xA;      ,[Letter No_]&#xA;      ,[Competence]&#xA;      ,[Competence Starting Date]&#xA;      ,[Competence Ending Date]&#xA;      ,[Competence Line]&#xA;      ,[Subsidiary Account Type]&#xA;      ,[Subsidiary Account Code]&#xA;      ,[Currency Code]&#xA;      ,[Amount OCY]&#xA;      ,[SUBC Currency Code]&#xA;      ,[Amount SUBC Currency Code]&#xA;      ,[Balance line competence]&#xA;      ,[Not Process]&#xA;      ,[Letter]&#xA;      ,[Letter Date]&#xA;      ,[Applied by UserID]&#xA;      ,[Closed]&#xA;      ,[Prepayment Ref_ No_]&#xA;      ,[Customer Order Ref_]&#xA;      ,[Customer Name]&#xA;      ,[Linea]&#xA;      ,[Canale]&#xA;      ,[Modello]&#xA;      ,[Collezione]&#xA;      ,[PCCDC]&#xA;      ,[Subcanale]&#xA;      ,[Main Order Ref_]&#xA;      ,[Tipo Operazione CDV]&#xA;      ,[Company]&#xA;  FROM [BI_Model_Stage].[stg].[vFactContabilità] fct&#xA;  inner join ( SELECT MAX([MaxTimestamp]) as maxtimestamp from [BI_Model_Stage].cfg.Config_Delta) cfg&#xA;  on fct.timestamp &gt; cfg.maxtimestamp&#xA;     ) AS SOURCE &#xA;  ON   SOURCE.[Entry No_]      = TARGET.[Entry No_]   &#xA;  AND  SOURCE.[Document No_]   = TARGET.[Document No_]&#xA;  AND  SOURCE.[Company]        = TARGET.[Company]     &#xA;  &#xA;  WHEN MATCHED&#xA;  THEN UPDATE SET &#xA;&#x9; &#xA;&#x9; TARGET.[Gen_ Bus_ Posting Group]       =           SOURCE.[Gen_ Bus_ Posting Group]            &#xA;  , TARGET.[Tax Area Code]                  =          SOURCE.[Tax Area Code]                      &#xA;  , TARGET.[Tax Liable]                     =          SOURCE.[Tax Liable]                         &#xA;  , TARGET.[VAT Bus_ Posting Group]         =          SOURCE.[VAT Bus_ Posting Group]             &#xA;  , TARGET.[Posting Date]                   =          SOURCE.[Posting Date]                       &#xA;  , TARGET.[Bal_ Account No_]               =          SOURCE.[Bal_ Account No_]                   &#xA;  , TARGET.[Reason Code]                    =          SOURCE.[Reason Code]                        &#xA;  , TARGET.[Bal_ Account Type]              =          SOURCE.[Bal_ Account Type]                  &#xA;  , TARGET.[dataDocumento]                  =          SOURCE.[dataDocumento]                      &#xA;  , TARGET.[No_ Series]                     =          SOURCE.[No_ Series]                         &#xA;  , TARGET.[User ID]                        =          SOURCE.[User ID]                            &#xA;                         &#xA;  , TARGET.[ContoKey]                       =          SOURCE.[ContoKey]                           &#xA;  , TARGET.[pccdcKey]                       =          SOURCE.[pccdcKey]                           &#xA;  , TARGET.[subcanaleKey]                   =          SOURCE.[subcanaleKey]                       &#xA;  , TARGET.[canaleKey]                      =          SOURCE.[canaleKey]                          &#xA;  , TARGET.[StagioneVenditaKey]             =          SOURCE.[StagioneVenditaKey]                 &#xA;  , TARGET.[Stagione]                       =          SOURCE.[Stagione]                           &#xA;  , TARGET.[tipoDocumento]                  =          SOURCE.[tipoDocumento]                      &#xA;                     &#xA;  , TARGET.[Description]                    =          SOURCE.[Description]                        &#xA;  , TARGET.[Amount]                         =          SOURCE.[Amount]                             &#xA;  , TARGET.[Marchio]                        =          SOURCE.[Marchio]                            &#xA;  , TARGET.[System-Created Entry]           =          SOURCE.[System-Created Entry]               &#xA;  , TARGET.[Prior-Year Entry]               =          SOURCE.[Prior-Year Entry]                   &#xA;  , TARGET.[Job No_]                        =          SOURCE.[Job No_]                            &#xA;  , TARGET.[Quantity]                       =          SOURCE.[Quantity]                           &#xA;  , TARGET.[VAT Amount]                     =          SOURCE.[VAT Amount]                         &#xA;  , TARGET.[Business Unit Code]             =          SOURCE.[Business Unit Code]                 &#xA;  , TARGET.[Journal Batch Name]             =          SOURCE.[Journal Batch Name]                 &#xA;  , TARGET.[Gen_ Posting Type]              =          SOURCE.[Gen_ Posting Type]                  &#xA;  , TARGET.[Gen_ Prod_ Posting Group]       =          SOURCE.[Gen_ Prod_ Posting Group]           &#xA;  , TARGET.[Transaction No_]                =          SOURCE.[Transaction No_]                    &#xA;  , TARGET.[Debit Amount]                   =          SOURCE.[Debit Amount]                       &#xA;  , TARGET.[Credit Amount]                  =          SOURCE.[Credit Amount]                      &#xA;  , TARGET.[External Document No_]          =          SOURCE.[External Document No_]              &#xA;  , TARGET.[Source Code]                    =          SOURCE.[Source Code]                        &#xA;  , TARGET.[SourceType]                     =          SOURCE.[SourceType]                         &#xA;  , TARGET.[Source No_]                     =          SOURCE.[Source No_]                         &#xA;  , TARGET.[Tax Group Code]                 =          SOURCE.[Tax Group Code]                     &#xA;  , TARGET.[Use Tax]                        =          SOURCE.[Use Tax]                            &#xA;  , TARGET.[VAT Prod_ Posting Group]        =          SOURCE.[VAT Prod_ Posting Group]            &#xA;  , TARGET.[Additional-Currency Amount]     =          SOURCE.[Additional-Currency Amount]         &#xA;  , TARGET.[Add_-Currency Debit Amount]     =          SOURCE.[Add_-Currency Debit Amount]         &#xA;  , TARGET.[Add_-Currency Credit Amount]    =          SOURCE.[Add_-Currency Credit Amount]        &#xA;  , TARGET.[Close Income Statement Dim_ ID] =          SOURCE.[Close Income Statement Dim_ ID]     &#xA;  , TARGET.[IC Partner Code]                =          SOURCE.[IC Partner Code]                    &#xA;  , TARGET.[Reversed]                       =          SOURCE.[Reversed]                           &#xA;  , TARGET.[Reversed by Entry No_]          =          SOURCE.[Reversed by Entry No_]              &#xA;  , TARGET.[Reversed Entry No_]             =          SOURCE.[Reversed Entry No_]                 &#xA;  , TARGET.[Prod_ Order No_]                =          SOURCE.[Prod_ Order No_]                    &#xA;  , TARGET.[FA Entry Type]                  =          SOURCE.[FA Entry Type]                      &#xA;  , TARGET.[FA Entry No_]                   =          SOURCE.[FA Entry No_]                       &#xA;  , TARGET.[Official Date]                  =          SOURCE.[Official Date]                      &#xA;  , TARGET.[Positive]                       =          SOURCE.[Positive]                           &#xA;  , TARGET.[Last Modified DateTime]         =          SOURCE.[Last Modified DateTime]             &#xA;  , TARGET.[Description 2]                  =          SOURCE.[Description 2]                      &#xA;  , TARGET.[Due Date]                       =          SOURCE.[Due Date]                           &#xA;  , TARGET.[Letter No_]                     =          SOURCE.[Letter No_]                         &#xA;  , TARGET.[Competence]                     =          SOURCE.[Competence]                         &#xA;  , TARGET.[Competence Starting Date]       =          SOURCE.[Competence Starting Date]           &#xA;  , TARGET.[Competence Ending Date]         =          SOURCE.[Competence Ending Date]             &#xA;  , TARGET.[Competence Line]                =          SOURCE.[Competence Line]                    &#xA;  , TARGET.[Subsidiary Account Type]        =          SOURCE.[Subsidiary Account Type]            &#xA;  , TARGET.[Subsidiary Account Code]        =          SOURCE.[Subsidiary Account Code]            &#xA;  , TARGET.[Currency Code]                  =          SOURCE.[Currency Code]                      &#xA;  , TARGET.[Amount OCY]                     =          SOURCE.[Amount OCY]                         &#xA;  , TARGET.[SUBC Currency Code]             =          SOURCE.[SUBC Currency Code]                 &#xA;  , TARGET.[Amount SUBC Currency Code]      =          SOURCE.[Amount SUBC Currency Code]          &#xA;  , TARGET.[Balance line competence]        =          SOURCE.[Balance line competence]            &#xA;  , TARGET.[Not Process]                    =          SOURCE.[Not Process]                        &#xA;  , TARGET.[Letter]                         =          SOURCE.[Letter]                             &#xA;  , TARGET.[Letter Date]                    =          SOURCE.[Letter Date]                        &#xA;  , TARGET.[Applied by UserID]              =          SOURCE.[Applied by UserID]                  &#xA;  , TARGET.[Closed]                         =          SOURCE.[Closed]                             &#xA;  , TARGET.[Prepayment Ref_ No_]            =          SOURCE.[Prepayment Ref_ No_]                &#xA;  , TARGET.[Customer Order Ref_]            =          SOURCE.[Customer Order Ref_]                &#xA;  , TARGET.[Customer Name]                  =          SOURCE.[Customer Name]                      &#xA;  , TARGET.[Linea]                          =          SOURCE.[Linea]                              &#xA;  , TARGET.[Canale]                         =          SOURCE.[Canale]                             &#xA;  , TARGET.[Modello]                        =          SOURCE.[Modello]                            &#xA;  , TARGET.[Collezione]                     =          SOURCE.[Collezione]                         &#xA;  , TARGET.[PCCDC]                          =          SOURCE.[PCCDC]                              &#xA;  , TARGET.[Subcanale]                      =          SOURCE.[Subcanale]                          &#xA;  , TARGET.[Main Order Ref_]                =          SOURCE.[Main Order Ref_]                    &#xA;  , TARGET.[Tipo Operazione CDV]            =          SOURCE.[Tipo Operazione CDV]                &#xA;                            &#xA;    &#xA;&#x9;   &#xA;&#x9;  WHEN NOT MATCHED&#xA;&#x9;  THEN INSERT (&#xA;&#xA;&#x9;  [Gen_ Bus_ Posting Group]&#xA;      ,[Tax Area Code]&#xA;      ,[Tax Liable]&#xA;      ,[VAT Bus_ Posting Group]&#xA;      ,[Posting Date]&#xA;      ,[Bal_ Account No_]&#xA;      ,[Reason Code]&#xA;      ,[Bal_ Account Type]&#xA;      ,[dataDocumento]&#xA;      ,[No_ Series]&#xA;      ,[User ID]&#xA;      ,[Entry No_]&#xA;      ,[ContoKey]&#xA;      ,[pccdcKey]&#xA;      ,[subcanaleKey]&#xA;      ,[canaleKey]&#xA;      ,[StagioneVenditaKey]&#xA;      ,[Stagione]&#xA;      ,[tipoDocumento]&#xA;      ,[Document No_]&#xA;      ,[Description]&#xA;      ,[Amount]&#xA;      ,[Marchio]&#xA;      ,[System-Created Entry]&#xA;      ,[Prior-Year Entry]&#xA;      ,[Job No_]&#xA;      ,[Quantity]&#xA;      ,[VAT Amount]&#xA;      ,[Business Unit Code]&#xA;      ,[Journal Batch Name]&#xA;      ,[Gen_ Posting Type]&#xA;      ,[Gen_ Prod_ Posting Group]&#xA;      ,[Transaction No_]&#xA;      ,[Debit Amount]&#xA;      ,[Credit Amount]&#xA;      ,[External Document No_]&#xA;      ,[Source Code]&#xA;      ,[SourceType]&#xA;      ,[Source No_]&#xA;      ,[Tax Group Code]&#xA;      ,[Use Tax]&#xA;      ,[VAT Prod_ Posting Group]&#xA;      ,[Additional-Currency Amount]&#xA;      ,[Add_-Currency Debit Amount]&#xA;      ,[Add_-Currency Credit Amount]&#xA;      ,[Close Income Statement Dim_ ID]&#xA;      ,[IC Partner Code]&#xA;      ,[Reversed]&#xA;      ,[Reversed by Entry No_]&#xA;      ,[Reversed Entry No_]&#xA;      ,[Prod_ Order No_]&#xA;      ,[FA Entry Type]&#xA;      ,[FA Entry No_]&#xA;      ,[Official Date]&#xA;      ,[Positive]&#xA;      ,[Last Modified DateTime]&#xA;      ,[Description 2]&#xA;      ,[Due Date]&#xA;      ,[Letter No_]&#xA;      ,[Competence]&#xA;      ,[Competence Starting Date]&#xA;      ,[Competence Ending Date]&#xA;      ,[Competence Line]&#xA;      ,[Subsidiary Account Type]&#xA;      ,[Subsidiary Account Code]&#xA;      ,[Currency Code]&#xA;      ,[Amount OCY]&#xA;      ,[SUBC Currency Code]&#xA;      ,[Amount SUBC Currency Code]&#xA;      ,[Balance line competence]&#xA;      ,[Not Process]&#xA;      ,[Letter]&#xA;      ,[Letter Date]&#xA;      ,[Applied by UserID]&#xA;      ,[Closed]&#xA;      ,[Prepayment Ref_ No_]&#xA;      ,[Customer Order Ref_]&#xA;      ,[Customer Name]&#xA;      ,[Linea]&#xA;      ,[Canale]&#xA;      ,[Modello]&#xA;      ,[Collezione]&#xA;      ,[PCCDC]&#xA;      ,[Subcanale]&#xA;      ,[Main Order Ref_]&#xA;      ,[Tipo Operazione CDV]&#xA;      ,[Company]&#xA;&#x9;  )&#xA;&#x9;  VALUES (&#xA;&#xA;&#x9;   [Gen_ Bus_ Posting Group]&#xA;      ,[Tax Area Code]&#xA;      ,[Tax Liable]&#xA;      ,[VAT Bus_ Posting Group]&#xA;      ,[Posting Date]&#xA;      ,[Bal_ Account No_]&#xA;      ,[Reason Code]&#xA;      ,[Bal_ Account Type]&#xA;      ,[dataDocumento]&#xA;      ,[No_ Series]&#xA;      ,[User ID]&#xA;      ,[Entry No_]&#xA;      ,[ContoKey]&#xA;      ,[pccdcKey]&#xA;      ,[subcanaleKey]&#xA;      ,[canaleKey]&#xA;      ,[StagioneVenditaKey]&#xA;      ,[Stagione]&#xA;      ,[tipoDocumento]&#xA;      ,[Document No_]&#xA;      ,[Description]&#xA;      ,[Amount]&#xA;      ,[Marchio]&#xA;      ,[System-Created Entry]&#xA;      ,[Prior-Year Entry]&#xA;      ,[Job No_]&#xA;      ,[Quantity]&#xA;      ,[VAT Amount]&#xA;      ,[Business Unit Code]&#xA;      ,[Journal Batch Name]&#xA;      ,[Gen_ Posting Type]&#xA;      ,[Gen_ Prod_ Posting Group]&#xA;      ,[Transaction No_]&#xA;      ,[Debit Amount]&#xA;      ,[Credit Amount]&#xA;      ,[External Document No_]&#xA;      ,[Source Code]&#xA;      ,[SourceType]&#xA;      ,[Source No_]&#xA;      ,[Tax Group Code]&#xA;      ,[Use Tax]&#xA;      ,[VAT Prod_ Posting Group]&#xA;      ,[Additional-Currency Amount]&#xA;      ,[Add_-Currency Debit Amount]&#xA;      ,[Add_-Currency Credit Amount]&#xA;      ,[Close Income Statement Dim_ ID]&#xA;      ,[IC Partner Code]&#xA;      ,[Reversed]&#xA;      ,[Reversed by Entry No_]&#xA;      ,[Reversed Entry No_]&#xA;      ,[Prod_ Order No_]&#xA;      ,[FA Entry Type]&#xA;      ,[FA Entry No_]&#xA;      ,[Official Date]&#xA;      ,[Positive]&#xA;      ,[Last Modified DateTime]&#xA;      ,[Description 2]&#xA;      ,[Due Date]&#xA;      ,[Letter No_]&#xA;      ,[Competence]&#xA;      ,[Competence Starting Date]&#xA;      ,[Competence Ending Date]&#xA;      ,[Competence Line]&#xA;      ,[Subsidiary Account Type]&#xA;      ,[Subsidiary Account Code]&#xA;      ,[Currency Code]&#xA;      ,[Amount OCY]&#xA;      ,[SUBC Currency Code]&#xA;      ,[Amount SUBC Currency Code]&#xA;      ,[Balance line competence]&#xA;      ,[Not Process]&#xA;      ,[Letter]&#xA;      ,[Letter Date]&#xA;      ,[Applied by UserID]&#xA;      ,[Closed]&#xA;      ,[Prepayment Ref_ No_]&#xA;      ,[Customer Order Ref_]&#xA;      ,[Customer Name]&#xA;      ,[Linea]&#xA;      ,[Canale]&#xA;      ,[Modello]&#xA;      ,[Collezione]&#xA;      ,[PCCDC]&#xA;      ,[Subcanale]&#xA;      ,[Main Order Ref_]&#xA;      ,[Tipo Operazione CDV]&#xA;      ,[Company]&#xA;&#x9;  );&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="Populate_FactContabilità">
      <DTS:VariableValue
        DTS:DataType="8">MERGE [BI_Model_DWH].[dbo].[FactContabilità] AS TARGET USING (

SELECT [Gen_ Bus_ Posting Group]
      ,[Tax Area Code]
      ,[Tax Liable]
      ,[VAT Bus_ Posting Group]
      ,[Posting Date]
      ,[Bal_ Account No_]
      ,[Reason Code]
      ,[Bal_ Account Type]
      ,[dataDocumento]
      ,[No_ Series]
      ,[User ID]
      ,[Entry No_]
      ,[ContoKey]
      ,[pccdcKey]
      ,[subcanaleKey]
      ,[canaleKey]
      ,[StagioneVenditaKey]
      ,[Stagione]
      ,[tipoDocumento]
      ,[Document No_]
      ,[Description]
      ,[Amount]
      ,[Marchio]
      ,[System-Created Entry]
      ,[Prior-Year Entry]
      ,[Job No_]
      ,[Quantity]
      ,[VAT Amount]
      ,[Business Unit Code]
      ,[Journal Batch Name]
      ,[Gen_ Posting Type]
      ,[Gen_ Prod_ Posting Group]
      ,[Transaction No_]
      ,[Debit Amount]
      ,[Credit Amount]
      ,[External Document No_]
      ,[Source Code]
      ,[SourceType]
      ,[Source No_]
      ,[Tax Group Code]
      ,[Use Tax]
      ,[VAT Prod_ Posting Group]
      ,[Additional-Currency Amount]
      ,[Add_-Currency Debit Amount]
      ,[Add_-Currency Credit Amount]
      ,[Close Income Statement Dim_ ID]
      ,[IC Partner Code]
      ,[Reversed]
      ,[Reversed by Entry No_]
      ,[Reversed Entry No_]
      ,[Prod_ Order No_]
      ,[FA Entry Type]
      ,[FA Entry No_]
      ,[Official Date]
      ,[Positive]
      ,[Last Modified DateTime]
      ,[Description 2]
      ,[Due Date]
      ,[Letter No_]
      ,[Competence]
      ,[Competence Starting Date]
      ,[Competence Ending Date]
      ,[Competence Line]
      ,[Subsidiary Account Type]
      ,[Subsidiary Account Code]
      ,[Currency Code]
      ,[Amount OCY]
      ,[SUBC Currency Code]
      ,[Amount SUBC Currency Code]
      ,[Balance line competence]
      ,[Not Process]
      ,[Letter]
      ,[Letter Date]
      ,[Applied by UserID]
      ,[Closed]
      ,[Prepayment Ref_ No_]
      ,[Customer Order Ref_]
      ,[Customer Name]
      ,[Linea]
      ,[Canale]
      ,[Modello]
      ,[Collezione]
      ,[PCCDC]
      ,[Subcanale]
      ,[Main Order Ref_]
      ,[Tipo Operazione CDV]
      ,[Company]
  FROM [BI_Model_Stage].[stg].[vFactContabilità] fct
  inner join ( SELECT MAX([MaxTimestamp]) as maxtimestamp from [BI_Model_Stage].cfg.Config_Delta) cfg
  on fct.timestamp &gt; cfg.maxtimestamp
     ) AS SOURCE 
  ON   SOURCE.[Entry No_]      = TARGET.[Entry No_]   
  AND  SOURCE.[Document No_]   = TARGET.[Document No_]
  AND  SOURCE.[Company]        = TARGET.[Company]     
  
  WHEN MATCHED
  THEN UPDATE SET 
	 
	 TARGET.[Gen_ Bus_ Posting Group]       =           SOURCE.[Gen_ Bus_ Posting Group]            
  , TARGET.[Tax Area Code]                  =          SOURCE.[Tax Area Code]                      
  , TARGET.[Tax Liable]                     =          SOURCE.[Tax Liable]                         
  , TARGET.[VAT Bus_ Posting Group]         =          SOURCE.[VAT Bus_ Posting Group]             
  , TARGET.[Posting Date]                   =          SOURCE.[Posting Date]                       
  , TARGET.[Bal_ Account No_]               =          SOURCE.[Bal_ Account No_]                   
  , TARGET.[Reason Code]                    =          SOURCE.[Reason Code]                        
  , TARGET.[Bal_ Account Type]              =          SOURCE.[Bal_ Account Type]                  
  , TARGET.[dataDocumento]                  =          SOURCE.[dataDocumento]                      
  , TARGET.[No_ Series]                     =          SOURCE.[No_ Series]                         
  , TARGET.[User ID]                        =          SOURCE.[User ID]                            
                         
  , TARGET.[ContoKey]                       =          SOURCE.[ContoKey]                           
  , TARGET.[pccdcKey]                       =          SOURCE.[pccdcKey]                           
  , TARGET.[subcanaleKey]                   =          SOURCE.[subcanaleKey]                       
  , TARGET.[canaleKey]                      =          SOURCE.[canaleKey]                          
  , TARGET.[StagioneVenditaKey]             =          SOURCE.[StagioneVenditaKey]                 
  , TARGET.[Stagione]                       =          SOURCE.[Stagione]                           
  , TARGET.[tipoDocumento]                  =          SOURCE.[tipoDocumento]                      
                     
  , TARGET.[Description]                    =          SOURCE.[Description]                        
  , TARGET.[Amount]                         =          SOURCE.[Amount]                             
  , TARGET.[Marchio]                        =          SOURCE.[Marchio]                            
  , TARGET.[System-Created Entry]           =          SOURCE.[System-Created Entry]               
  , TARGET.[Prior-Year Entry]               =          SOURCE.[Prior-Year Entry]                   
  , TARGET.[Job No_]                        =          SOURCE.[Job No_]                            
  , TARGET.[Quantity]                       =          SOURCE.[Quantity]                           
  , TARGET.[VAT Amount]                     =          SOURCE.[VAT Amount]                         
  , TARGET.[Business Unit Code]             =          SOURCE.[Business Unit Code]                 
  , TARGET.[Journal Batch Name]             =          SOURCE.[Journal Batch Name]                 
  , TARGET.[Gen_ Posting Type]              =          SOURCE.[Gen_ Posting Type]                  
  , TARGET.[Gen_ Prod_ Posting Group]       =          SOURCE.[Gen_ Prod_ Posting Group]           
  , TARGET.[Transaction No_]                =          SOURCE.[Transaction No_]                    
  , TARGET.[Debit Amount]                   =          SOURCE.[Debit Amount]                       
  , TARGET.[Credit Amount]                  =          SOURCE.[Credit Amount]                      
  , TARGET.[External Document No_]          =          SOURCE.[External Document No_]              
  , TARGET.[Source Code]                    =          SOURCE.[Source Code]                        
  , TARGET.[SourceType]                     =          SOURCE.[SourceType]                         
  , TARGET.[Source No_]                     =          SOURCE.[Source No_]                         
  , TARGET.[Tax Group Code]                 =          SOURCE.[Tax Group Code]                     
  , TARGET.[Use Tax]                        =          SOURCE.[Use Tax]                            
  , TARGET.[VAT Prod_ Posting Group]        =          SOURCE.[VAT Prod_ Posting Group]            
  , TARGET.[Additional-Currency Amount]     =          SOURCE.[Additional-Currency Amount]         
  , TARGET.[Add_-Currency Debit Amount]     =          SOURCE.[Add_-Currency Debit Amount]         
  , TARGET.[Add_-Currency Credit Amount]    =          SOURCE.[Add_-Currency Credit Amount]        
  , TARGET.[Close Income Statement Dim_ ID] =          SOURCE.[Close Income Statement Dim_ ID]     
  , TARGET.[IC Partner Code]                =          SOURCE.[IC Partner Code]                    
  , TARGET.[Reversed]                       =          SOURCE.[Reversed]                           
  , TARGET.[Reversed by Entry No_]          =          SOURCE.[Reversed by Entry No_]              
  , TARGET.[Reversed Entry No_]             =          SOURCE.[Reversed Entry No_]                 
  , TARGET.[Prod_ Order No_]                =          SOURCE.[Prod_ Order No_]                    
  , TARGET.[FA Entry Type]                  =          SOURCE.[FA Entry Type]                      
  , TARGET.[FA Entry No_]                   =          SOURCE.[FA Entry No_]                       
  , TARGET.[Official Date]                  =          SOURCE.[Official Date]                      
  , TARGET.[Positive]                       =          SOURCE.[Positive]                           
  , TARGET.[Last Modified DateTime]         =          SOURCE.[Last Modified DateTime]             
  , TARGET.[Description 2]                  =          SOURCE.[Description 2]                      
  , TARGET.[Due Date]                       =          SOURCE.[Due Date]                           
  , TARGET.[Letter No_]                     =          SOURCE.[Letter No_]                         
  , TARGET.[Competence]                     =          SOURCE.[Competence]                         
  , TARGET.[Competence Starting Date]       =          SOURCE.[Competence Starting Date]           
  , TARGET.[Competence Ending Date]         =          SOURCE.[Competence Ending Date]             
  , TARGET.[Competence Line]                =          SOURCE.[Competence Line]                    
  , TARGET.[Subsidiary Account Type]        =          SOURCE.[Subsidiary Account Type]            
  , TARGET.[Subsidiary Account Code]        =          SOURCE.[Subsidiary Account Code]            
  , TARGET.[Currency Code]                  =          SOURCE.[Currency Code]                      
  , TARGET.[Amount OCY]                     =          SOURCE.[Amount OCY]                         
  , TARGET.[SUBC Currency Code]             =          SOURCE.[SUBC Currency Code]                 
  , TARGET.[Amount SUBC Currency Code]      =          SOURCE.[Amount SUBC Currency Code]          
  , TARGET.[Balance line competence]        =          SOURCE.[Balance line competence]            
  , TARGET.[Not Process]                    =          SOURCE.[Not Process]                        
  , TARGET.[Letter]                         =          SOURCE.[Letter]                             
  , TARGET.[Letter Date]                    =          SOURCE.[Letter Date]                        
  , TARGET.[Applied by UserID]              =          SOURCE.[Applied by UserID]                  
  , TARGET.[Closed]                         =          SOURCE.[Closed]                             
  , TARGET.[Prepayment Ref_ No_]            =          SOURCE.[Prepayment Ref_ No_]                
  , TARGET.[Customer Order Ref_]            =          SOURCE.[Customer Order Ref_]                
  , TARGET.[Customer Name]                  =          SOURCE.[Customer Name]                      
  , TARGET.[Linea]                          =          SOURCE.[Linea]                              
  , TARGET.[Canale]                         =          SOURCE.[Canale]                             
  , TARGET.[Modello]                        =          SOURCE.[Modello]                            
  , TARGET.[Collezione]                     =          SOURCE.[Collezione]                         
  , TARGET.[PCCDC]                          =          SOURCE.[PCCDC]                              
  , TARGET.[Subcanale]                      =          SOURCE.[Subcanale]                          
  , TARGET.[Main Order Ref_]                =          SOURCE.[Main Order Ref_]                    
  , TARGET.[Tipo Operazione CDV]            =          SOURCE.[Tipo Operazione CDV]                
                            
    
	   
	  WHEN NOT MATCHED
	  THEN INSERT (

	  [Gen_ Bus_ Posting Group]
      ,[Tax Area Code]
      ,[Tax Liable]
      ,[VAT Bus_ Posting Group]
      ,[Posting Date]
      ,[Bal_ Account No_]
      ,[Reason Code]
      ,[Bal_ Account Type]
      ,[dataDocumento]
      ,[No_ Series]
      ,[User ID]
      ,[Entry No_]
      ,[ContoKey]
      ,[pccdcKey]
      ,[subcanaleKey]
      ,[canaleKey]
      ,[StagioneVenditaKey]
      ,[Stagione]
      ,[tipoDocumento]
      ,[Document No_]
      ,[Description]
      ,[Amount]
      ,[Marchio]
      ,[System-Created Entry]
      ,[Prior-Year Entry]
      ,[Job No_]
      ,[Quantity]
      ,[VAT Amount]
      ,[Business Unit Code]
      ,[Journal Batch Name]
      ,[Gen_ Posting Type]
      ,[Gen_ Prod_ Posting Group]
      ,[Transaction No_]
      ,[Debit Amount]
      ,[Credit Amount]
      ,[External Document No_]
      ,[Source Code]
      ,[SourceType]
      ,[Source No_]
      ,[Tax Group Code]
      ,[Use Tax]
      ,[VAT Prod_ Posting Group]
      ,[Additional-Currency Amount]
      ,[Add_-Currency Debit Amount]
      ,[Add_-Currency Credit Amount]
      ,[Close Income Statement Dim_ ID]
      ,[IC Partner Code]
      ,[Reversed]
      ,[Reversed by Entry No_]
      ,[Reversed Entry No_]
      ,[Prod_ Order No_]
      ,[FA Entry Type]
      ,[FA Entry No_]
      ,[Official Date]
      ,[Positive]
      ,[Last Modified DateTime]
      ,[Description 2]
      ,[Due Date]
      ,[Letter No_]
      ,[Competence]
      ,[Competence Starting Date]
      ,[Competence Ending Date]
      ,[Competence Line]
      ,[Subsidiary Account Type]
      ,[Subsidiary Account Code]
      ,[Currency Code]
      ,[Amount OCY]
      ,[SUBC Currency Code]
      ,[Amount SUBC Currency Code]
      ,[Balance line competence]
      ,[Not Process]
      ,[Letter]
      ,[Letter Date]
      ,[Applied by UserID]
      ,[Closed]
      ,[Prepayment Ref_ No_]
      ,[Customer Order Ref_]
      ,[Customer Name]
      ,[Linea]
      ,[Canale]
      ,[Modello]
      ,[Collezione]
      ,[PCCDC]
      ,[Subcanale]
      ,[Main Order Ref_]
      ,[Tipo Operazione CDV]
      ,[Company]
	  )
	  VALUES (

	   [Gen_ Bus_ Posting Group]
      ,[Tax Area Code]
      ,[Tax Liable]
      ,[VAT Bus_ Posting Group]
      ,[Posting Date]
      ,[Bal_ Account No_]
      ,[Reason Code]
      ,[Bal_ Account Type]
      ,[dataDocumento]
      ,[No_ Series]
      ,[User ID]
      ,[Entry No_]
      ,[ContoKey]
      ,[pccdcKey]
      ,[subcanaleKey]
      ,[canaleKey]
      ,[StagioneVenditaKey]
      ,[Stagione]
      ,[tipoDocumento]
      ,[Document No_]
      ,[Description]
      ,[Amount]
      ,[Marchio]
      ,[System-Created Entry]
      ,[Prior-Year Entry]
      ,[Job No_]
      ,[Quantity]
      ,[VAT Amount]
      ,[Business Unit Code]
      ,[Journal Batch Name]
      ,[Gen_ Posting Type]
      ,[Gen_ Prod_ Posting Group]
      ,[Transaction No_]
      ,[Debit Amount]
      ,[Credit Amount]
      ,[External Document No_]
      ,[Source Code]
      ,[SourceType]
      ,[Source No_]
      ,[Tax Group Code]
      ,[Use Tax]
      ,[VAT Prod_ Posting Group]
      ,[Additional-Currency Amount]
      ,[Add_-Currency Debit Amount]
      ,[Add_-Currency Credit Amount]
      ,[Close Income Statement Dim_ ID]
      ,[IC Partner Code]
      ,[Reversed]
      ,[Reversed by Entry No_]
      ,[Reversed Entry No_]
      ,[Prod_ Order No_]
      ,[FA Entry Type]
      ,[FA Entry No_]
      ,[Official Date]
      ,[Positive]
      ,[Last Modified DateTime]
      ,[Description 2]
      ,[Due Date]
      ,[Letter No_]
      ,[Competence]
      ,[Competence Starting Date]
      ,[Competence Ending Date]
      ,[Competence Line]
      ,[Subsidiary Account Type]
      ,[Subsidiary Account Code]
      ,[Currency Code]
      ,[Amount OCY]
      ,[SUBC Currency Code]
      ,[Amount SUBC Currency Code]
      ,[Balance line competence]
      ,[Not Process]
      ,[Letter]
      ,[Letter Date]
      ,[Applied by UserID]
      ,[Closed]
      ,[Prepayment Ref_ No_]
      ,[Customer Order Ref_]
      ,[Customer Name]
      ,[Linea]
      ,[Canale]
      ,[Modello]
      ,[Collezione]
      ,[PCCDC]
      ,[Subcanale]
      ,[Main Order Ref_]
      ,[Tipo Operazione CDV]
      ,[Company]
	  );</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{C5E7D95E-E861-47CA-AC2E-3EBA52640CEF}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;MERGE [BI_Model_DWH].[dbo].[FactCostoPreventivo] AS TARGET USING (&#xA;&#xA;SELECT [CostoPreventivoKey]&#xA;      ,[ArticoloModello]&#xA;      ,[StagioneKey]&#xA;      ,[CompanyKey]&#xA;      ,[M_CostoPreventivoInValuta]&#xA;      ,[M_CostoPreventivoEuro]&#xA;      ,[Location]&#xA;  FROM [BI_Model_Stage].[stg].[vFactCostoPreventivo] fct&#xA;  inner join ( SELECT MAX([MaxTimestamp]) as maxtimestamp from [BI_Model_Stage].cfg.Config_Delta) cfg&#xA;  on fct.timestamp &gt; cfg.maxtimestamp&#xA;     ) AS SOURCE &#xA;  ON SOURCE.[CostoPreventivoKey]= TARGET.[CostoPreventivoKey]&#xA;  &#xA;  &#xA;  WHEN MATCHED&#xA;  THEN UPDATE SET &#xA;&#x9;              &#xA;       TARGET.[M_CostoPreventivoInValuta]     = SOURCE.[M_CostoPreventivoInValuta]&#xA;      ,TARGET.[M_CostoPreventivoEuro]         = SOURCE.[M_CostoPreventivoEuro]    &#xA;                    &#xA;    &#xA;&#x9;   &#xA;&#x9;  WHEN NOT MATCHED&#xA;&#x9;  THEN INSERT (&#xA;&#x9;&#xA;&#x9;  [CostoPreventivoKey]&#xA;      ,[ArticoloModello]&#xA;      ,[StagioneKey]&#xA;      ,[CompanyKey]&#xA;      ,[M_CostoPreventivoInValuta]&#xA;      ,[M_CostoPreventivoEuro]&#xA;      ,[Location]&#xA;&#x9;  )&#xA;&#x9;  VALUES (&#xA;&#x9;&#xA;&#x9;   [CostoPreventivoKey]&#xA;      ,[ArticoloModello]&#xA;      ,[StagioneKey]&#xA;      ,[CompanyKey]&#xA;      ,[M_CostoPreventivoInValuta]&#xA;      ,[M_CostoPreventivoEuro]&#xA;      ,[Location]&#xA;&#x9;  );&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="Populate_FactCostoPreventivo">
      <DTS:VariableValue
        DTS:DataType="8">MERGE [BI_Model_DWH].[dbo].[FactCostoPreventivo] AS TARGET USING (

SELECT [CostoPreventivoKey]
      ,[ArticoloModello]
      ,[StagioneKey]
      ,[CompanyKey]
      ,[M_CostoPreventivoInValuta]
      ,[M_CostoPreventivoEuro]
      ,[Location]
  FROM [BI_Model_Stage].[stg].[vFactCostoPreventivo] fct
  inner join ( SELECT MAX([MaxTimestamp]) as maxtimestamp from [BI_Model_Stage].cfg.Config_Delta) cfg
  on fct.timestamp &gt; cfg.maxtimestamp
     ) AS SOURCE 
  ON SOURCE.[CostoPreventivoKey]= TARGET.[CostoPreventivoKey]
  
  
  WHEN MATCHED
  THEN UPDATE SET 
	              
       TARGET.[M_CostoPreventivoInValuta]     = SOURCE.[M_CostoPreventivoInValuta]
      ,TARGET.[M_CostoPreventivoEuro]         = SOURCE.[M_CostoPreventivoEuro]    
                    
    
	   
	  WHEN NOT MATCHED
	  THEN INSERT (
	
	  [CostoPreventivoKey]
      ,[ArticoloModello]
      ,[StagioneKey]
      ,[CompanyKey]
      ,[M_CostoPreventivoInValuta]
      ,[M_CostoPreventivoEuro]
      ,[Location]
	  )
	  VALUES (
	
	   [CostoPreventivoKey]
      ,[ArticoloModello]
      ,[StagioneKey]
      ,[CompanyKey]
      ,[M_CostoPreventivoInValuta]
      ,[M_CostoPreventivoEuro]
      ,[Location]
	  );</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{D2813EC8-2C5C-4550-B51F-3DE800E17B06}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;MERGE [BI_Model_DWH].[dbo].[FactFatturaAcquisto] AS TARGET USING (&#xA;&#xA;&#xA;&#xA;SELECT [FatturaAcquistoKey]&#xA;&#xA;      ,[ValutaKey]&#xA;&#xA;      ,[FornitoreKey]&#xA;&#xA;      ,[ArticoloKey]&#xA;&#xA;      ,[Marchio]&#xA;&#xA;      ,[MagazzinoKey]&#xA;&#xA;      ,[StagioneKey]&#xA;&#xA;      ,[Tipo]&#xA;&#xA;      ,[OrdineAcquistoKey]&#xA;&#xA;      ,[CompanyKey]&#xA;&#xA;      ,[DataKey]&#xA;&#xA;      ,[TestataFatturaAcquisto]&#xA;&#xA;      ,[RigaFatturaAcquisto]&#xA;&#xA;      ,[DescrizioneFatturaAcquisto]&#xA;&#xA;      ,[DataOrdineFatturaAcquisto]&#xA;&#xA;      ,[DataScadenzaFatturaAcquisto]&#xA;&#xA;      ,[DataDocumentoFatturaAcquisto]&#xA;&#xA;      ,[DataRegistrazioneFattura]&#xA;&#xA;      ,[VATRegistrationNumber]&#xA;&#xA;      ,[TipoDocumento]&#xA;&#xA;      ,[Importo Lordo In Valuta]&#xA;&#xA;      ,[Importo Sconto In Valuta]&#xA;&#xA;      ,[Importo Sconto Commerciale In Valuta]&#xA;&#xA;      ,[Importo Sconto Finanziario In Valuta]&#xA;&#xA;      ,[Importo IVA In Valuta]&#xA;&#xA;      ,[Importo Netto In Valuta]&#xA;&#xA;      ,[M_Quantità]&#xA;&#xA;      ,[Importo Lordo Euro]&#xA;&#xA;      ,[Importo Sconto Euro]&#xA;&#xA;      ,[Importo IVA Euro]&#xA;&#xA;      ,[Importo Netto Euro]&#xA;&#xA;      ,[Importo Sconto Commerciale Euro]&#xA;&#xA;      ,[Importo Sconto Finanziario Euro]&#xA;&#xA;      ,[Nome Cliente Spedizione]&#xA;&#xA;      ,[Tipo Operazione CDV]&#xA;&#xA;      ,[TipoFattura]&#xA;&#xA;      ,[Tipo Operazione]&#xA;&#xA;      ,[Currency Code]&#xA;&#xA;      ,[Currency Factor]&#xA;&#xA;  FROM [BI_Model_Stage].[stg].[vFactFatturaAcquisto] fct&#xA;&#xA;  inner join ( SELECT MAX([MaxTimestamp]) as maxtimestamp from [BI_Model_Stage].cfg.Config_Delta) cfg&#xA;&#xA;  on fct.timestamp &gt; cfg.maxtimestamp&#xA;&#xA;     ) AS SOURCE &#xA;&#xA;  ON SOURCE.[FatturaAcquistoKey]= TARGET.[FatturaAcquistoKey]&#xA;&#xA;  AND SOURCE.[TestataFatturaAcquisto]= TARGET.[TestataFatturaAcquisto]&#xA;&#xA;  &#xA;&#xA;  &#xA;&#xA;  WHEN MATCHED&#xA;&#xA;  THEN UPDATE SET &#xA;&#xA;&#x9;                       &#xA;&#xA;       TARGET.[ValutaKey]                                   = SOURCE.[ValutaKey]                                &#xA;&#xA;      ,TARGET.[FornitoreKey]                                = SOURCE.[FornitoreKey]                             &#xA;&#xA;      ,TARGET.[ArticoloKey]                                 = SOURCE.[ArticoloKey]                              &#xA;&#xA;      ,TARGET.[Marchio]                                     = SOURCE.[Marchio]                                  &#xA;&#xA;      ,TARGET.[MagazzinoKey]                                = SOURCE.[MagazzinoKey]                             &#xA;&#xA;      ,TARGET.[StagioneKey]                                 = SOURCE.[StagioneKey]                              &#xA;&#xA;      ,TARGET.[Tipo]                                        = SOURCE.[Tipo]                                     &#xA;&#xA;      ,TARGET.[OrdineAcquistoKey]                           = SOURCE.[OrdineAcquistoKey]                        &#xA;&#xA;                            &#xA;&#xA;      ,TARGET.[DataKey]                                     = SOURCE.[DataKey]                                  &#xA;&#xA;                    &#xA;&#xA;      ,TARGET.[DataOrdineFatturaAcquisto]                   = SOURCE.[DataOrdineFatturaAcquisto]                &#xA;&#xA;      ,TARGET.[DataScadenzaFatturaAcquisto]                 = SOURCE.[DataScadenzaFatturaAcquisto]              &#xA;&#xA;      ,TARGET.[DataDocumentoFatturaAcquisto]                = SOURCE.[DataDocumentoFatturaAcquisto]             &#xA;&#xA;      ,TARGET.[DataRegistrazioneFattura]                    = SOURCE.[DataRegistrazioneFattura]                 &#xA;&#xA;      ,TARGET.[VATRegistrationNumber]                       = SOURCE.[VATRegistrationNumber]                    &#xA;&#xA;      ,TARGET.[TipoDocumento]                               = SOURCE.[TipoDocumento]                            &#xA;&#xA;      ,TARGET.[Importo Lordo In Valuta]                     = SOURCE.[Importo Lordo In Valuta]                  &#xA;&#xA;      ,TARGET.[Importo Sconto In Valuta]                    = SOURCE.[Importo Sconto In Valuta]                 &#xA;&#xA;      ,TARGET.[Importo Sconto Commerciale In Valuta]        = SOURCE.[Importo Sconto Commerciale In Valuta]     &#xA;&#xA;      ,TARGET.[Importo Sconto Finanziario In Valuta]        = SOURCE.[Importo Sconto Finanziario In Valuta]     &#xA;&#xA;      ,TARGET.[Importo IVA In Valuta]                       = SOURCE.[Importo IVA In Valuta]                    &#xA;&#xA;      ,TARGET.[Importo Netto In Valuta]                     = SOURCE.[Importo Netto In Valuta]                  &#xA;&#xA;      ,TARGET.[M_Quantità]                                  = SOURCE.[M_Quantità]                               &#xA;&#xA;      ,TARGET.[Importo Lordo Euro]                          = SOURCE.[Importo Lordo Euro]                       &#xA;&#xA;      ,TARGET.[Importo Sconto Euro]                         = SOURCE.[Importo Sconto Euro]                      &#xA;&#xA;      ,TARGET.[Importo IVA Euro]                            = SOURCE.[Importo IVA Euro]                         &#xA;&#xA;      ,TARGET.[Importo Netto Euro]                          = SOURCE.[Importo Netto Euro]                       &#xA;&#xA;      ,TARGET.[Importo Sconto Commerciale Euro]             = SOURCE.[Importo Sconto Commerciale Euro]          &#xA;&#xA;      ,TARGET.[Importo Sconto Finanziario Euro]             = SOURCE.[Importo Sconto Finanziario Euro]          &#xA;&#xA;      ,TARGET.[Nome Cliente Spedizione]                     = SOURCE.[Nome Cliente Spedizione]                  &#xA;&#xA;      ,TARGET.[Tipo Operazione CDV]                         = SOURCE.[Tipo Operazione CDV]                      &#xA;&#xA;      ,TARGET.[TipoFattura]                                 = SOURCE.[TipoFattura]                              &#xA;&#xA;      ,TARGET.[Tipo Operazione]                             = SOURCE.[Tipo Operazione]                          &#xA;&#xA;      ,TARGET.[Currency Code]                               = SOURCE.[Currency Code]                            &#xA;&#xA;      ,TARGET.[Currency Factor]                             = SOURCE.[Currency Factor]                          &#xA;&#xA;&#x9;   &#xA;&#xA;&#x9;  WHEN NOT MATCHED&#xA;&#xA;&#x9;  THEN INSERT (&#xA;&#xA;&#x9;&#xA;&#xA;&#x9;  [FatturaAcquistoKey]&#xA;&#xA;      ,[ValutaKey]&#xA;&#xA;      ,[FornitoreKey]&#xA;&#xA;      ,[ArticoloKey]&#xA;&#xA;      ,[Marchio]&#xA;&#xA;      ,[MagazzinoKey]&#xA;&#xA;      ,[StagioneKey]&#xA;&#xA;      ,[Tipo]&#xA;&#xA;      ,[OrdineAcquistoKey]&#xA;&#xA;      ,[CompanyKey]&#xA;&#xA;      ,[DataKey]&#xA;&#xA;      ,[TestataFatturaAcquisto]&#xA;&#xA;      ,[RigaFatturaAcquisto]&#xA;&#xA;      ,[DescrizioneFatturaAcquisto]&#xA;&#xA;      ,[DataOrdineFatturaAcquisto]&#xA;&#xA;      ,[DataScadenzaFatturaAcquisto]&#xA;&#xA;      ,[DataDocumentoFatturaAcquisto]&#xA;&#xA;      ,[DataRegistrazioneFattura]&#xA;&#xA;      ,[VATRegistrationNumber]&#xA;&#xA;      ,[TipoDocumento]&#xA;&#xA;      ,[Importo Lordo In Valuta]&#xA;&#xA;      ,[Importo Sconto In Valuta]&#xA;&#xA;      ,[Importo Sconto Commerciale In Valuta]&#xA;&#xA;      ,[Importo Sconto Finanziario In Valuta]&#xA;&#xA;      ,[Importo IVA In Valuta]&#xA;&#xA;      ,[Importo Netto In Valuta]&#xA;&#xA;      ,[M_Quantità]&#xA;&#xA;      ,[Importo Lordo Euro]&#xA;&#xA;      ,[Importo Sconto Euro]&#xA;&#xA;      ,[Importo IVA Euro]&#xA;&#xA;      ,[Importo Netto Euro]&#xA;&#xA;      ,[Importo Sconto Commerciale Euro]&#xA;&#xA;      ,[Importo Sconto Finanziario Euro]&#xA;&#xA;      ,[Nome Cliente Spedizione]&#xA;&#xA;      ,[Tipo Operazione CDV]&#xA;&#xA;      ,[TipoFattura]&#xA;&#xA;      ,[Tipo Operazione]&#xA;&#xA;      ,[Currency Code]&#xA;&#xA;      ,[Currency Factor]&#xA;&#xA;&#x9;  )&#xA;&#xA;&#x9;  VALUES (&#xA;&#xA;&#xA;&#xA;&#x9;   [FatturaAcquistoKey]&#xA;&#xA;      ,[ValutaKey]&#xA;&#xA;      ,[FornitoreKey]&#xA;&#xA;      ,[ArticoloKey]&#xA;&#xA;      ,[Marchio]&#xA;&#xA;      ,[MagazzinoKey]&#xA;&#xA;      ,[StagioneKey]&#xA;&#xA;      ,[Tipo]&#xA;&#xA;      ,[OrdineAcquistoKey]&#xA;&#xA;      ,[CompanyKey]&#xA;&#xA;      ,[DataKey]&#xA;&#xA;      ,[TestataFatturaAcquisto]&#xA;&#xA;      ,[RigaFatturaAcquisto]&#xA;&#xA;      ,[DescrizioneFatturaAcquisto]&#xA;&#xA;      ,[DataOrdineFatturaAcquisto]&#xA;&#xA;      ,[DataScadenzaFatturaAcquisto]&#xA;&#xA;      ,[DataDocumentoFatturaAcquisto]&#xA;&#xA;      ,[DataRegistrazioneFattura]&#xA;&#xA;      ,[VATRegistrationNumber]&#xA;&#xA;      ,[TipoDocumento]&#xA;&#xA;      ,[Importo Lordo In Valuta]&#xA;&#xA;      ,[Importo Sconto In Valuta]&#xA;&#xA;      ,[Importo Sconto Commerciale In Valuta]&#xA;&#xA;      ,[Importo Sconto Finanziario In Valuta]&#xA;&#xA;      ,[Importo IVA In Valuta]&#xA;&#xA;      ,[Importo Netto In Valuta]&#xA;&#xA;      ,[M_Quantità]&#xA;&#xA;      ,[Importo Lordo Euro]&#xA;&#xA;      ,[Importo Sconto Euro]&#xA;&#xA;      ,[Importo IVA Euro]&#xA;&#xA;      ,[Importo Netto Euro]&#xA;&#xA;      ,[Importo Sconto Commerciale Euro]&#xA;&#xA;      ,[Importo Sconto Finanziario Euro]&#xA;&#xA;      ,[Nome Cliente Spedizione]&#xA;&#xA;      ,[Tipo Operazione CDV]&#xA;&#xA;      ,[TipoFattura]&#xA;&#xA;      ,[Tipo Operazione]&#xA;&#xA;      ,[Currency Code]&#xA;&#xA;      ,[Currency Factor]&#xA;&#xA;&#x9;  );&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="Populate_FactFatturaAcquisto">
      <DTS:VariableValue
        DTS:DataType="8">MERGE [BI_Model_DWH].[dbo].[FactFatturaAcquisto] AS TARGET USING (



SELECT [FatturaAcquistoKey]

      ,[ValutaKey]

      ,[FornitoreKey]

      ,[ArticoloKey]

      ,[Marchio]

      ,[MagazzinoKey]

      ,[StagioneKey]

      ,[Tipo]

      ,[OrdineAcquistoKey]

      ,[CompanyKey]

      ,[DataKey]

      ,[TestataFatturaAcquisto]

      ,[RigaFatturaAcquisto]

      ,[DescrizioneFatturaAcquisto]

      ,[DataOrdineFatturaAcquisto]

      ,[DataScadenzaFatturaAcquisto]

      ,[DataDocumentoFatturaAcquisto]

      ,[DataRegistrazioneFattura]

      ,[VATRegistrationNumber]

      ,[TipoDocumento]

      ,[Importo Lordo In Valuta]

      ,[Importo Sconto In Valuta]

      ,[Importo Sconto Commerciale In Valuta]

      ,[Importo Sconto Finanziario In Valuta]

      ,[Importo IVA In Valuta]

      ,[Importo Netto In Valuta]

      ,[M_Quantità]

      ,[Importo Lordo Euro]

      ,[Importo Sconto Euro]

      ,[Importo IVA Euro]

      ,[Importo Netto Euro]

      ,[Importo Sconto Commerciale Euro]

      ,[Importo Sconto Finanziario Euro]

      ,[Nome Cliente Spedizione]

      ,[Tipo Operazione CDV]

      ,[TipoFattura]

      ,[Tipo Operazione]

      ,[Currency Code]

      ,[Currency Factor]

  FROM [BI_Model_Stage].[stg].[vFactFatturaAcquisto] fct

  inner join ( SELECT MAX([MaxTimestamp]) as maxtimestamp from [BI_Model_Stage].cfg.Config_Delta) cfg

  on fct.timestamp &gt; cfg.maxtimestamp

     ) AS SOURCE 

  ON SOURCE.[FatturaAcquistoKey]= TARGET.[FatturaAcquistoKey]

  AND SOURCE.[TestataFatturaAcquisto]= TARGET.[TestataFatturaAcquisto]

  

  

  WHEN MATCHED

  THEN UPDATE SET 

	                       

       TARGET.[ValutaKey]                                   = SOURCE.[ValutaKey]                                

      ,TARGET.[FornitoreKey]                                = SOURCE.[FornitoreKey]                             

      ,TARGET.[ArticoloKey]                                 = SOURCE.[ArticoloKey]                              

      ,TARGET.[Marchio]                                     = SOURCE.[Marchio]                                  

      ,TARGET.[MagazzinoKey]                                = SOURCE.[MagazzinoKey]                             

      ,TARGET.[StagioneKey]                                 = SOURCE.[StagioneKey]                              

      ,TARGET.[Tipo]                                        = SOURCE.[Tipo]                                     

      ,TARGET.[OrdineAcquistoKey]                           = SOURCE.[OrdineAcquistoKey]                        

                            

      ,TARGET.[DataKey]                                     = SOURCE.[DataKey]                                  

                    

      ,TARGET.[DataOrdineFatturaAcquisto]                   = SOURCE.[DataOrdineFatturaAcquisto]                

      ,TARGET.[DataScadenzaFatturaAcquisto]                 = SOURCE.[DataScadenzaFatturaAcquisto]              

      ,TARGET.[DataDocumentoFatturaAcquisto]                = SOURCE.[DataDocumentoFatturaAcquisto]             

      ,TARGET.[DataRegistrazioneFattura]                    = SOURCE.[DataRegistrazioneFattura]                 

      ,TARGET.[VATRegistrationNumber]                       = SOURCE.[VATRegistrationNumber]                    

      ,TARGET.[TipoDocumento]                               = SOURCE.[TipoDocumento]                            

      ,TARGET.[Importo Lordo In Valuta]                     = SOURCE.[Importo Lordo In Valuta]                  

      ,TARGET.[Importo Sconto In Valuta]                    = SOURCE.[Importo Sconto In Valuta]                 

      ,TARGET.[Importo Sconto Commerciale In Valuta]        = SOURCE.[Importo Sconto Commerciale In Valuta]     

      ,TARGET.[Importo Sconto Finanziario In Valuta]        = SOURCE.[Importo Sconto Finanziario In Valuta]     

      ,TARGET.[Importo IVA In Valuta]                       = SOURCE.[Importo IVA In Valuta]                    

      ,TARGET.[Importo Netto In Valuta]                     = SOURCE.[Importo Netto In Valuta]                  

      ,TARGET.[M_Quantità]                                  = SOURCE.[M_Quantità]                               

      ,TARGET.[Importo Lordo Euro]                          = SOURCE.[Importo Lordo Euro]                       

      ,TARGET.[Importo Sconto Euro]                         = SOURCE.[Importo Sconto Euro]                      

      ,TARGET.[Importo IVA Euro]                            = SOURCE.[Importo IVA Euro]                         

      ,TARGET.[Importo Netto Euro]                          = SOURCE.[Importo Netto Euro]                       

      ,TARGET.[Importo Sconto Commerciale Euro]             = SOURCE.[Importo Sconto Commerciale Euro]          

      ,TARGET.[Importo Sconto Finanziario Euro]             = SOURCE.[Importo Sconto Finanziario Euro]          

      ,TARGET.[Nome Cliente Spedizione]                     = SOURCE.[Nome Cliente Spedizione]                  

      ,TARGET.[Tipo Operazione CDV]                         = SOURCE.[Tipo Operazione CDV]                      

      ,TARGET.[TipoFattura]                                 = SOURCE.[TipoFattura]                              

      ,TARGET.[Tipo Operazione]                             = SOURCE.[Tipo Operazione]                          

      ,TARGET.[Currency Code]                               = SOURCE.[Currency Code]                            

      ,TARGET.[Currency Factor]                             = SOURCE.[Currency Factor]                          

	   

	  WHEN NOT MATCHED

	  THEN INSERT (

	

	  [FatturaAcquistoKey]

      ,[ValutaKey]

      ,[FornitoreKey]

      ,[ArticoloKey]

      ,[Marchio]

      ,[MagazzinoKey]

      ,[StagioneKey]

      ,[Tipo]

      ,[OrdineAcquistoKey]

      ,[CompanyKey]

      ,[DataKey]

      ,[TestataFatturaAcquisto]

      ,[RigaFatturaAcquisto]

      ,[DescrizioneFatturaAcquisto]

      ,[DataOrdineFatturaAcquisto]

      ,[DataScadenzaFatturaAcquisto]

      ,[DataDocumentoFatturaAcquisto]

      ,[DataRegistrazioneFattura]

      ,[VATRegistrationNumber]

      ,[TipoDocumento]

      ,[Importo Lordo In Valuta]

      ,[Importo Sconto In Valuta]

      ,[Importo Sconto Commerciale In Valuta]

      ,[Importo Sconto Finanziario In Valuta]

      ,[Importo IVA In Valuta]

      ,[Importo Netto In Valuta]

      ,[M_Quantità]

      ,[Importo Lordo Euro]

      ,[Importo Sconto Euro]

      ,[Importo IVA Euro]

      ,[Importo Netto Euro]

      ,[Importo Sconto Commerciale Euro]

      ,[Importo Sconto Finanziario Euro]

      ,[Nome Cliente Spedizione]

      ,[Tipo Operazione CDV]

      ,[TipoFattura]

      ,[Tipo Operazione]

      ,[Currency Code]

      ,[Currency Factor]

	  )

	  VALUES (



	   [FatturaAcquistoKey]

      ,[ValutaKey]

      ,[FornitoreKey]

      ,[ArticoloKey]

      ,[Marchio]

      ,[MagazzinoKey]

      ,[StagioneKey]

      ,[Tipo]

      ,[OrdineAcquistoKey]

      ,[CompanyKey]

      ,[DataKey]

      ,[TestataFatturaAcquisto]

      ,[RigaFatturaAcquisto]

      ,[DescrizioneFatturaAcquisto]

      ,[DataOrdineFatturaAcquisto]

      ,[DataScadenzaFatturaAcquisto]

      ,[DataDocumentoFatturaAcquisto]

      ,[DataRegistrazioneFattura]

      ,[VATRegistrationNumber]

      ,[TipoDocumento]

      ,[Importo Lordo In Valuta]

      ,[Importo Sconto In Valuta]

      ,[Importo Sconto Commerciale In Valuta]

      ,[Importo Sconto Finanziario In Valuta]

      ,[Importo IVA In Valuta]

      ,[Importo Netto In Valuta]

      ,[M_Quantità]

      ,[Importo Lordo Euro]

      ,[Importo Sconto Euro]

      ,[Importo IVA Euro]

      ,[Importo Netto Euro]

      ,[Importo Sconto Commerciale Euro]

      ,[Importo Sconto Finanziario Euro]

      ,[Nome Cliente Spedizione]

      ,[Tipo Operazione CDV]

      ,[TipoFattura]

      ,[Tipo Operazione]

      ,[Currency Code]

      ,[Currency Factor]

	  );</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{88AFB719-3EAE-4235-AC46-96159244F910}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;MERGE [BI_Model_DWH].[dbo].[FactFatturaAcquisto_Costi_Accessori_consuntivi] AS TARGET USING (&#xA;&#xA;&#xA;&#xA;SELECT [valutakey]&#xA;&#xA;      ,[fornitorekey]&#xA;&#xA;      ,[Tipo Costo]&#xA;&#xA;      ,[marchio]&#xA;&#xA;      ,[MagazzinoKey]&#xA;&#xA;      ,[Stagione]&#xA;&#xA;      ,[CompanyKey]&#xA;&#xA;      ,[Costo Unitario Diretto IVA Esclusa Euro]&#xA;&#xA;      ,[Costo Unitario Diretto IVA Esclusa in Valuta]&#xA;&#xA;      ,[Qty]&#xA;&#xA;  FROM [BI_Model_Stage].[stg].[vFactFatturaAcquisto_Costi_Accessori_consuntivi] fct&#xA;&#xA;  inner join ( SELECT MAX([MaxTimestamp]) as maxtimestamp from [BI_Model_Stage].cfg.Config_Delta) cfg&#xA;&#xA;  on fct.timestamp &gt; cfg.maxtimestamp&#xA;&#xA;     ) AS SOURCE &#xA;&#xA;  ON SOURCE.[valutakey]= TARGET.[valutakey]&#xA;&#xA;  AND SOURCE.[fornitorekey]= TARGET.[fornitorekey]&#xA;   AND SOURCE.[Tipo Costo]= TARGET.[Tipo Costo]&#xA;    AND SOURCE.[marchio]= TARGET.[marchio]&#xA;&#x9; AND SOURCE.[Stagione]= TARGET.[Stagione]&#xA;&#x9;  AND SOURCE.[CompanyKey]= TARGET.[CompanyKey]&#xA;&#x9;   &#xA;&#xA;  &#xA;&#xA;  &#xA;&#xA;  WHEN MATCHED&#xA;&#xA;  THEN UPDATE SET &#xA;&#xA;&#x9;        &#xA;&#xA;&#x9;                                   &#xA;&#xA;       TARGET.[Costo Unitario Diretto IVA Esclusa Euro]         = SOURCE.[Costo Unitario Diretto IVA Esclusa Euro]      &#xA;&#xA;      ,TARGET.[Costo Unitario Diretto IVA Esclusa in Valuta]    = SOURCE.[Costo Unitario Diretto IVA Esclusa in Valuta] &#xA;&#xA;      ,TARGET.[Qty]                                             = SOURCE.[Qty]                                          &#xA;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;&#xA;&#x9;  WHEN NOT MATCHED&#xA;&#xA;&#x9;  THEN INSERT (&#xA;&#xA;&#x9; &#xA;&#xA;&#x9;  [valutakey]&#xA;&#xA;      ,[fornitorekey]&#xA;&#xA;      ,[Tipo Costo]&#xA;&#xA;      ,[marchio]&#xA;&#xA;      ,[MagazzinoKey]&#xA;&#xA;      ,[Stagione]&#xA;&#xA;      ,[CompanyKey]&#xA;&#xA;      ,[Costo Unitario Diretto IVA Esclusa Euro]&#xA;&#xA;      ,[Costo Unitario Diretto IVA Esclusa in Valuta]&#xA;&#xA;      ,[Qty]&#xA;&#xA;&#x9;  )&#xA;&#xA;&#x9;  VALUES (&#xA;&#xA;&#x9;&#xA;&#xA;&#x9;   [valutakey]&#xA;&#xA;      ,[fornitorekey]&#xA;&#xA;      ,[Tipo Costo]&#xA;&#xA;      ,[marchio]&#xA;&#xA;      ,[MagazzinoKey]&#xA;&#xA;      ,[Stagione]&#xA;&#xA;      ,[CompanyKey]&#xA;&#xA;      ,[Costo Unitario Diretto IVA Esclusa Euro]&#xA;&#xA;      ,[Costo Unitario Diretto IVA Esclusa in Valuta]&#xA;&#xA;      ,[Qty]&#xA;&#xA;&#x9;  );&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="Populate_FactFatturaAcquisto_Costi_Accessori_consuntivi">
      <DTS:VariableValue
        DTS:DataType="8">MERGE [BI_Model_DWH].[dbo].[FactFatturaAcquisto_Costi_Accessori_consuntivi] AS TARGET USING (



SELECT [valutakey]

      ,[fornitorekey]

      ,[Tipo Costo]

      ,[marchio]

      ,[MagazzinoKey]

      ,[Stagione]

      ,[CompanyKey]

      ,[Costo Unitario Diretto IVA Esclusa Euro]

      ,[Costo Unitario Diretto IVA Esclusa in Valuta]

      ,[Qty]

  FROM [BI_Model_Stage].[stg].[vFactFatturaAcquisto_Costi_Accessori_consuntivi] fct

  inner join ( SELECT MAX([MaxTimestamp]) as maxtimestamp from [BI_Model_Stage].cfg.Config_Delta) cfg

  on fct.timestamp &gt; cfg.maxtimestamp

     ) AS SOURCE 

  ON SOURCE.[valutakey]= TARGET.[valutakey]

  AND SOURCE.[fornitorekey]= TARGET.[fornitorekey]
   AND SOURCE.[Tipo Costo]= TARGET.[Tipo Costo]
    AND SOURCE.[marchio]= TARGET.[marchio]
	 AND SOURCE.[Stagione]= TARGET.[Stagione]
	  AND SOURCE.[CompanyKey]= TARGET.[CompanyKey]
	   

  

  

  WHEN MATCHED

  THEN UPDATE SET 

	        

	                                   

       TARGET.[Costo Unitario Diretto IVA Esclusa Euro]         = SOURCE.[Costo Unitario Diretto IVA Esclusa Euro]      

      ,TARGET.[Costo Unitario Diretto IVA Esclusa in Valuta]    = SOURCE.[Costo Unitario Diretto IVA Esclusa in Valuta] 

      ,TARGET.[Qty]                                             = SOURCE.[Qty]                                          

																

	  WHEN NOT MATCHED

	  THEN INSERT (

	 

	  [valutakey]

      ,[fornitorekey]

      ,[Tipo Costo]

      ,[marchio]

      ,[MagazzinoKey]

      ,[Stagione]

      ,[CompanyKey]

      ,[Costo Unitario Diretto IVA Esclusa Euro]

      ,[Costo Unitario Diretto IVA Esclusa in Valuta]

      ,[Qty]

	  )

	  VALUES (

	

	   [valutakey]

      ,[fornitorekey]

      ,[Tipo Costo]

      ,[marchio]

      ,[MagazzinoKey]

      ,[Stagione]

      ,[CompanyKey]

      ,[Costo Unitario Diretto IVA Esclusa Euro]

      ,[Costo Unitario Diretto IVA Esclusa in Valuta]

      ,[Qty]

	  );</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{9DFBE488-26E4-44FD-AC65-79D447E356C8}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;MERGE [BI_Model_DWH].[dbo].[FactFatturaVendita] AS TARGET USING (&#xA;&#xA;SELECT [FatturaVenditaKey]&#xA;      ,[Rif Ordine Cliente]&#xA;      ,[ValutaKey]&#xA;      ,[UnitàDiMisuraKey]&#xA;      ,[AgenteKey]&#xA;      ,[ClienteKey]&#xA;      ,[ArticoloKey]&#xA;      ,[CanaleKey]&#xA;      ,[SubcanaleKey]&#xA;      ,[StagioneKey]&#xA;      ,[StagioneListinoKey]&#xA;      ,[Zonakey]&#xA;      ,[TipoOrdineKey]&#xA;      ,[Marchio]&#xA;      ,[NaturaTransazioneReso]&#xA;      ,[NaturaTransazione]&#xA;      ,[MagazzinoKey]&#xA;      ,[OrdineVenditaKey]&#xA;      ,[CompanyKey]&#xA;      ,[DataKey]&#xA;      ,[TestataFatturaVendita]&#xA;      ,[RigaFatturaVendita]&#xA;      ,[DescrizioneFatturaVendita]&#xA;      ,[DataSpedizioneFatturaVendita]&#xA;      ,[DataOrdineFatturaVendita]&#xA;      ,[DataScadenzaFatturaVendita]&#xA;      ,[DataDocumentoFatturaVendita]&#xA;      ,[DataRegistrazioneFattura]&#xA;      ,[VATRegistrationNumber]&#xA;      ,[TipoDocumento]&#xA;      ,[Importo Lordo In Valuta]&#xA;      ,[Importo Sconto In Valuta]&#xA;      ,[Importo Sconto Commerciale In Valuta]&#xA;      ,[Importo Sconto Finanziario In Valuta]&#xA;      ,[Importo IVA In Valuta]&#xA;      ,[Importo Netto In Valuta]&#xA;      ,[M_Quantità]&#xA;      ,[Importo Lordo Euro]&#xA;      ,[Importo Sconto Euro]&#xA;      ,[Importo IVA Euro]&#xA;      ,[Importo Netto Euro]&#xA;      ,[Importo Sconto Commerciale Euro]&#xA;      ,[Importo Sconto Finanziario Euro]&#xA;      ,[Tasso di Cambio]&#xA;      ,[Nome Cliente Spedizione]&#xA;      ,[Tipo Operazione CDV]&#xA;      ,[Codice Stato Vendita]&#xA;      ,[Provvigioni Agente]&#xA;      ,[Provvigioni Agente Euro]&#xA;  FROM [BI_Model_Stage].[stg].[vFactFatturaVendita] fct&#xA;  inner join ( SELECT MAX([MaxTimestamp]) as maxtimestamp from [BI_Model_Stage].cfg.Config_Delta) cfg&#xA;  on fct.timestamp &gt; cfg.maxtimestamp&#xA;     ) AS SOURCE &#xA;  ON SOURCE.[FatturaVenditaKey]= TARGET.[FatturaVenditaKey]&#xA;  &#xA;  &#xA;  WHEN MATCHED&#xA;  THEN UPDATE SET &#xA;&#x9;         &#xA;      TARGET.[Rif Ordine Cliente]                            = SOURCE.[Rif Ordine Cliente]                     &#xA;      ,TARGET.[ValutaKey]                                     = SOURCE.[ValutaKey]                              &#xA;      ,TARGET.[UnitàDiMisuraKey]                              = SOURCE.[UnitàDiMisuraKey]                       &#xA;      ,TARGET.[AgenteKey]                                     = SOURCE.[AgenteKey]                              &#xA;      ,TARGET.[ClienteKey]                                    = SOURCE.[ClienteKey]                             &#xA;      ,TARGET.[ArticoloKey]                                   = SOURCE.[ArticoloKey]                            &#xA;      ,TARGET.[CanaleKey]                                     = SOURCE.[CanaleKey]                              &#xA;      ,TARGET.[SubcanaleKey]                                  = SOURCE.[SubcanaleKey]                           &#xA;                             &#xA;      ,TARGET.[StagioneListinoKey]                            = SOURCE.[StagioneListinoKey]                     &#xA;      ,TARGET.[Zonakey]                                       = SOURCE.[Zonakey]                                &#xA;      ,TARGET.[TipoOrdineKey]                                 = SOURCE.[TipoOrdineKey]                          &#xA;                                 &#xA;      ,TARGET.[NaturaTransazioneReso]                         = SOURCE.[NaturaTransazioneReso]                  &#xA;      ,TARGET.[NaturaTransazione]                             = SOURCE.[NaturaTransazione]                      &#xA;      ,TARGET.[MagazzinoKey]                                  = SOURCE.[MagazzinoKey]                           &#xA;      ,TARGET.[OrdineVenditaKey]                              = SOURCE.[OrdineVenditaKey]                       &#xA;                         &#xA;      ,TARGET.[DataKey]                                       = SOURCE.[DataKey]                                &#xA;      ,TARGET.[TestataFatturaVendita]                         = SOURCE.[TestataFatturaVendita]                  &#xA;      ,TARGET.[RigaFatturaVendita]                            = SOURCE.[RigaFatturaVendita]                     &#xA;      ,TARGET.[DescrizioneFatturaVendita]                     = SOURCE.[DescrizioneFatturaVendita]              &#xA;      ,TARGET.[DataSpedizioneFatturaVendita]                  = SOURCE.[DataSpedizioneFatturaVendita]           &#xA;      ,TARGET.[DataOrdineFatturaVendita]                      = SOURCE.[DataOrdineFatturaVendita]               &#xA;      ,TARGET.[DataScadenzaFatturaVendita]                    = SOURCE.[DataScadenzaFatturaVendita]             &#xA;      ,TARGET.[DataDocumentoFatturaVendita]                   = SOURCE.[DataDocumentoFatturaVendita]            &#xA;      ,TARGET.[DataRegistrazioneFattura]                      = SOURCE.[DataRegistrazioneFattura]               &#xA;      ,TARGET.[VATRegistrationNumber]                         = SOURCE.[VATRegistrationNumber]                  &#xA;      ,TARGET.[TipoDocumento]                                 = SOURCE.[TipoDocumento]                          &#xA;      ,TARGET.[Importo Lordo In Valuta]                       = SOURCE.[Importo Lordo In Valuta]                &#xA;      ,TARGET.[Importo Sconto In Valuta]                      = SOURCE.[Importo Sconto In Valuta]               &#xA;      ,TARGET.[Importo Sconto Commerciale In Valuta]          = SOURCE.[Importo Sconto Commerciale In Valuta]   &#xA;      ,TARGET.[Importo Sconto Finanziario In Valuta]          = SOURCE.[Importo Sconto Finanziario In Valuta]   &#xA;      ,TARGET.[Importo IVA In Valuta]                         = SOURCE.[Importo IVA In Valuta]                  &#xA;      ,TARGET.[Importo Netto In Valuta]                       = SOURCE.[Importo Netto In Valuta]                &#xA;      ,TARGET.[M_Quantità]                                    = SOURCE.[M_Quantità]                             &#xA;      ,TARGET.[Importo Lordo Euro]                            = SOURCE.[Importo Lordo Euro]                     &#xA;      ,TARGET.[Importo Sconto Euro]                           = SOURCE.[Importo Sconto Euro]                    &#xA;      ,TARGET.[Importo IVA Euro]                              = SOURCE.[Importo IVA Euro]                       &#xA;      ,TARGET.[Importo Netto Euro]                            = SOURCE.[Importo Netto Euro]                     &#xA;      ,TARGET.[Importo Sconto Commerciale Euro]               = SOURCE.[Importo Sconto Commerciale Euro]        &#xA;      ,TARGET.[Importo Sconto Finanziario Euro]               = SOURCE.[Importo Sconto Finanziario Euro]        &#xA;      ,TARGET.[Tasso di Cambio]                               = SOURCE.[Tasso di Cambio]                        &#xA;      ,TARGET.[Nome Cliente Spedizione]                       = SOURCE.[Nome Cliente Spedizione]                &#xA;      ,TARGET.[Tipo Operazione CDV]                           = SOURCE.[Tipo Operazione CDV]                    &#xA;      ,TARGET.[Codice Stato Vendita]                          = SOURCE.[Codice Stato Vendita]                   &#xA;      ,TARGET.[Provvigioni Agente]                            = SOURCE.[Provvigioni Agente]                     &#xA;      ,TARGET.[Provvigioni Agente Euro]                       = SOURCE.[Provvigioni Agente Euro]                &#xA;&#x9;  &#xA;&#x9;  WHEN NOT MATCHED&#xA;&#x9;  THEN INSERT (&#xA;&#xA;&#x9;  [FatturaVenditaKey]&#xA;      ,[Rif Ordine Cliente]&#xA;      ,[ValutaKey]&#xA;      ,[UnitàDiMisuraKey]&#xA;      ,[AgenteKey]&#xA;      ,[ClienteKey]&#xA;      ,[ArticoloKey]&#xA;      ,[CanaleKey]&#xA;      ,[SubcanaleKey]&#xA;      ,[StagioneKey]&#xA;      ,[StagioneListinoKey]&#xA;      ,[Zonakey]&#xA;      ,[TipoOrdineKey]&#xA;      ,[Marchio]&#xA;      ,[NaturaTransazioneReso]&#xA;      ,[NaturaTransazione]&#xA;      ,[MagazzinoKey]&#xA;      ,[OrdineVenditaKey]&#xA;      ,[CompanyKey]&#xA;      ,[DataKey]&#xA;      ,[TestataFatturaVendita]&#xA;      ,[RigaFatturaVendita]&#xA;      ,[DescrizioneFatturaVendita]&#xA;      ,[DataSpedizioneFatturaVendita]&#xA;      ,[DataOrdineFatturaVendita]&#xA;      ,[DataScadenzaFatturaVendita]&#xA;      ,[DataDocumentoFatturaVendita]&#xA;      ,[DataRegistrazioneFattura]&#xA;      ,[VATRegistrationNumber]&#xA;      ,[TipoDocumento]&#xA;      ,[Importo Lordo In Valuta]&#xA;      ,[Importo Sconto In Valuta]&#xA;      ,[Importo Sconto Commerciale In Valuta]&#xA;      ,[Importo Sconto Finanziario In Valuta]&#xA;      ,[Importo IVA In Valuta]&#xA;      ,[Importo Netto In Valuta]&#xA;      ,[M_Quantità]&#xA;      ,[Importo Lordo Euro]&#xA;      ,[Importo Sconto Euro]&#xA;      ,[Importo IVA Euro]&#xA;      ,[Importo Netto Euro]&#xA;      ,[Importo Sconto Commerciale Euro]&#xA;      ,[Importo Sconto Finanziario Euro]&#xA;      ,[Tasso di Cambio]&#xA;      ,[Nome Cliente Spedizione]&#xA;      ,[Tipo Operazione CDV]&#xA;      ,[Codice Stato Vendita]&#xA;      ,[Provvigioni Agente]&#xA;      ,[Provvigioni Agente Euro]&#xA;&#x9;  )&#xA;&#x9;  VALUES (&#xA;&#xA;&#x9;   [FatturaVenditaKey]&#xA;      ,[Rif Ordine Cliente]&#xA;      ,[ValutaKey]&#xA;      ,[UnitàDiMisuraKey]&#xA;      ,[AgenteKey]&#xA;      ,[ClienteKey]&#xA;      ,[ArticoloKey]&#xA;      ,[CanaleKey]&#xA;      ,[SubcanaleKey]&#xA;      ,[StagioneKey]&#xA;      ,[StagioneListinoKey]&#xA;      ,[Zonakey]&#xA;      ,[TipoOrdineKey]&#xA;      ,[Marchio]&#xA;      ,[NaturaTransazioneReso]&#xA;      ,[NaturaTransazione]&#xA;      ,[MagazzinoKey]&#xA;      ,[OrdineVenditaKey]&#xA;      ,[CompanyKey]&#xA;      ,[DataKey]&#xA;      ,[TestataFatturaVendita]&#xA;      ,[RigaFatturaVendita]&#xA;      ,[DescrizioneFatturaVendita]&#xA;      ,[DataSpedizioneFatturaVendita]&#xA;      ,[DataOrdineFatturaVendita]&#xA;      ,[DataScadenzaFatturaVendita]&#xA;      ,[DataDocumentoFatturaVendita]&#xA;      ,[DataRegistrazioneFattura]&#xA;      ,[VATRegistrationNumber]&#xA;      ,[TipoDocumento]&#xA;      ,[Importo Lordo In Valuta]&#xA;      ,[Importo Sconto In Valuta]&#xA;      ,[Importo Sconto Commerciale In Valuta]&#xA;      ,[Importo Sconto Finanziario In Valuta]&#xA;      ,[Importo IVA In Valuta]&#xA;      ,[Importo Netto In Valuta]&#xA;      ,[M_Quantità]&#xA;      ,[Importo Lordo Euro]&#xA;      ,[Importo Sconto Euro]&#xA;      ,[Importo IVA Euro]&#xA;      ,[Importo Netto Euro]&#xA;      ,[Importo Sconto Commerciale Euro]&#xA;      ,[Importo Sconto Finanziario Euro]&#xA;      ,[Tasso di Cambio]&#xA;      ,[Nome Cliente Spedizione]&#xA;      ,[Tipo Operazione CDV]&#xA;      ,[Codice Stato Vendita]&#xA;      ,[Provvigioni Agente]&#xA;      ,[Provvigioni Agente Euro]&#xA;&#x9;  );&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="Populate_FactFatturaVendita">
      <DTS:VariableValue
        DTS:DataType="8">MERGE [BI_Model_DWH].[dbo].[FactFatturaVendita] AS TARGET USING (

SELECT [FatturaVenditaKey]
      ,[Rif Ordine Cliente]
      ,[ValutaKey]
      ,[UnitàDiMisuraKey]
      ,[AgenteKey]
      ,[ClienteKey]
      ,[ArticoloKey]
      ,[CanaleKey]
      ,[SubcanaleKey]
      ,[StagioneKey]
      ,[StagioneListinoKey]
      ,[Zonakey]
      ,[TipoOrdineKey]
      ,[Marchio]
      ,[NaturaTransazioneReso]
      ,[NaturaTransazione]
      ,[MagazzinoKey]
      ,[OrdineVenditaKey]
      ,[CompanyKey]
      ,[DataKey]
      ,[TestataFatturaVendita]
      ,[RigaFatturaVendita]
      ,[DescrizioneFatturaVendita]
      ,[DataSpedizioneFatturaVendita]
      ,[DataOrdineFatturaVendita]
      ,[DataScadenzaFatturaVendita]
      ,[DataDocumentoFatturaVendita]
      ,[DataRegistrazioneFattura]
      ,[VATRegistrationNumber]
      ,[TipoDocumento]
      ,[Importo Lordo In Valuta]
      ,[Importo Sconto In Valuta]
      ,[Importo Sconto Commerciale In Valuta]
      ,[Importo Sconto Finanziario In Valuta]
      ,[Importo IVA In Valuta]
      ,[Importo Netto In Valuta]
      ,[M_Quantità]
      ,[Importo Lordo Euro]
      ,[Importo Sconto Euro]
      ,[Importo IVA Euro]
      ,[Importo Netto Euro]
      ,[Importo Sconto Commerciale Euro]
      ,[Importo Sconto Finanziario Euro]
      ,[Tasso di Cambio]
      ,[Nome Cliente Spedizione]
      ,[Tipo Operazione CDV]
      ,[Codice Stato Vendita]
      ,[Provvigioni Agente]
      ,[Provvigioni Agente Euro]
  FROM [BI_Model_Stage].[stg].[vFactFatturaVendita] fct
  inner join ( SELECT MAX([MaxTimestamp]) as maxtimestamp from [BI_Model_Stage].cfg.Config_Delta) cfg
  on fct.timestamp &gt; cfg.maxtimestamp
     ) AS SOURCE 
  ON SOURCE.[FatturaVenditaKey]= TARGET.[FatturaVenditaKey]
  
  
  WHEN MATCHED
  THEN UPDATE SET 
	         
      TARGET.[Rif Ordine Cliente]                            = SOURCE.[Rif Ordine Cliente]                     
      ,TARGET.[ValutaKey]                                     = SOURCE.[ValutaKey]                              
      ,TARGET.[UnitàDiMisuraKey]                              = SOURCE.[UnitàDiMisuraKey]                       
      ,TARGET.[AgenteKey]                                     = SOURCE.[AgenteKey]                              
      ,TARGET.[ClienteKey]                                    = SOURCE.[ClienteKey]                             
      ,TARGET.[ArticoloKey]                                   = SOURCE.[ArticoloKey]                            
      ,TARGET.[CanaleKey]                                     = SOURCE.[CanaleKey]                              
      ,TARGET.[SubcanaleKey]                                  = SOURCE.[SubcanaleKey]                           
                             
      ,TARGET.[StagioneListinoKey]                            = SOURCE.[StagioneListinoKey]                     
      ,TARGET.[Zonakey]                                       = SOURCE.[Zonakey]                                
      ,TARGET.[TipoOrdineKey]                                 = SOURCE.[TipoOrdineKey]                          
                                 
      ,TARGET.[NaturaTransazioneReso]                         = SOURCE.[NaturaTransazioneReso]                  
      ,TARGET.[NaturaTransazione]                             = SOURCE.[NaturaTransazione]                      
      ,TARGET.[MagazzinoKey]                                  = SOURCE.[MagazzinoKey]                           
      ,TARGET.[OrdineVenditaKey]                              = SOURCE.[OrdineVenditaKey]                       
                         
      ,TARGET.[DataKey]                                       = SOURCE.[DataKey]                                
      ,TARGET.[TestataFatturaVendita]                         = SOURCE.[TestataFatturaVendita]                  
      ,TARGET.[RigaFatturaVendita]                            = SOURCE.[RigaFatturaVendita]                     
      ,TARGET.[DescrizioneFatturaVendita]                     = SOURCE.[DescrizioneFatturaVendita]              
      ,TARGET.[DataSpedizioneFatturaVendita]                  = SOURCE.[DataSpedizioneFatturaVendita]           
      ,TARGET.[DataOrdineFatturaVendita]                      = SOURCE.[DataOrdineFatturaVendita]               
      ,TARGET.[DataScadenzaFatturaVendita]                    = SOURCE.[DataScadenzaFatturaVendita]             
      ,TARGET.[DataDocumentoFatturaVendita]                   = SOURCE.[DataDocumentoFatturaVendita]            
      ,TARGET.[DataRegistrazioneFattura]                      = SOURCE.[DataRegistrazioneFattura]               
      ,TARGET.[VATRegistrationNumber]                         = SOURCE.[VATRegistrationNumber]                  
      ,TARGET.[TipoDocumento]                                 = SOURCE.[TipoDocumento]                          
      ,TARGET.[Importo Lordo In Valuta]                       = SOURCE.[Importo Lordo In Valuta]                
      ,TARGET.[Importo Sconto In Valuta]                      = SOURCE.[Importo Sconto In Valuta]               
      ,TARGET.[Importo Sconto Commerciale In Valuta]          = SOURCE.[Importo Sconto Commerciale In Valuta]   
      ,TARGET.[Importo Sconto Finanziario In Valuta]          = SOURCE.[Importo Sconto Finanziario In Valuta]   
      ,TARGET.[Importo IVA In Valuta]                         = SOURCE.[Importo IVA In Valuta]                  
      ,TARGET.[Importo Netto In Valuta]                       = SOURCE.[Importo Netto In Valuta]                
      ,TARGET.[M_Quantità]                                    = SOURCE.[M_Quantità]                             
      ,TARGET.[Importo Lordo Euro]                            = SOURCE.[Importo Lordo Euro]                     
      ,TARGET.[Importo Sconto Euro]                           = SOURCE.[Importo Sconto Euro]                    
      ,TARGET.[Importo IVA Euro]                              = SOURCE.[Importo IVA Euro]                       
      ,TARGET.[Importo Netto Euro]                            = SOURCE.[Importo Netto Euro]                     
      ,TARGET.[Importo Sconto Commerciale Euro]               = SOURCE.[Importo Sconto Commerciale Euro]        
      ,TARGET.[Importo Sconto Finanziario Euro]               = SOURCE.[Importo Sconto Finanziario Euro]        
      ,TARGET.[Tasso di Cambio]                               = SOURCE.[Tasso di Cambio]                        
      ,TARGET.[Nome Cliente Spedizione]                       = SOURCE.[Nome Cliente Spedizione]                
      ,TARGET.[Tipo Operazione CDV]                           = SOURCE.[Tipo Operazione CDV]                    
      ,TARGET.[Codice Stato Vendita]                          = SOURCE.[Codice Stato Vendita]                   
      ,TARGET.[Provvigioni Agente]                            = SOURCE.[Provvigioni Agente]                     
      ,TARGET.[Provvigioni Agente Euro]                       = SOURCE.[Provvigioni Agente Euro]                
	  
	  WHEN NOT MATCHED
	  THEN INSERT (

	  [FatturaVenditaKey]
      ,[Rif Ordine Cliente]
      ,[ValutaKey]
      ,[UnitàDiMisuraKey]
      ,[AgenteKey]
      ,[ClienteKey]
      ,[ArticoloKey]
      ,[CanaleKey]
      ,[SubcanaleKey]
      ,[StagioneKey]
      ,[StagioneListinoKey]
      ,[Zonakey]
      ,[TipoOrdineKey]
      ,[Marchio]
      ,[NaturaTransazioneReso]
      ,[NaturaTransazione]
      ,[MagazzinoKey]
      ,[OrdineVenditaKey]
      ,[CompanyKey]
      ,[DataKey]
      ,[TestataFatturaVendita]
      ,[RigaFatturaVendita]
      ,[DescrizioneFatturaVendita]
      ,[DataSpedizioneFatturaVendita]
      ,[DataOrdineFatturaVendita]
      ,[DataScadenzaFatturaVendita]
      ,[DataDocumentoFatturaVendita]
      ,[DataRegistrazioneFattura]
      ,[VATRegistrationNumber]
      ,[TipoDocumento]
      ,[Importo Lordo In Valuta]
      ,[Importo Sconto In Valuta]
      ,[Importo Sconto Commerciale In Valuta]
      ,[Importo Sconto Finanziario In Valuta]
      ,[Importo IVA In Valuta]
      ,[Importo Netto In Valuta]
      ,[M_Quantità]
      ,[Importo Lordo Euro]
      ,[Importo Sconto Euro]
      ,[Importo IVA Euro]
      ,[Importo Netto Euro]
      ,[Importo Sconto Commerciale Euro]
      ,[Importo Sconto Finanziario Euro]
      ,[Tasso di Cambio]
      ,[Nome Cliente Spedizione]
      ,[Tipo Operazione CDV]
      ,[Codice Stato Vendita]
      ,[Provvigioni Agente]
      ,[Provvigioni Agente Euro]
	  )
	  VALUES (

	   [FatturaVenditaKey]
      ,[Rif Ordine Cliente]
      ,[ValutaKey]
      ,[UnitàDiMisuraKey]
      ,[AgenteKey]
      ,[ClienteKey]
      ,[ArticoloKey]
      ,[CanaleKey]
      ,[SubcanaleKey]
      ,[StagioneKey]
      ,[StagioneListinoKey]
      ,[Zonakey]
      ,[TipoOrdineKey]
      ,[Marchio]
      ,[NaturaTransazioneReso]
      ,[NaturaTransazione]
      ,[MagazzinoKey]
      ,[OrdineVenditaKey]
      ,[CompanyKey]
      ,[DataKey]
      ,[TestataFatturaVendita]
      ,[RigaFatturaVendita]
      ,[DescrizioneFatturaVendita]
      ,[DataSpedizioneFatturaVendita]
      ,[DataOrdineFatturaVendita]
      ,[DataScadenzaFatturaVendita]
      ,[DataDocumentoFatturaVendita]
      ,[DataRegistrazioneFattura]
      ,[VATRegistrationNumber]
      ,[TipoDocumento]
      ,[Importo Lordo In Valuta]
      ,[Importo Sconto In Valuta]
      ,[Importo Sconto Commerciale In Valuta]
      ,[Importo Sconto Finanziario In Valuta]
      ,[Importo IVA In Valuta]
      ,[Importo Netto In Valuta]
      ,[M_Quantità]
      ,[Importo Lordo Euro]
      ,[Importo Sconto Euro]
      ,[Importo IVA Euro]
      ,[Importo Netto Euro]
      ,[Importo Sconto Commerciale Euro]
      ,[Importo Sconto Finanziario Euro]
      ,[Tasso di Cambio]
      ,[Nome Cliente Spedizione]
      ,[Tipo Operazione CDV]
      ,[Codice Stato Vendita]
      ,[Provvigioni Agente]
      ,[Provvigioni Agente Euro]
	  );</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{F9F7F58A-1D94-4FB5-B29D-EE30803C6C4F}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;MERGE [BI_Model_DWH].[dbo].[FactMovimentiMagazzino] AS TARGET USING (&#xA;&#xA;SELECT [CompanyKey]&#xA;      ,[UnitàDiMisuraKey]&#xA;      ,[ArticoloKey]&#xA;      ,[MagazzinoKey]&#xA;      ,[M_Quantità]&#xA;      ,[CodiceMotivoReso]&#xA;      ,[Source No_]&#xA;      ,[NumeroDocumento]&#xA;      ,[NumeroRigaDocumento]&#xA;      ,[SerialNumber]&#xA;      ,[NumeroLotto]&#xA;      ,[CompletamenteFatturato]&#xA;      ,[Nonstock]&#xA;      ,[CodiceNazione]&#xA;      ,[TipoDocumento]&#xA;      ,[TipoOrdine]&#xA;      ,[Order No_]&#xA;      ,[Order Line No_]&#xA;      ,[DataPubblicazione]&#xA;      ,[DataDocumento]&#xA;      ,[DataUltimaFattura]&#xA;      ,[DataGaranzia]&#xA;      ,[DataScadenza]&#xA;      ,[M_QuantitàRimanente]&#xA;      ,[M_QuantitàFatturata]&#xA;      ,[M_QuantitàSpeditaNonResa]&#xA;      ,[TipoMovimento]&#xA;      ,[TipoMovimentoDescrizione]&#xA;      ,[StagioneKey]&#xA;      ,[Marchio]&#xA;      ,[AssortimentoKey]&#xA;      ,[StagioneListinoKey]&#xA;      ,[codiceTipoOperazione]&#xA;      ,[DescrizioneTipoOperazione]&#xA;      ,[Entry No_]&#xA;  FROM [BI_Model_Stage].[stg].[vFactMovimentiMagazzino] fct&#xA;  inner join ( SELECT MAX([MaxTimestamp]) as maxtimestamp from [BI_Model_Stage].cfg.Config_Delta) cfg&#xA;  on fct.timestamp &gt; cfg.maxtimestamp&#xA;     ) AS SOURCE &#xA;  ON SOURCE.[Entry No_]= TARGET.[Entry No_]&#xA;   &#xA;  &#xA;  WHEN MATCHED&#xA;  THEN UPDATE SET &#xA;&#x9;&#xA;      TARGET.[MagazzinoKey]                      = SOURCE.[MagazzinoKey]&#xA;      ,TARGET.[UnitàDiMisuraKey]                  = SOURCE.[UnitàDiMisuraKey]&#xA;      ,TARGET.[StagioneKey]                       = SOURCE.[StagioneKey]&#xA;      ,TARGET.[AssortimentoKey]                   = SOURCE.[AssortimentoKey]&#xA;      ,TARGET.[StagioneListinoKey]                = SOURCE.[StagioneListinoKey]&#xA;      ,TARGET.[codiceTipoOperazione]              = SOURCE.[codiceTipoOperazione]&#xA;      ,TARGET.[DescrizioneTipoOperazione]         = SOURCE.[DescrizioneTipoOperazione]&#xA;      ,TARGET.[Marchio]                           = SOURCE.[Marchio]&#xA;      ,TARGET.[CodiceMotivoReso]                  = SOURCE.[CodiceMotivoReso]&#xA;      ,TARGET.[TipoMovimento]                     = SOURCE.[TipoMovimento]&#xA;      ,TARGET.[TipoMovimentoDescrizione]          = SOURCE.[TipoMovimentoDescrizione]&#xA;      ,TARGET.[Source No_]                        = SOURCE.[Source No_]&#xA;      ,TARGET.[SerialNumber]                      = SOURCE.[SerialNumber]&#xA;      ,TARGET.[NumeroLotto]                       = SOURCE.[NumeroLotto]&#xA;      ,TARGET.[CompletamenteFatturato]            = SOURCE.[CompletamenteFatturato]&#xA;      ,TARGET.[Nonstock]                          = SOURCE.[Nonstock]&#xA;      ,TARGET.[CodiceNazione]                     = SOURCE.[CodiceNazione]&#xA;      ,TARGET.[TipoDocumento]                     = SOURCE.[TipoDocumento]&#xA;      ,TARGET.[TipoOrdine]                        = SOURCE.[TipoOrdine]&#xA;      ,TARGET.[Order No_]                         = SOURCE.[Order No_]&#xA;      ,TARGET.[Order Line No_]                    = SOURCE.[Order Line No_]&#xA;      ,TARGET.[DataPubblicazione]                 = SOURCE.[DataPubblicazione]&#xA;      ,TARGET.[DataDocumento]                     = SOURCE.[DataDocumento]&#xA;      ,TARGET.[DataUltimaFattura]                 = SOURCE.[DataUltimaFattura]&#xA;      ,TARGET.[DataGaranzia]                      = SOURCE.[DataGaranzia]&#xA;      ,TARGET.[DataScadenza]                      = SOURCE.[DataScadenza]&#xA;      ,TARGET.[M_Quantità]                        = SOURCE.[M_Quantità]&#xA;      ,TARGET.[M_QuantitàRimanente]               = SOURCE.[M_QuantitàRimanente]&#xA;      ,TARGET.[M_QuantitàFatturata]               = SOURCE.[M_QuantitàFatturata]&#xA;      ,TARGET.[M_QuantitàSpeditaNonResa]          = SOURCE.[M_QuantitàSpeditaNonResa]  &#xA;   &#x9;&#xA;&#x9;   &#xA;&#x9;  WHEN NOT MATCHED&#xA;&#x9;  THEN INSERT (&#xA;&#x9;&#xA;&#x9;  [CompanyKey]&#xA;      ,[UnitàDiMisuraKey]&#xA;      ,[ArticoloKey]&#xA;      ,[MagazzinoKey]&#xA;      ,[M_Quantità]&#xA;      ,[CodiceMotivoReso]&#xA;      ,[Source No_]&#xA;      ,[NumeroDocumento]&#xA;      ,[NumeroRigaDocumento]&#xA;      ,[SerialNumber]&#xA;      ,[NumeroLotto]&#xA;      ,[CompletamenteFatturato]&#xA;      ,[Nonstock]&#xA;      ,[CodiceNazione]&#xA;      ,[TipoDocumento]&#xA;      ,[TipoOrdine]&#xA;      ,[Order No_]&#xA;      ,[Order Line No_]&#xA;      ,[DataPubblicazione]&#xA;      ,[DataDocumento]&#xA;      ,[DataUltimaFattura]&#xA;      ,[DataGaranzia]&#xA;      ,[DataScadenza]&#xA;      ,[M_QuantitàRimanente]&#xA;      ,[M_QuantitàFatturata]&#xA;      ,[M_QuantitàSpeditaNonResa]&#xA;      ,[TipoMovimento]&#xA;      ,[TipoMovimentoDescrizione]&#xA;      ,[StagioneKey]&#xA;      ,[Marchio]&#xA;      ,[AssortimentoKey]&#xA;      ,[StagioneListinoKey]&#xA;      ,[codiceTipoOperazione]&#xA;      ,[DescrizioneTipoOperazione]&#xA;      ,[Entry No_]&#xA;&#x9;  )&#xA;&#x9;  VALUES (&#xA;&#x9;&#xA;&#x9;   [CompanyKey]&#xA;      ,[UnitàDiMisuraKey]&#xA;      ,[ArticoloKey]&#xA;      ,[MagazzinoKey]&#xA;      ,[M_Quantità]&#xA;      ,[CodiceMotivoReso]&#xA;      ,[Source No_]&#xA;      ,[NumeroDocumento]&#xA;      ,[NumeroRigaDocumento]&#xA;      ,[SerialNumber]&#xA;      ,[NumeroLotto]&#xA;      ,[CompletamenteFatturato]&#xA;      ,[Nonstock]&#xA;      ,[CodiceNazione]&#xA;      ,[TipoDocumento]&#xA;      ,[TipoOrdine]&#xA;      ,[Order No_]&#xA;      ,[Order Line No_]&#xA;      ,[DataPubblicazione]&#xA;      ,[DataDocumento]&#xA;      ,[DataUltimaFattura]&#xA;      ,[DataGaranzia]&#xA;      ,[DataScadenza]&#xA;      ,[M_QuantitàRimanente]&#xA;      ,[M_QuantitàFatturata]&#xA;      ,[M_QuantitàSpeditaNonResa]&#xA;      ,[TipoMovimento]&#xA;      ,[TipoMovimentoDescrizione]&#xA;      ,[StagioneKey]&#xA;      ,[Marchio]&#xA;      ,[AssortimentoKey]&#xA;      ,[StagioneListinoKey]&#xA;      ,[codiceTipoOperazione]&#xA;      ,[DescrizioneTipoOperazione]&#xA;      ,[Entry No_]&#xA;&#x9;  );&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="Populate_FactMovimentiMagazzino">
      <DTS:VariableValue
        DTS:DataType="8">MERGE [BI_Model_DWH].[dbo].[FactMovimentiMagazzino] AS TARGET USING (

SELECT [CompanyKey]
      ,[UnitàDiMisuraKey]
      ,[ArticoloKey]
      ,[MagazzinoKey]
      ,[M_Quantità]
      ,[CodiceMotivoReso]
      ,[Source No_]
      ,[NumeroDocumento]
      ,[NumeroRigaDocumento]
      ,[SerialNumber]
      ,[NumeroLotto]
      ,[CompletamenteFatturato]
      ,[Nonstock]
      ,[CodiceNazione]
      ,[TipoDocumento]
      ,[TipoOrdine]
      ,[Order No_]
      ,[Order Line No_]
      ,[DataPubblicazione]
      ,[DataDocumento]
      ,[DataUltimaFattura]
      ,[DataGaranzia]
      ,[DataScadenza]
      ,[M_QuantitàRimanente]
      ,[M_QuantitàFatturata]
      ,[M_QuantitàSpeditaNonResa]
      ,[TipoMovimento]
      ,[TipoMovimentoDescrizione]
      ,[StagioneKey]
      ,[Marchio]
      ,[AssortimentoKey]
      ,[StagioneListinoKey]
      ,[codiceTipoOperazione]
      ,[DescrizioneTipoOperazione]
      ,[Entry No_]
  FROM [BI_Model_Stage].[stg].[vFactMovimentiMagazzino] fct
  inner join ( SELECT MAX([MaxTimestamp]) as maxtimestamp from [BI_Model_Stage].cfg.Config_Delta) cfg
  on fct.timestamp &gt; cfg.maxtimestamp
     ) AS SOURCE 
  ON SOURCE.[Entry No_]= TARGET.[Entry No_]
   
  
  WHEN MATCHED
  THEN UPDATE SET 
	
      TARGET.[MagazzinoKey]                      = SOURCE.[MagazzinoKey]
      ,TARGET.[UnitàDiMisuraKey]                  = SOURCE.[UnitàDiMisuraKey]
      ,TARGET.[StagioneKey]                       = SOURCE.[StagioneKey]
      ,TARGET.[AssortimentoKey]                   = SOURCE.[AssortimentoKey]
      ,TARGET.[StagioneListinoKey]                = SOURCE.[StagioneListinoKey]
      ,TARGET.[codiceTipoOperazione]              = SOURCE.[codiceTipoOperazione]
      ,TARGET.[DescrizioneTipoOperazione]         = SOURCE.[DescrizioneTipoOperazione]
      ,TARGET.[Marchio]                           = SOURCE.[Marchio]
      ,TARGET.[CodiceMotivoReso]                  = SOURCE.[CodiceMotivoReso]
      ,TARGET.[TipoMovimento]                     = SOURCE.[TipoMovimento]
      ,TARGET.[TipoMovimentoDescrizione]          = SOURCE.[TipoMovimentoDescrizione]
      ,TARGET.[Source No_]                        = SOURCE.[Source No_]
      ,TARGET.[SerialNumber]                      = SOURCE.[SerialNumber]
      ,TARGET.[NumeroLotto]                       = SOURCE.[NumeroLotto]
      ,TARGET.[CompletamenteFatturato]            = SOURCE.[CompletamenteFatturato]
      ,TARGET.[Nonstock]                          = SOURCE.[Nonstock]
      ,TARGET.[CodiceNazione]                     = SOURCE.[CodiceNazione]
      ,TARGET.[TipoDocumento]                     = SOURCE.[TipoDocumento]
      ,TARGET.[TipoOrdine]                        = SOURCE.[TipoOrdine]
      ,TARGET.[Order No_]                         = SOURCE.[Order No_]
      ,TARGET.[Order Line No_]                    = SOURCE.[Order Line No_]
      ,TARGET.[DataPubblicazione]                 = SOURCE.[DataPubblicazione]
      ,TARGET.[DataDocumento]                     = SOURCE.[DataDocumento]
      ,TARGET.[DataUltimaFattura]                 = SOURCE.[DataUltimaFattura]
      ,TARGET.[DataGaranzia]                      = SOURCE.[DataGaranzia]
      ,TARGET.[DataScadenza]                      = SOURCE.[DataScadenza]
      ,TARGET.[M_Quantità]                        = SOURCE.[M_Quantità]
      ,TARGET.[M_QuantitàRimanente]               = SOURCE.[M_QuantitàRimanente]
      ,TARGET.[M_QuantitàFatturata]               = SOURCE.[M_QuantitàFatturata]
      ,TARGET.[M_QuantitàSpeditaNonResa]          = SOURCE.[M_QuantitàSpeditaNonResa]  
   	
	   
	  WHEN NOT MATCHED
	  THEN INSERT (
	
	  [CompanyKey]
      ,[UnitàDiMisuraKey]
      ,[ArticoloKey]
      ,[MagazzinoKey]
      ,[M_Quantità]
      ,[CodiceMotivoReso]
      ,[Source No_]
      ,[NumeroDocumento]
      ,[NumeroRigaDocumento]
      ,[SerialNumber]
      ,[NumeroLotto]
      ,[CompletamenteFatturato]
      ,[Nonstock]
      ,[CodiceNazione]
      ,[TipoDocumento]
      ,[TipoOrdine]
      ,[Order No_]
      ,[Order Line No_]
      ,[DataPubblicazione]
      ,[DataDocumento]
      ,[DataUltimaFattura]
      ,[DataGaranzia]
      ,[DataScadenza]
      ,[M_QuantitàRimanente]
      ,[M_QuantitàFatturata]
      ,[M_QuantitàSpeditaNonResa]
      ,[TipoMovimento]
      ,[TipoMovimentoDescrizione]
      ,[StagioneKey]
      ,[Marchio]
      ,[AssortimentoKey]
      ,[StagioneListinoKey]
      ,[codiceTipoOperazione]
      ,[DescrizioneTipoOperazione]
      ,[Entry No_]
	  )
	  VALUES (
	
	   [CompanyKey]
      ,[UnitàDiMisuraKey]
      ,[ArticoloKey]
      ,[MagazzinoKey]
      ,[M_Quantità]
      ,[CodiceMotivoReso]
      ,[Source No_]
      ,[NumeroDocumento]
      ,[NumeroRigaDocumento]
      ,[SerialNumber]
      ,[NumeroLotto]
      ,[CompletamenteFatturato]
      ,[Nonstock]
      ,[CodiceNazione]
      ,[TipoDocumento]
      ,[TipoOrdine]
      ,[Order No_]
      ,[Order Line No_]
      ,[DataPubblicazione]
      ,[DataDocumento]
      ,[DataUltimaFattura]
      ,[DataGaranzia]
      ,[DataScadenza]
      ,[M_QuantitàRimanente]
      ,[M_QuantitàFatturata]
      ,[M_QuantitàSpeditaNonResa]
      ,[TipoMovimento]
      ,[TipoMovimentoDescrizione]
      ,[StagioneKey]
      ,[Marchio]
      ,[AssortimentoKey]
      ,[StagioneListinoKey]
      ,[codiceTipoOperazione]
      ,[DescrizioneTipoOperazione]
      ,[Entry No_]
	  );</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{E7492E74-A652-41F4-ACEE-70307BAE109D}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;MERGE [BI_Model_DWH].[dbo].[FactMovimentiMagazzinoAssortimento] AS TARGET USING (&#xA;&#xA;SELECT [ArticoloKey]&#xA;      ,[MagazzinoKey]&#xA;      ,[CompanyKey]&#xA;      ,[StagioneKey]&#xA;      ,[Marchio]&#xA;      ,[AssortimentoKey]&#xA;      ,[TipoMovimento]&#xA;      ,[TipoMovimentoDescrizione]&#xA;      ,[Source No_]&#xA;      ,[NumeroDocumento]&#xA;      ,[DataPubblicazione]&#xA;      ,[DataDocumento]&#xA;      ,[M_Quantità]&#xA;  FROM [BI_Model_Stage].[stg].[vFactMovimentiMagazzinoAssortimenti] fct&#xA;  inner join ( SELECT MAX([MaxTimestamp]) as maxtimestamp from [BI_Model_Stage].cfg.Config_Delta) cfg&#xA;  on fct.timestamp &gt; cfg.maxtimestamp&#xA;     ) AS SOURCE &#xA;  ON SOURCE.[ArticoloKey]= TARGET.[ArticoloKey]&#xA;  AND SOURCE.[NumeroDocumento]= TARGET.[NumeroDocumento]&#xA;  &#xA;  &#xA;  WHEN MATCHED&#xA;  THEN UPDATE SET &#xA;&#x9;       &#xA;      TARGET.[MagazzinoKey]                = SOURCE.[MagazzinoKey]                         &#xA;      ,TARGET.[StagioneKey]                 = SOURCE.[StagioneKey]              &#xA;      ,TARGET.[Marchio]                     = SOURCE.[Marchio]                  &#xA;      ,TARGET.[AssortimentoKey]             = SOURCE.[AssortimentoKey]          &#xA;      ,TARGET.[TipoMovimento]               = SOURCE.[TipoMovimento]            &#xA;      ,TARGET.[TipoMovimentoDescrizione]    = SOURCE.[TipoMovimentoDescrizione] &#xA;      ,TARGET.[Source No_]                  = SOURCE.[Source No_]                        &#xA;      ,TARGET.[DataPubblicazione]           = SOURCE.[DataPubblicazione]        &#xA;      ,TARGET.[DataDocumento]               = SOURCE.[DataDocumento]            &#xA;      ,TARGET.[M_Quantità]                  = SOURCE.[M_Quantità]               &#xA;    &#xA;&#x9;   &#xA;&#x9;  WHEN NOT MATCHED&#xA;&#x9;  THEN INSERT (&#xA;&#x9;&#xA;&#x9;  [ArticoloKey]&#xA;      ,[MagazzinoKey]&#xA;      ,[CompanyKey]&#xA;      ,[StagioneKey]&#xA;      ,[Marchio]&#xA;      ,[AssortimentoKey]&#xA;      ,[TipoMovimento]&#xA;      ,[TipoMovimentoDescrizione]&#xA;      ,[Source No_]&#xA;      ,[NumeroDocumento]&#xA;      ,[DataPubblicazione]&#xA;      ,[DataDocumento]&#xA;      ,[M_Quantità]&#xA;&#x9;  )&#xA;&#x9;  VALUES (&#xA;&#x9;&#xA;&#x9;   [ArticoloKey]&#xA;      ,[MagazzinoKey]&#xA;      ,[CompanyKey]&#xA;      ,[StagioneKey]&#xA;      ,[Marchio]&#xA;      ,[AssortimentoKey]&#xA;      ,[TipoMovimento]&#xA;      ,[TipoMovimentoDescrizione]&#xA;      ,[Source No_]&#xA;      ,[NumeroDocumento]&#xA;      ,[DataPubblicazione]&#xA;      ,[DataDocumento]&#xA;      ,[M_Quantità]&#xA;&#x9;  );&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="Populate_FactMovimentiMagazzinoAssortimenti">
      <DTS:VariableValue
        DTS:DataType="8">MERGE [BI_Model_DWH].[dbo].[FactMovimentiMagazzinoAssortimento] AS TARGET USING (

SELECT [ArticoloKey]
      ,[MagazzinoKey]
      ,[CompanyKey]
      ,[StagioneKey]
      ,[Marchio]
      ,[AssortimentoKey]
      ,[TipoMovimento]
      ,[TipoMovimentoDescrizione]
      ,[Source No_]
      ,[NumeroDocumento]
      ,[DataPubblicazione]
      ,[DataDocumento]
      ,[M_Quantità]
  FROM [BI_Model_Stage].[stg].[vFactMovimentiMagazzinoAssortimenti] fct
  inner join ( SELECT MAX([MaxTimestamp]) as maxtimestamp from [BI_Model_Stage].cfg.Config_Delta) cfg
  on fct.timestamp &gt; cfg.maxtimestamp
     ) AS SOURCE 
  ON SOURCE.[ArticoloKey]= TARGET.[ArticoloKey]
  AND SOURCE.[NumeroDocumento]= TARGET.[NumeroDocumento]
  
  
  WHEN MATCHED
  THEN UPDATE SET 
	       
      TARGET.[MagazzinoKey]                = SOURCE.[MagazzinoKey]                         
      ,TARGET.[StagioneKey]                 = SOURCE.[StagioneKey]              
      ,TARGET.[Marchio]                     = SOURCE.[Marchio]                  
      ,TARGET.[AssortimentoKey]             = SOURCE.[AssortimentoKey]          
      ,TARGET.[TipoMovimento]               = SOURCE.[TipoMovimento]            
      ,TARGET.[TipoMovimentoDescrizione]    = SOURCE.[TipoMovimentoDescrizione] 
      ,TARGET.[Source No_]                  = SOURCE.[Source No_]                        
      ,TARGET.[DataPubblicazione]           = SOURCE.[DataPubblicazione]        
      ,TARGET.[DataDocumento]               = SOURCE.[DataDocumento]            
      ,TARGET.[M_Quantità]                  = SOURCE.[M_Quantità]               
    
	   
	  WHEN NOT MATCHED
	  THEN INSERT (
	
	  [ArticoloKey]
      ,[MagazzinoKey]
      ,[CompanyKey]
      ,[StagioneKey]
      ,[Marchio]
      ,[AssortimentoKey]
      ,[TipoMovimento]
      ,[TipoMovimentoDescrizione]
      ,[Source No_]
      ,[NumeroDocumento]
      ,[DataPubblicazione]
      ,[DataDocumento]
      ,[M_Quantità]
	  )
	  VALUES (
	
	   [ArticoloKey]
      ,[MagazzinoKey]
      ,[CompanyKey]
      ,[StagioneKey]
      ,[Marchio]
      ,[AssortimentoKey]
      ,[TipoMovimento]
      ,[TipoMovimentoDescrizione]
      ,[Source No_]
      ,[NumeroDocumento]
      ,[DataPubblicazione]
      ,[DataDocumento]
      ,[M_Quantità]
	  );</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{04359F0C-C8B7-40E0-B292-60BE4D08138D}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;MERGE [BI_Model_DWH].[dbo].[FactOrdineAcquisto] AS TARGET USING (&#xA;&#xA;SELECT [OrdineAcquistoKey]&#xA;      ,[ArticoloKey]&#xA;      ,[FornitoreKey]&#xA;      ,[MagazzinoKey]&#xA;      ,[UnitàDiMisuraKey]&#xA;      ,[CompanyKey]&#xA;      ,[StagioneKey]&#xA;      ,[Marchio]&#xA;      ,[TestataOrdineAcquisto]&#xA;      ,[RigaOrdineAcquisto]&#xA;      ,[TipoDocumento]&#xA;      ,[StatusRigaOrdineAcquisto]&#xA;      ,[RicevutoCompletamente]&#xA;      ,[CodiceStatoAcquisto]&#xA;      ,[DescrizioneStatoVendita]&#xA;      ,[DataDocumentoOrdineAcquisto]&#xA;      ,[DataOrdineOrdineAcquisto]&#xA;      ,[DataPianificataRicevimento]&#xA;      ,[DataRegistrazione]&#xA;      ,[DataCaricoPromessa]&#xA;      ,[Importo Lordo In Valuta]&#xA;      ,[Importo Sconto In Valuta]&#xA;      ,[Importo IVA In Valuta]&#xA;      ,[Importo Netto In Valuta]&#xA;      ,[M_Quantità]&#xA;      ,[M_QuantitàAcquistata]&#xA;      ,[Importo Lordo Euro]&#xA;      ,[Importo Sconto Euro]&#xA;      ,[Importo IVA Euro]&#xA;      ,[Importo Netto Euro]&#xA;      ,[Codice Motivo Reso]&#xA;      ,[Motivo Reso]&#xA;      ,[Currency Code]&#xA;      ,[Currency Factor]&#xA;      ,[Data Carico Richiesta]&#xA;&#x9;  ,[Stato Cancellazione]&#xA;&#x9;  ,[Codice Stato Vendita]&#xA;  FROM [BI_Model_Stage].[stg].[vFactOrdineAcquisto] fct&#xA;  inner join ( SELECT MAX([MaxTimestamp]) as maxtimestamp from [BI_Model_Stage].cfg.Config_Delta) cfg&#xA;  on fct.timestamp &gt; cfg.maxtimestamp&#xA;     ) AS SOURCE &#xA;  ON SOURCE.[TestataOrdineAcquisto]= TARGET.[TestataOrdineAcquisto]&#xA;  AND SOURCE.[RigaOrdineAcquisto]= TARGET.[RigaOrdineAcquisto]&#xA;  AND SOURCE.[CompanyKey]= TARGET.[CompanyKey]&#xA;  &#xA;  &#xA;  WHEN MATCHED&#xA;  THEN UPDATE SET &#xA;&#x9;&#xA;      TARGET.[TipoDocumento]                           = SOURCE.[TipoDocumento]                  &#xA;      ,TARGET.[StatusRigaOrdineAcquisto]                = SOURCE.[StatusRigaOrdineAcquisto]       &#xA;      ,TARGET.[RicevutoCompletamente]                   = SOURCE.[RicevutoCompletamente]          &#xA;      ,TARGET.[CodiceStatoAcquisto]                     = SOURCE.[CodiceStatoAcquisto]            &#xA;      ,TARGET.[DescrizioneStatoVendita]                 = SOURCE.[DescrizioneStatoVendita]        &#xA;      ,TARGET.[DataDocumentoOrdineAcquisto]             = SOURCE.[DataDocumentoOrdineAcquisto]    &#xA;      ,TARGET.[DataOrdineOrdineAcquisto]                = SOURCE.[DataOrdineOrdineAcquisto]       &#xA;      ,TARGET.[DataPianificataRicevimento]              = SOURCE.[DataPianificataRicevimento]     &#xA;      ,TARGET.[DataRegistrazione]                       = SOURCE.[DataRegistrazione]              &#xA;      ,TARGET.[DataCaricoPromessa]                      = SOURCE.[DataCaricoPromessa]             &#xA;      ,TARGET.[Importo Lordo In Valuta]                 = SOURCE.[Importo Lordo In Valuta]        &#xA;      ,TARGET.[Importo Sconto In Valuta]                = SOURCE.[Importo Sconto In Valuta]       &#xA;      ,TARGET.[Importo IVA In Valuta]                   = SOURCE.[Importo IVA In Valuta]          &#xA;      ,TARGET.[Importo Netto In Valuta]                 = SOURCE.[Importo Netto In Valuta]        &#xA;      ,TARGET.[M_Quantità]                              = SOURCE.[M_Quantità]                     &#xA;      ,TARGET.[M_QuantitàAcquistata]                    = SOURCE.[M_QuantitàAcquistata]           &#xA;      ,TARGET.[Importo Lordo Euro]                      = SOURCE.[Importo Lordo Euro]             &#xA;      ,TARGET.[Importo Sconto Euro]                     = SOURCE.[Importo Sconto Euro]            &#xA;      ,TARGET.[Importo IVA Euro]                        = SOURCE.[Importo IVA Euro]               &#xA;      ,TARGET.[Importo Netto Euro]                      = SOURCE.[Importo Netto Euro]             &#xA;      ,TARGET.[Codice Motivo Reso]                      = SOURCE.[Codice Motivo Reso]             &#xA;      ,TARGET.[Motivo Reso]                             = SOURCE.[Motivo Reso]                    &#xA;      ,TARGET.[Currency Code]                           = SOURCE.[Currency Code]                  &#xA;      ,TARGET.[Currency Factor]                         = SOURCE.[Currency Factor]&#xA;&#x9;  ,TARGET.[Data Carico Richiesta]                             = SOURCE.[Data Carico Richiesta]                    &#xA;      ,TARGET.[Stato Cancellazione]                          = SOURCE.[Stato Cancellazione]                  &#xA;      ,TARGET.[Codice Stato Vendita]                        = SOURCE.[Codice Stato Vendita]&#xA;&#x9;  &#xA;&#x9;  WHEN NOT MATCHED&#xA;&#x9;  THEN INSERT (&#xA;&#xA;&#x9;  [OrdineAcquistoKey]&#xA;      ,[ArticoloKey]&#xA;      ,[FornitoreKey]&#xA;      ,[MagazzinoKey]&#xA;      ,[UnitàDiMisuraKey]&#xA;      ,[CompanyKey]&#xA;      ,[StagioneKey]&#xA;      ,[Marchio]&#xA;      ,[TestataOrdineAcquisto]&#xA;      ,[RigaOrdineAcquisto]&#xA;      ,[TipoDocumento]&#xA;      ,[StatusRigaOrdineAcquisto]&#xA;      ,[RicevutoCompletamente]&#xA;      ,[CodiceStatoAcquisto]&#xA;      ,[DescrizioneStatoVendita]&#xA;      ,[DataDocumentoOrdineAcquisto]&#xA;      ,[DataOrdineOrdineAcquisto]&#xA;      ,[DataPianificataRicevimento]&#xA;      ,[DataRegistrazione]&#xA;      ,[DataCaricoPromessa]&#xA;      ,[Importo Lordo In Valuta]&#xA;      ,[Importo Sconto In Valuta]&#xA;      ,[Importo IVA In Valuta]&#xA;      ,[Importo Netto In Valuta]&#xA;      ,[M_Quantità]&#xA;      ,[M_QuantitàAcquistata]&#xA;      ,[Importo Lordo Euro]&#xA;      ,[Importo Sconto Euro]&#xA;      ,[Importo IVA Euro]&#xA;      ,[Importo Netto Euro]&#xA;      ,[Codice Motivo Reso]&#xA;      ,[Motivo Reso]&#xA;      ,[Currency Code]&#xA;      ,[Currency Factor]&#xA;      ,[Data Carico Richiesta]&#xA;&#x9;  ,[Stato Cancellazione]&#xA;&#x9;  ,[Codice Stato Vendita]&#xA;&#x9;  )&#xA;&#x9;  VALUES (&#xA;&#xA;&#x9;   [OrdineAcquistoKey]&#xA;      ,[ArticoloKey]&#xA;      ,[FornitoreKey]&#xA;      ,[MagazzinoKey]&#xA;      ,[UnitàDiMisuraKey]&#xA;      ,[CompanyKey]&#xA;      ,[StagioneKey]&#xA;      ,[Marchio]&#xA;      ,[TestataOrdineAcquisto]&#xA;      ,[RigaOrdineAcquisto]&#xA;      ,[TipoDocumento]&#xA;      ,[StatusRigaOrdineAcquisto]&#xA;      ,[RicevutoCompletamente]&#xA;      ,[CodiceStatoAcquisto]&#xA;      ,[DescrizioneStatoVendita]&#xA;      ,[DataDocumentoOrdineAcquisto]&#xA;      ,[DataOrdineOrdineAcquisto]&#xA;      ,[DataPianificataRicevimento]&#xA;      ,[DataRegistrazione]&#xA;      ,[DataCaricoPromessa]&#xA;      ,[Importo Lordo In Valuta]&#xA;      ,[Importo Sconto In Valuta]&#xA;      ,[Importo IVA In Valuta]&#xA;      ,[Importo Netto In Valuta]&#xA;      ,[M_Quantità]&#xA;      ,[M_QuantitàAcquistata]&#xA;      ,[Importo Lordo Euro]&#xA;      ,[Importo Sconto Euro]&#xA;      ,[Importo IVA Euro]&#xA;      ,[Importo Netto Euro]&#xA;      ,[Codice Motivo Reso]&#xA;      ,[Motivo Reso]&#xA;      ,[Currency Code]&#xA;      ,[Currency Factor]&#xA;      ,[Data Carico Richiesta]&#xA;&#x9;   ,[Stato Cancellazione]&#xA;&#x9;  ,[Codice Stato Vendita]&#xA;&#x9;  );&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="Populate_FactOrdineAcquisto">
      <DTS:VariableValue
        DTS:DataType="8">MERGE [BI_Model_DWH].[dbo].[FactOrdineAcquisto] AS TARGET USING (

SELECT [OrdineAcquistoKey]
      ,[ArticoloKey]
      ,[FornitoreKey]
      ,[MagazzinoKey]
      ,[UnitàDiMisuraKey]
      ,[CompanyKey]
      ,[StagioneKey]
      ,[Marchio]
      ,[TestataOrdineAcquisto]
      ,[RigaOrdineAcquisto]
      ,[TipoDocumento]
      ,[StatusRigaOrdineAcquisto]
      ,[RicevutoCompletamente]
      ,[CodiceStatoAcquisto]
      ,[DescrizioneStatoVendita]
      ,[DataDocumentoOrdineAcquisto]
      ,[DataOrdineOrdineAcquisto]
      ,[DataPianificataRicevimento]
      ,[DataRegistrazione]
      ,[DataCaricoPromessa]
      ,[Importo Lordo In Valuta]
      ,[Importo Sconto In Valuta]
      ,[Importo IVA In Valuta]
      ,[Importo Netto In Valuta]
      ,[M_Quantità]
      ,[M_QuantitàAcquistata]
      ,[Importo Lordo Euro]
      ,[Importo Sconto Euro]
      ,[Importo IVA Euro]
      ,[Importo Netto Euro]
      ,[Codice Motivo Reso]
      ,[Motivo Reso]
      ,[Currency Code]
      ,[Currency Factor]
      ,[Data Carico Richiesta]
	  ,[Stato Cancellazione]
	  ,[Codice Stato Vendita]
  FROM [BI_Model_Stage].[stg].[vFactOrdineAcquisto] fct
  inner join ( SELECT MAX([MaxTimestamp]) as maxtimestamp from [BI_Model_Stage].cfg.Config_Delta) cfg
  on fct.timestamp &gt; cfg.maxtimestamp
     ) AS SOURCE 
  ON SOURCE.[TestataOrdineAcquisto]= TARGET.[TestataOrdineAcquisto]
  AND SOURCE.[RigaOrdineAcquisto]= TARGET.[RigaOrdineAcquisto]
  AND SOURCE.[CompanyKey]= TARGET.[CompanyKey]
  
  
  WHEN MATCHED
  THEN UPDATE SET 
	
      TARGET.[TipoDocumento]                           = SOURCE.[TipoDocumento]                  
      ,TARGET.[StatusRigaOrdineAcquisto]                = SOURCE.[StatusRigaOrdineAcquisto]       
      ,TARGET.[RicevutoCompletamente]                   = SOURCE.[RicevutoCompletamente]          
      ,TARGET.[CodiceStatoAcquisto]                     = SOURCE.[CodiceStatoAcquisto]            
      ,TARGET.[DescrizioneStatoVendita]                 = SOURCE.[DescrizioneStatoVendita]        
      ,TARGET.[DataDocumentoOrdineAcquisto]             = SOURCE.[DataDocumentoOrdineAcquisto]    
      ,TARGET.[DataOrdineOrdineAcquisto]                = SOURCE.[DataOrdineOrdineAcquisto]       
      ,TARGET.[DataPianificataRicevimento]              = SOURCE.[DataPianificataRicevimento]     
      ,TARGET.[DataRegistrazione]                       = SOURCE.[DataRegistrazione]              
      ,TARGET.[DataCaricoPromessa]                      = SOURCE.[DataCaricoPromessa]             
      ,TARGET.[Importo Lordo In Valuta]                 = SOURCE.[Importo Lordo In Valuta]        
      ,TARGET.[Importo Sconto In Valuta]                = SOURCE.[Importo Sconto In Valuta]       
      ,TARGET.[Importo IVA In Valuta]                   = SOURCE.[Importo IVA In Valuta]          
      ,TARGET.[Importo Netto In Valuta]                 = SOURCE.[Importo Netto In Valuta]        
      ,TARGET.[M_Quantità]                              = SOURCE.[M_Quantità]                     
      ,TARGET.[M_QuantitàAcquistata]                    = SOURCE.[M_QuantitàAcquistata]           
      ,TARGET.[Importo Lordo Euro]                      = SOURCE.[Importo Lordo Euro]             
      ,TARGET.[Importo Sconto Euro]                     = SOURCE.[Importo Sconto Euro]            
      ,TARGET.[Importo IVA Euro]                        = SOURCE.[Importo IVA Euro]               
      ,TARGET.[Importo Netto Euro]                      = SOURCE.[Importo Netto Euro]             
      ,TARGET.[Codice Motivo Reso]                      = SOURCE.[Codice Motivo Reso]             
      ,TARGET.[Motivo Reso]                             = SOURCE.[Motivo Reso]                    
      ,TARGET.[Currency Code]                           = SOURCE.[Currency Code]                  
      ,TARGET.[Currency Factor]                         = SOURCE.[Currency Factor]
	  ,TARGET.[Data Carico Richiesta]                             = SOURCE.[Data Carico Richiesta]                    
      ,TARGET.[Stato Cancellazione]                          = SOURCE.[Stato Cancellazione]                  
      ,TARGET.[Codice Stato Vendita]                        = SOURCE.[Codice Stato Vendita]
	  
	  WHEN NOT MATCHED
	  THEN INSERT (

	  [OrdineAcquistoKey]
      ,[ArticoloKey]
      ,[FornitoreKey]
      ,[MagazzinoKey]
      ,[UnitàDiMisuraKey]
      ,[CompanyKey]
      ,[StagioneKey]
      ,[Marchio]
      ,[TestataOrdineAcquisto]
      ,[RigaOrdineAcquisto]
      ,[TipoDocumento]
      ,[StatusRigaOrdineAcquisto]
      ,[RicevutoCompletamente]
      ,[CodiceStatoAcquisto]
      ,[DescrizioneStatoVendita]
      ,[DataDocumentoOrdineAcquisto]
      ,[DataOrdineOrdineAcquisto]
      ,[DataPianificataRicevimento]
      ,[DataRegistrazione]
      ,[DataCaricoPromessa]
      ,[Importo Lordo In Valuta]
      ,[Importo Sconto In Valuta]
      ,[Importo IVA In Valuta]
      ,[Importo Netto In Valuta]
      ,[M_Quantità]
      ,[M_QuantitàAcquistata]
      ,[Importo Lordo Euro]
      ,[Importo Sconto Euro]
      ,[Importo IVA Euro]
      ,[Importo Netto Euro]
      ,[Codice Motivo Reso]
      ,[Motivo Reso]
      ,[Currency Code]
      ,[Currency Factor]
      ,[Data Carico Richiesta]
	  ,[Stato Cancellazione]
	  ,[Codice Stato Vendita]
	  )
	  VALUES (

	   [OrdineAcquistoKey]
      ,[ArticoloKey]
      ,[FornitoreKey]
      ,[MagazzinoKey]
      ,[UnitàDiMisuraKey]
      ,[CompanyKey]
      ,[StagioneKey]
      ,[Marchio]
      ,[TestataOrdineAcquisto]
      ,[RigaOrdineAcquisto]
      ,[TipoDocumento]
      ,[StatusRigaOrdineAcquisto]
      ,[RicevutoCompletamente]
      ,[CodiceStatoAcquisto]
      ,[DescrizioneStatoVendita]
      ,[DataDocumentoOrdineAcquisto]
      ,[DataOrdineOrdineAcquisto]
      ,[DataPianificataRicevimento]
      ,[DataRegistrazione]
      ,[DataCaricoPromessa]
      ,[Importo Lordo In Valuta]
      ,[Importo Sconto In Valuta]
      ,[Importo IVA In Valuta]
      ,[Importo Netto In Valuta]
      ,[M_Quantità]
      ,[M_QuantitàAcquistata]
      ,[Importo Lordo Euro]
      ,[Importo Sconto Euro]
      ,[Importo IVA Euro]
      ,[Importo Netto Euro]
      ,[Codice Motivo Reso]
      ,[Motivo Reso]
      ,[Currency Code]
      ,[Currency Factor]
      ,[Data Carico Richiesta]
	   ,[Stato Cancellazione]
	  ,[Codice Stato Vendita]
	  );</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{4260948D-044A-409C-8506-1A9AC5839AB4}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;MERGE [BI_Model_DWH].[dbo].[FactOrdineAcquistoAssortimento] AS TARGET USING (&#xA;&#xA;SELECT [OrdineAcquistoKey]&#xA;      ,[ArticoloKey]&#xA;      ,[FornitoreKey]&#xA;      ,[AssortimentoKey]&#xA;      ,[MagazzinoKey]&#xA;      ,[UnitàDiMisuraKey]&#xA;      ,[CompanyKey]&#xA;      ,[StagioneKey]&#xA;      ,[StagioneListinoKey]&#xA;      ,[Marchio]&#xA;      ,[TestataOrdineAcquisto]&#xA;      ,[RigaOrdineAcquisto]&#xA;      ,[TipoDocumento]&#xA;      ,[DataDocumentoOrdineAcquisto]&#xA;      ,[DataOrdineOrdineAcquisto]&#xA;      ,[DataPianificataRicevimento]&#xA;      ,[M_Quantità]&#xA;      ,[M_QuantitàAcquistata]&#xA;  FROM [BI_Model_Stage].[stg].[vFactOrdineAcquistoAssortimento] fct&#xA;  inner join ( SELECT MAX([MaxTimestamp]) as maxtimestamp from [BI_Model_Stage].cfg.Config_Delta) cfg&#xA;  on fct.timestamp &gt; cfg.maxtimestamp&#xA;     ) AS SOURCE &#xA;  ON SOURCE.[OrdineAcquistoKey]= TARGET.[OrdineAcquistoKey]&#xA;  &#xA;  &#xA;  WHEN MATCHED&#xA;  THEN UPDATE SET &#xA;&#x9;      &#xA;      TARGET.[ArticoloKey]                  = SOURCE.[ArticoloKey]                &#xA;      ,TARGET.[FornitoreKey]                 = SOURCE.[FornitoreKey]               &#xA;      ,TARGET.[AssortimentoKey]              = SOURCE.[AssortimentoKey]            &#xA;      ,TARGET.[MagazzinoKey]                 = SOURCE.[MagazzinoKey]               &#xA;      ,TARGET.[UnitàDiMisuraKey]             = SOURCE.[UnitàDiMisuraKey]           &#xA;                       &#xA;      ,TARGET.[StagioneKey]                  = SOURCE.[StagioneKey]                &#xA;      ,TARGET.[StagioneListinoKey]           = SOURCE.[StagioneListinoKey]         &#xA;       &#xA;      ,TARGET.[TipoDocumento]                = SOURCE.[TipoDocumento]              &#xA;      ,TARGET.[DataDocumentoOrdineAcquisto]  = SOURCE.[DataDocumentoOrdineAcquisto]&#xA;      ,TARGET.[DataOrdineOrdineAcquisto]     = SOURCE.[DataOrdineOrdineAcquisto]   &#xA;      ,TARGET.[DataPianificataRicevimento]   = SOURCE.[DataPianificataRicevimento] &#xA;      ,TARGET.[M_Quantità]                   = SOURCE.[M_Quantità]                 &#xA;      ,TARGET.[M_QuantitàAcquistata]         = SOURCE.[M_QuantitàAcquistata]       &#xA;&#x9;  &#xA;&#x9;  WHEN NOT MATCHED&#xA;&#x9;  THEN INSERT (&#xA;&#x9;&#xA;&#x9;  [OrdineAcquistoKey]&#xA;      ,[ArticoloKey]&#xA;      ,[FornitoreKey]&#xA;      ,[AssortimentoKey]&#xA;      ,[MagazzinoKey]&#xA;      ,[UnitàDiMisuraKey]&#xA;      ,[CompanyKey]&#xA;      ,[StagioneKey]&#xA;      ,[StagioneListinoKey]&#xA;      ,[Marchio]&#xA;      ,[TestataOrdineAcquisto]&#xA;      ,[RigaOrdineAcquisto]&#xA;      ,[TipoDocumento]&#xA;      ,[DataDocumentoOrdineAcquisto]&#xA;      ,[DataOrdineOrdineAcquisto]&#xA;      ,[DataPianificataRicevimento]&#xA;      ,[M_Quantità]&#xA;      ,[M_QuantitàAcquistata]&#xA;&#x9;  )&#xA;&#x9;  VALUES (&#xA;&#x9;&#xA;&#x9;   [OrdineAcquistoKey]&#xA;      ,[ArticoloKey]&#xA;      ,[FornitoreKey]&#xA;      ,[AssortimentoKey]&#xA;      ,[MagazzinoKey]&#xA;      ,[UnitàDiMisuraKey]&#xA;      ,[CompanyKey]&#xA;      ,[StagioneKey]&#xA;      ,[StagioneListinoKey]&#xA;      ,[Marchio]&#xA;      ,[TestataOrdineAcquisto]&#xA;      ,[RigaOrdineAcquisto]&#xA;      ,[TipoDocumento]&#xA;      ,[DataDocumentoOrdineAcquisto]&#xA;      ,[DataOrdineOrdineAcquisto]&#xA;      ,[DataPianificataRicevimento]&#xA;      ,[M_Quantità]&#xA;      ,[M_QuantitàAcquistata]&#xA;&#x9;  );&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="Populate_FactOrdineAcquistoAssortimento">
      <DTS:VariableValue
        DTS:DataType="8">MERGE [BI_Model_DWH].[dbo].[FactOrdineAcquistoAssortimento] AS TARGET USING (

SELECT [OrdineAcquistoKey]
      ,[ArticoloKey]
      ,[FornitoreKey]
      ,[AssortimentoKey]
      ,[MagazzinoKey]
      ,[UnitàDiMisuraKey]
      ,[CompanyKey]
      ,[StagioneKey]
      ,[StagioneListinoKey]
      ,[Marchio]
      ,[TestataOrdineAcquisto]
      ,[RigaOrdineAcquisto]
      ,[TipoDocumento]
      ,[DataDocumentoOrdineAcquisto]
      ,[DataOrdineOrdineAcquisto]
      ,[DataPianificataRicevimento]
      ,[M_Quantità]
      ,[M_QuantitàAcquistata]
  FROM [BI_Model_Stage].[stg].[vFactOrdineAcquistoAssortimento] fct
  inner join ( SELECT MAX([MaxTimestamp]) as maxtimestamp from [BI_Model_Stage].cfg.Config_Delta) cfg
  on fct.timestamp &gt; cfg.maxtimestamp
     ) AS SOURCE 
  ON SOURCE.[OrdineAcquistoKey]= TARGET.[OrdineAcquistoKey]
  
  
  WHEN MATCHED
  THEN UPDATE SET 
	      
      TARGET.[ArticoloKey]                  = SOURCE.[ArticoloKey]                
      ,TARGET.[FornitoreKey]                 = SOURCE.[FornitoreKey]               
      ,TARGET.[AssortimentoKey]              = SOURCE.[AssortimentoKey]            
      ,TARGET.[MagazzinoKey]                 = SOURCE.[MagazzinoKey]               
      ,TARGET.[UnitàDiMisuraKey]             = SOURCE.[UnitàDiMisuraKey]           
                       
      ,TARGET.[StagioneKey]                  = SOURCE.[StagioneKey]                
      ,TARGET.[StagioneListinoKey]           = SOURCE.[StagioneListinoKey]         
       
      ,TARGET.[TipoDocumento]                = SOURCE.[TipoDocumento]              
      ,TARGET.[DataDocumentoOrdineAcquisto]  = SOURCE.[DataDocumentoOrdineAcquisto]
      ,TARGET.[DataOrdineOrdineAcquisto]     = SOURCE.[DataOrdineOrdineAcquisto]   
      ,TARGET.[DataPianificataRicevimento]   = SOURCE.[DataPianificataRicevimento] 
      ,TARGET.[M_Quantità]                   = SOURCE.[M_Quantità]                 
      ,TARGET.[M_QuantitàAcquistata]         = SOURCE.[M_QuantitàAcquistata]       
	  
	  WHEN NOT MATCHED
	  THEN INSERT (
	
	  [OrdineAcquistoKey]
      ,[ArticoloKey]
      ,[FornitoreKey]
      ,[AssortimentoKey]
      ,[MagazzinoKey]
      ,[UnitàDiMisuraKey]
      ,[CompanyKey]
      ,[StagioneKey]
      ,[StagioneListinoKey]
      ,[Marchio]
      ,[TestataOrdineAcquisto]
      ,[RigaOrdineAcquisto]
      ,[TipoDocumento]
      ,[DataDocumentoOrdineAcquisto]
      ,[DataOrdineOrdineAcquisto]
      ,[DataPianificataRicevimento]
      ,[M_Quantità]
      ,[M_QuantitàAcquistata]
	  )
	  VALUES (
	
	   [OrdineAcquistoKey]
      ,[ArticoloKey]
      ,[FornitoreKey]
      ,[AssortimentoKey]
      ,[MagazzinoKey]
      ,[UnitàDiMisuraKey]
      ,[CompanyKey]
      ,[StagioneKey]
      ,[StagioneListinoKey]
      ,[Marchio]
      ,[TestataOrdineAcquisto]
      ,[RigaOrdineAcquisto]
      ,[TipoDocumento]
      ,[DataDocumentoOrdineAcquisto]
      ,[DataOrdineOrdineAcquisto]
      ,[DataPianificataRicevimento]
      ,[M_Quantità]
      ,[M_QuantitàAcquistata]
	  );</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{F22D4333-A0D7-464B-BD70-76E9D462EE9E}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;MERGE [BI_Model_DWH].[dbo].[FactOrdineVendita_NEW] AS TARGET USING (&#xA;&#xA;SELECT [timestamp]&#xA;&#x9;  ,[CompanyKey]&#xA;      ,[ArticoloKey]&#xA;      ,[MagazzinoKey]&#xA;      ,[M_Quantità]&#xA;      ,[TipoDocumento]&#xA;      ,[DocumentoKey]&#xA;      ,[Importo Lordo In Valuta]&#xA;      ,[Importo Sconto In Valuta]&#xA;      ,[Importo IVA In Valuta]&#xA;      ,[Importo Netto In Valuta]&#xA;      ,[Importo Lordo Euro]&#xA;      ,[Importo Sconto Euro]&#xA;      ,[Importo IVA Euro]&#xA;      ,[Importo Netto Euro]&#xA;      ,[OrdineVenditaKey]&#xA;      ,[AgenteKey]&#xA;      ,[ClienteKey]&#xA;      ,[NumeroDocumento]&#xA;      ,[OrdineVenditaTestata]&#xA;      ,[OrdineVenditaNumeroRiga]&#xA;      ,[StatusRiga]&#xA;      ,[DataSpedizioneOrdineVendita]&#xA;      ,[DataOrdineVendita]&#xA;      ,[DataDocumentoOrdineVendita]&#xA;      ,[StagioneKey]&#xA;      ,[UnitàDiMisuraKey]&#xA;      ,[CanaleKey]&#xA;      ,[SubcaneleKey]&#xA;      ,[Marchio]&#xA;      ,[DescrizioneTipoOrdine]&#xA;      ,[CodiceStatoVendita]&#xA;      ,[DescrizioneStatoVendita]&#xA;      ,[TipoVendita]&#xA;      ,[Importo Sconto Commerciale In Valuta]&#xA;      ,[Importo Sconto Finanziario In Valuta]&#xA;      ,[Importo Sconto Commerciale Euro]&#xA;      ,[Importo Sconto Finanziario Euro]&#xA;      ,[StatoCancellazione]&#xA;      ,[Tasso di Cambio]&#xA;      ,[CodicePagamento]&#xA;      ,[MetodoPagamento]&#xA;      ,[VATRegistrationNumber]&#xA;      ,[CodiceTipoOrdineKey]&#xA;      ,[M_QuantitàSpedita]&#xA;      ,[M_QuantitàDaSpedire]&#xA;      ,[DataRegistrazioneOrdineVendita]&#xA;      ,[Importo Lordo Spedito In Valuta]&#xA;      ,[Importo Netto Spedito In Valuta]&#xA;      ,[Importo Lordo Spedito Euro]&#xA;      ,[Importo Netto Spedito Euro]&#xA;      ,[Zonakey]&#xA;      ,[DataPianificataSpedizione]&#xA;      ,[StagioneListinoKey]&#xA;      ,[ZonaAgenteKey]&#xA;      ,[M_QuantitàSpeditaNonFatturata]&#xA;      ,[Importo Spedito Non Fatturato]&#xA;      ,[DataConsegnaRichiesta]&#xA;      ,[Importo Netto da Spedire Euro]&#xA;      ,[FilialeKey]&#xA;      ,[LocationKey_CLIENTE]&#xA;      ,[Transfer-to Location]&#xA;      ,[Rif Ordine Cliente]&#xA;      ,[Provvigioni Agente]&#xA;      ,[Provvigioni Agente Euro]&#xA;,[Magento Coupon code]&#xA;  FROM [BI_Model_Stage].[stg].[vFactOrdineVendita] fct&#xA;  inner join ( SELECT MAX([MaxTimestamp]) as maxtimestamp from [BI_Model_Stage].cfg.Config_Delta) cfg&#xA;  on fct.timestamp &gt; cfg.maxtimestamp&#xA;  WHERE [TipoVendita]&lt;&gt;'Offerta di vendita'&#xA;   ) AS SOURCE &#xA;  ON SOURCE.Ordinevenditakey=TARGET.Ordinevenditakey&#xA;  &#xA;  WHEN MATCHED&#xA;  THEN UPDATE SET &#xA;&#x9; &#xA;&#x9;  TARGET.[ArticoloKey]                                  =SOURCE.[ArticoloKey]&#xA;      ,TARGET.[AgenteKey]                                    =SOURCE.[AgenteKey]&#xA;      ,TARGET.[ClienteKey]                                   =SOURCE.[ClienteKey]&#xA;      ,TARGET.[MagazzinoKey]                                 =SOURCE.[MagazzinoKey]&#xA;      ,TARGET.[CompanyKey]                                   =SOURCE.[CompanyKey]&#xA;      ,TARGET.[StagioneKey]                                  =SOURCE.[StagioneKey]&#xA;      ,TARGET.[UnitàDiMisuraKey]                             =SOURCE.[UnitàDiMisuraKey]&#xA;      ,TARGET.[Rif Ordine Cliente]                           =SOURCE.[Rif Ordine Cliente]&#xA;      ,TARGET.[StagioneListinoKey]                           =SOURCE.[StagioneListinoKey]&#xA;      ,TARGET.[FilialeKey]                                   =SOURCE.[FilialeKey]&#xA;      ,TARGET.[CanaleKey]                                    =SOURCE.[CanaleKey]&#xA;      ,TARGET.[SubcaneleKey]                                 =SOURCE.[SubcaneleKey]&#xA;      ,TARGET.[Zonakey]                                      =SOURCE.[Zonakey]&#xA;      ,TARGET.[ZonaAgenteKey]                                =SOURCE.[ZonaAgenteKey]&#xA;      ,TARGET.[Marchio]                                      =SOURCE.[Marchio]&#xA;      ,TARGET.[StatusRiga]                                   =SOURCE.[StatusRiga]&#xA;      ,TARGET.[TipoDocumento]                                =SOURCE.[TipoDocumento]&#xA;      ,TARGET.[CodiceTipoOrdineKey]                          =SOURCE.[CodiceTipoOrdineKey]&#xA;      ,TARGET.[DescrizioneTipoOrdine]                        =SOURCE.[DescrizioneTipoOrdine]&#xA;      ,TARGET.[CodiceStatoVendita]                           =SOURCE.[CodiceStatoVendita]&#xA;      ,TARGET.[DescrizioneStatoVendita]                      =SOURCE.[DescrizioneStatoVendita]&#xA;      ,TARGET.[TipoVendita]                                  =SOURCE.[TipoVendita]&#xA;      ,TARGET.[StatoCancellazione]                           =SOURCE.[StatoCancellazione]&#xA;      ,TARGET.[DataSpedizioneOrdineVendita]                  =SOURCE.[DataSpedizioneOrdineVendita]&#xA;      ,TARGET.[DataOrdineVendita]                            =SOURCE.[DataOrdineVendita]&#xA;      ,TARGET.[DataDocumentoOrdineVendita]                   =SOURCE.[DataDocumentoOrdineVendita]&#xA;      ,TARGET.[DataRegistrazioneOrdineVendita]               =SOURCE.[DataRegistrazioneOrdineVendita]&#xA;      ,TARGET.[DataPianificataSpedizione]                    =SOURCE.[DataPianificataSpedizione]&#xA;      ,TARGET.[DataConsegnaRichiesta]                        =SOURCE.[DataConsegnaRichiesta]&#xA;      ,TARGET.[CodicePagamento]                              =SOURCE.[CodicePagamento]&#xA;      ,TARGET.[MetodoPagamento]                              =SOURCE.[MetodoPagamento]&#xA;      ,TARGET.[VATRegistrationNumber]                        =SOURCE.[VATRegistrationNumber]&#xA;      ,TARGET.[Importo Lordo In Valuta]                      =SOURCE.[Importo Lordo In Valuta]&#xA;      ,TARGET.[Importo Sconto In Valuta]                     =SOURCE.[Importo Sconto In Valuta]&#xA;      ,TARGET.[Importo Sconto Commerciale In Valuta]         =SOURCE.[Importo Sconto Commerciale In Valuta]&#xA;      ,TARGET.[Importo Sconto Finanziario In Valuta]         =SOURCE.[Importo Sconto Finanziario In Valuta]&#xA;      ,TARGET.[Importo IVA In Valuta]                        =SOURCE.[Importo IVA In Valuta]&#xA;      ,TARGET.[Importo Netto In Valuta]                      =SOURCE.[Importo Netto In Valuta]&#xA;      ,TARGET.[Importo Spedito Non Fatturato]                =SOURCE.[Importo Spedito Non Fatturato]&#xA;      ,TARGET.[Importo Lordo Spedito In Valuta]              =SOURCE.[Importo Lordo Spedito In Valuta]&#xA;      ,TARGET.[Importo Netto Spedito In Valuta]              =SOURCE.[Importo Netto Spedito In Valuta]&#xA;      ,TARGET.[M_Quantità]                                   =SOURCE.[M_Quantità]&#xA;      ,TARGET.[M_QuantitàSpeditaNonFatturata]                =SOURCE.[M_QuantitàSpeditaNonFatturata]&#xA;      ,TARGET.[M_QuantitàSpedita]                            =SOURCE.[M_QuantitàSpedita]&#xA;      ,TARGET.[M_QuantitàDaSpedire]                          =SOURCE.[M_QuantitàDaSpedire]&#xA;      ,TARGET.[Importo Lordo Euro]                           =SOURCE.[Importo Lordo Euro]&#xA;      ,TARGET.[Importo Sconto Euro]                          =SOURCE.[Importo Sconto Euro]&#xA;      ,TARGET.[Importo IVA Euro]                             =SOURCE.[Importo IVA Euro]&#xA;      ,TARGET.[Importo Netto Euro]                           =SOURCE.[Importo Netto Euro]&#xA;      ,TARGET.[Importo Sconto Commerciale Euro]              =SOURCE.[Importo Sconto Commerciale Euro]&#xA;      ,TARGET.[Importo Sconto Finanziario Euro]              =SOURCE.[Importo Sconto Finanziario Euro]&#xA;      ,TARGET.[Importo Lordo Spedito Euro]                   =SOURCE.[Importo Lordo Spedito Euro]&#xA;      ,TARGET.[Importo Netto Spedito Euro]                   =SOURCE.[Importo Netto Spedito Euro]&#xA;      ,TARGET.[Importo Netto da Spedire Euro]                =SOURCE.[Importo Netto da Spedire Euro]&#xA;      ,TARGET.[Tasso di Cambio]                              =SOURCE.[Tasso di Cambio]&#xA;      ,TARGET.[LocationKey_CLIENTE]                          =SOURCE.[LocationKey_CLIENTE]&#xA;      ,TARGET.[Transfer-to Location]                         =SOURCE.[Transfer-to Location]&#xA;      ,TARGET.[Provvigioni Agente]                           =SOURCE.[Provvigioni Agente]&#xA;      ,TARGET.[Provvigioni Agente Euro]                      =SOURCE.[Provvigioni Agente Euro] &#xA;,TARGET.[Magento Coupon code] = SOURCE.[Magento Coupon code]&#xA;&#x9;  &#xA;&#x9;  WHEN NOT MATCHED&#xA;&#x9;  THEN INSERT (&#xA;&#x9;&#xA;&#x9;  [CompanyKey]&#xA;      ,[ArticoloKey]&#xA;      ,[MagazzinoKey]&#xA;      ,[M_Quantità]&#xA;      ,[TipoDocumento]&#xA;      ,[DocumentoKey]&#xA;      ,[Importo Lordo In Valuta]&#xA;      ,[Importo Sconto In Valuta]&#xA;      ,[Importo IVA In Valuta]&#xA;      ,[Importo Netto In Valuta]&#xA;      ,[Importo Lordo Euro]&#xA;      ,[Importo Sconto Euro]&#xA;      ,[Importo IVA Euro]&#xA;      ,[Importo Netto Euro]&#xA;      ,[OrdineVenditaKey]&#xA;      ,[AgenteKey]&#xA;      ,[ClienteKey]&#xA;      ,[NumeroDocumento]&#xA;      ,[OrdineVenditaTestata]&#xA;      ,[OrdineVenditaNumeroRiga]&#xA;      ,[StatusRiga]&#xA;      ,[DataSpedizioneOrdineVendita]&#xA;      ,[DataOrdineVendita]&#xA;      ,[DataDocumentoOrdineVendita]&#xA;      ,[StagioneKey]&#xA;      ,[UnitàDiMisuraKey]&#xA;      ,[CanaleKey]&#xA;      ,[SubcaneleKey]&#xA;      ,[Marchio]&#xA;      ,[DescrizioneTipoOrdine]&#xA;      ,[CodiceStatoVendita]&#xA;      ,[DescrizioneStatoVendita]&#xA;      ,[TipoVendita]&#xA;      ,[Importo Sconto Commerciale In Valuta]&#xA;      ,[Importo Sconto Finanziario In Valuta]&#xA;      ,[Importo Sconto Commerciale Euro]&#xA;      ,[Importo Sconto Finanziario Euro]&#xA;      ,[StatoCancellazione]&#xA;      ,[Tasso di Cambio]&#xA;      ,[CodicePagamento]&#xA;      ,[MetodoPagamento]&#xA;      ,[VATRegistrationNumber]&#xA;      ,[CodiceTipoOrdineKey]&#xA;      ,[M_QuantitàSpedita]&#xA;      ,[M_QuantitàDaSpedire]&#xA;      ,[DataRegistrazioneOrdineVendita]&#xA;      ,[Importo Lordo Spedito In Valuta]&#xA;      ,[Importo Netto Spedito In Valuta]&#xA;      ,[Importo Lordo Spedito Euro]&#xA;      ,[Importo Netto Spedito Euro]&#xA;      ,[Zonakey]&#xA;      ,[DataPianificataSpedizione]&#xA;      ,[StagioneListinoKey]&#xA;      ,[ZonaAgenteKey]&#xA;      ,[M_QuantitàSpeditaNonFatturata]&#xA;      ,[Importo Spedito Non Fatturato]&#xA;      ,[DataConsegnaRichiesta]&#xA;      ,[Importo Netto da Spedire Euro]&#xA;      ,[FilialeKey]&#xA;      ,[LocationKey_CLIENTE]&#xA;      ,[Transfer-to Location]&#xA;      ,[Rif Ordine Cliente]&#xA;      ,[Provvigioni Agente]&#xA;      ,[Provvigioni Agente Euro]&#xA;      ,[Magento Coupon code]&#xA;&#x9;  )&#xA;&#x9;  VALUES (&#xA;&#x9;&#xA;&#x9;   [CompanyKey]&#xA;      ,[ArticoloKey]&#xA;      ,[MagazzinoKey]&#xA;      ,[M_Quantità]&#xA;      ,[TipoDocumento]&#xA;      ,[DocumentoKey]&#xA;      ,[Importo Lordo In Valuta]&#xA;      ,[Importo Sconto In Valuta]&#xA;      ,[Importo IVA In Valuta]&#xA;      ,[Importo Netto In Valuta]&#xA;      ,[Importo Lordo Euro]&#xA;      ,[Importo Sconto Euro]&#xA;      ,[Importo IVA Euro]&#xA;      ,[Importo Netto Euro]&#xA;      ,[OrdineVenditaKey]&#xA;      ,[AgenteKey]&#xA;      ,[ClienteKey]&#xA;      ,[NumeroDocumento]&#xA;      ,[OrdineVenditaTestata]&#xA;      ,[OrdineVenditaNumeroRiga]&#xA;      ,[StatusRiga]&#xA;      ,[DataSpedizioneOrdineVendita]&#xA;      ,[DataOrdineVendita]&#xA;      ,[DataDocumentoOrdineVendita]&#xA;      ,[StagioneKey]&#xA;      ,[UnitàDiMisuraKey]&#xA;      ,[CanaleKey]&#xA;      ,[SubcaneleKey]&#xA;      ,[Marchio]&#xA;      ,[DescrizioneTipoOrdine]&#xA;      ,[CodiceStatoVendita]&#xA;      ,[DescrizioneStatoVendita]&#xA;      ,[TipoVendita]&#xA;      ,[Importo Sconto Commerciale In Valuta]&#xA;      ,[Importo Sconto Finanziario In Valuta]&#xA;      ,[Importo Sconto Commerciale Euro]&#xA;      ,[Importo Sconto Finanziario Euro]&#xA;      ,[StatoCancellazione]&#xA;      ,[Tasso di Cambio]&#xA;      ,[CodicePagamento]&#xA;      ,[MetodoPagamento]&#xA;      ,[VATRegistrationNumber]&#xA;      ,[CodiceTipoOrdineKey]&#xA;      ,[M_QuantitàSpedita]&#xA;      ,[M_QuantitàDaSpedire]&#xA;      ,[DataRegistrazioneOrdineVendita]&#xA;      ,[Importo Lordo Spedito In Valuta]&#xA;      ,[Importo Netto Spedito In Valuta]&#xA;      ,[Importo Lordo Spedito Euro]&#xA;      ,[Importo Netto Spedito Euro]&#xA;      ,[Zonakey]&#xA;      ,[DataPianificataSpedizione]&#xA;      ,[StagioneListinoKey]&#xA;      ,[ZonaAgenteKey]&#xA;      ,[M_QuantitàSpeditaNonFatturata]&#xA;      ,[Importo Spedito Non Fatturato]&#xA;      ,[DataConsegnaRichiesta]&#xA;      ,[Importo Netto da Spedire Euro]&#xA;      ,[FilialeKey]&#xA;      ,[LocationKey_CLIENTE]&#xA;      ,[Transfer-to Location]&#xA;      ,[Rif Ordine Cliente]&#xA;      ,[Provvigioni Agente]&#xA;      ,[Provvigioni Agente Euro]&#xA;      ,[Magento Coupon code]&#xA;&#x9;  );&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="Populate_FactOrdineVendita">
      <DTS:VariableValue
        DTS:DataType="8">MERGE [BI_Model_DWH].[dbo].[FactOrdineVendita_NEW] AS TARGET USING (

SELECT [timestamp]
	  ,[CompanyKey]
      ,[ArticoloKey]
      ,[MagazzinoKey]
      ,[M_Quantità]
      ,[TipoDocumento]
      ,[DocumentoKey]
      ,[Importo Lordo In Valuta]
      ,[Importo Sconto In Valuta]
      ,[Importo IVA In Valuta]
      ,[Importo Netto In Valuta]
      ,[Importo Lordo Euro]
      ,[Importo Sconto Euro]
      ,[Importo IVA Euro]
      ,[Importo Netto Euro]
      ,[OrdineVenditaKey]
      ,[AgenteKey]
      ,[ClienteKey]
      ,[NumeroDocumento]
      ,[OrdineVenditaTestata]
      ,[OrdineVenditaNumeroRiga]
      ,[StatusRiga]
      ,[DataSpedizioneOrdineVendita]
      ,[DataOrdineVendita]
      ,[DataDocumentoOrdineVendita]
      ,[StagioneKey]
      ,[UnitàDiMisuraKey]
      ,[CanaleKey]
      ,[SubcaneleKey]
      ,[Marchio]
      ,[DescrizioneTipoOrdine]
      ,[CodiceStatoVendita]
      ,[DescrizioneStatoVendita]
      ,[TipoVendita]
      ,[Importo Sconto Commerciale In Valuta]
      ,[Importo Sconto Finanziario In Valuta]
      ,[Importo Sconto Commerciale Euro]
      ,[Importo Sconto Finanziario Euro]
      ,[StatoCancellazione]
      ,[Tasso di Cambio]
      ,[CodicePagamento]
      ,[MetodoPagamento]
      ,[VATRegistrationNumber]
      ,[CodiceTipoOrdineKey]
      ,[M_QuantitàSpedita]
      ,[M_QuantitàDaSpedire]
      ,[DataRegistrazioneOrdineVendita]
      ,[Importo Lordo Spedito In Valuta]
      ,[Importo Netto Spedito In Valuta]
      ,[Importo Lordo Spedito Euro]
      ,[Importo Netto Spedito Euro]
      ,[Zonakey]
      ,[DataPianificataSpedizione]
      ,[StagioneListinoKey]
      ,[ZonaAgenteKey]
      ,[M_QuantitàSpeditaNonFatturata]
      ,[Importo Spedito Non Fatturato]
      ,[DataConsegnaRichiesta]
      ,[Importo Netto da Spedire Euro]
      ,[FilialeKey]
      ,[LocationKey_CLIENTE]
      ,[Transfer-to Location]
      ,[Rif Ordine Cliente]
      ,[Provvigioni Agente]
      ,[Provvigioni Agente Euro]
,[Magento Coupon code]
  FROM [BI_Model_Stage].[stg].[vFactOrdineVendita] fct
  inner join ( SELECT MAX([MaxTimestamp]) as maxtimestamp from [BI_Model_Stage].cfg.Config_Delta) cfg
  on fct.timestamp &gt; cfg.maxtimestamp
  WHERE [TipoVendita]&lt;&gt;'Offerta di vendita'
   ) AS SOURCE 
  ON SOURCE.Ordinevenditakey=TARGET.Ordinevenditakey
  
  WHEN MATCHED
  THEN UPDATE SET 
	 
	  TARGET.[ArticoloKey]                                  =SOURCE.[ArticoloKey]
      ,TARGET.[AgenteKey]                                    =SOURCE.[AgenteKey]
      ,TARGET.[ClienteKey]                                   =SOURCE.[ClienteKey]
      ,TARGET.[MagazzinoKey]                                 =SOURCE.[MagazzinoKey]
      ,TARGET.[CompanyKey]                                   =SOURCE.[CompanyKey]
      ,TARGET.[StagioneKey]                                  =SOURCE.[StagioneKey]
      ,TARGET.[UnitàDiMisuraKey]                             =SOURCE.[UnitàDiMisuraKey]
      ,TARGET.[Rif Ordine Cliente]                           =SOURCE.[Rif Ordine Cliente]
      ,TARGET.[StagioneListinoKey]                           =SOURCE.[StagioneListinoKey]
      ,TARGET.[FilialeKey]                                   =SOURCE.[FilialeKey]
      ,TARGET.[CanaleKey]                                    =SOURCE.[CanaleKey]
      ,TARGET.[SubcaneleKey]                                 =SOURCE.[SubcaneleKey]
      ,TARGET.[Zonakey]                                      =SOURCE.[Zonakey]
      ,TARGET.[ZonaAgenteKey]                                =SOURCE.[ZonaAgenteKey]
      ,TARGET.[Marchio]                                      =SOURCE.[Marchio]
      ,TARGET.[StatusRiga]                                   =SOURCE.[StatusRiga]
      ,TARGET.[TipoDocumento]                                =SOURCE.[TipoDocumento]
      ,TARGET.[CodiceTipoOrdineKey]                          =SOURCE.[CodiceTipoOrdineKey]
      ,TARGET.[DescrizioneTipoOrdine]                        =SOURCE.[DescrizioneTipoOrdine]
      ,TARGET.[CodiceStatoVendita]                           =SOURCE.[CodiceStatoVendita]
      ,TARGET.[DescrizioneStatoVendita]                      =SOURCE.[DescrizioneStatoVendita]
      ,TARGET.[TipoVendita]                                  =SOURCE.[TipoVendita]
      ,TARGET.[StatoCancellazione]                           =SOURCE.[StatoCancellazione]
      ,TARGET.[DataSpedizioneOrdineVendita]                  =SOURCE.[DataSpedizioneOrdineVendita]
      ,TARGET.[DataOrdineVendita]                            =SOURCE.[DataOrdineVendita]
      ,TARGET.[DataDocumentoOrdineVendita]                   =SOURCE.[DataDocumentoOrdineVendita]
      ,TARGET.[DataRegistrazioneOrdineVendita]               =SOURCE.[DataRegistrazioneOrdineVendita]
      ,TARGET.[DataPianificataSpedizione]                    =SOURCE.[DataPianificataSpedizione]
      ,TARGET.[DataConsegnaRichiesta]                        =SOURCE.[DataConsegnaRichiesta]
      ,TARGET.[CodicePagamento]                              =SOURCE.[CodicePagamento]
      ,TARGET.[MetodoPagamento]                              =SOURCE.[MetodoPagamento]
      ,TARGET.[VATRegistrationNumber]                        =SOURCE.[VATRegistrationNumber]
      ,TARGET.[Importo Lordo In Valuta]                      =SOURCE.[Importo Lordo In Valuta]
      ,TARGET.[Importo Sconto In Valuta]                     =SOURCE.[Importo Sconto In Valuta]
      ,TARGET.[Importo Sconto Commerciale In Valuta]         =SOURCE.[Importo Sconto Commerciale In Valuta]
      ,TARGET.[Importo Sconto Finanziario In Valuta]         =SOURCE.[Importo Sconto Finanziario In Valuta]
      ,TARGET.[Importo IVA In Valuta]                        =SOURCE.[Importo IVA In Valuta]
      ,TARGET.[Importo Netto In Valuta]                      =SOURCE.[Importo Netto In Valuta]
      ,TARGET.[Importo Spedito Non Fatturato]                =SOURCE.[Importo Spedito Non Fatturato]
      ,TARGET.[Importo Lordo Spedito In Valuta]              =SOURCE.[Importo Lordo Spedito In Valuta]
      ,TARGET.[Importo Netto Spedito In Valuta]              =SOURCE.[Importo Netto Spedito In Valuta]
      ,TARGET.[M_Quantità]                                   =SOURCE.[M_Quantità]
      ,TARGET.[M_QuantitàSpeditaNonFatturata]                =SOURCE.[M_QuantitàSpeditaNonFatturata]
      ,TARGET.[M_QuantitàSpedita]                            =SOURCE.[M_QuantitàSpedita]
      ,TARGET.[M_QuantitàDaSpedire]                          =SOURCE.[M_QuantitàDaSpedire]
      ,TARGET.[Importo Lordo Euro]                           =SOURCE.[Importo Lordo Euro]
      ,TARGET.[Importo Sconto Euro]                          =SOURCE.[Importo Sconto Euro]
      ,TARGET.[Importo IVA Euro]                             =SOURCE.[Importo IVA Euro]
      ,TARGET.[Importo Netto Euro]                           =SOURCE.[Importo Netto Euro]
      ,TARGET.[Importo Sconto Commerciale Euro]              =SOURCE.[Importo Sconto Commerciale Euro]
      ,TARGET.[Importo Sconto Finanziario Euro]              =SOURCE.[Importo Sconto Finanziario Euro]
      ,TARGET.[Importo Lordo Spedito Euro]                   =SOURCE.[Importo Lordo Spedito Euro]
      ,TARGET.[Importo Netto Spedito Euro]                   =SOURCE.[Importo Netto Spedito Euro]
      ,TARGET.[Importo Netto da Spedire Euro]                =SOURCE.[Importo Netto da Spedire Euro]
      ,TARGET.[Tasso di Cambio]                              =SOURCE.[Tasso di Cambio]
      ,TARGET.[LocationKey_CLIENTE]                          =SOURCE.[LocationKey_CLIENTE]
      ,TARGET.[Transfer-to Location]                         =SOURCE.[Transfer-to Location]
      ,TARGET.[Provvigioni Agente]                           =SOURCE.[Provvigioni Agente]
      ,TARGET.[Provvigioni Agente Euro]                      =SOURCE.[Provvigioni Agente Euro] 
,TARGET.[Magento Coupon code] = SOURCE.[Magento Coupon code]
	  
	  WHEN NOT MATCHED
	  THEN INSERT (
	
	  [CompanyKey]
      ,[ArticoloKey]
      ,[MagazzinoKey]
      ,[M_Quantità]
      ,[TipoDocumento]
      ,[DocumentoKey]
      ,[Importo Lordo In Valuta]
      ,[Importo Sconto In Valuta]
      ,[Importo IVA In Valuta]
      ,[Importo Netto In Valuta]
      ,[Importo Lordo Euro]
      ,[Importo Sconto Euro]
      ,[Importo IVA Euro]
      ,[Importo Netto Euro]
      ,[OrdineVenditaKey]
      ,[AgenteKey]
      ,[ClienteKey]
      ,[NumeroDocumento]
      ,[OrdineVenditaTestata]
      ,[OrdineVenditaNumeroRiga]
      ,[StatusRiga]
      ,[DataSpedizioneOrdineVendita]
      ,[DataOrdineVendita]
      ,[DataDocumentoOrdineVendita]
      ,[StagioneKey]
      ,[UnitàDiMisuraKey]
      ,[CanaleKey]
      ,[SubcaneleKey]
      ,[Marchio]
      ,[DescrizioneTipoOrdine]
      ,[CodiceStatoVendita]
      ,[DescrizioneStatoVendita]
      ,[TipoVendita]
      ,[Importo Sconto Commerciale In Valuta]
      ,[Importo Sconto Finanziario In Valuta]
      ,[Importo Sconto Commerciale Euro]
      ,[Importo Sconto Finanziario Euro]
      ,[StatoCancellazione]
      ,[Tasso di Cambio]
      ,[CodicePagamento]
      ,[MetodoPagamento]
      ,[VATRegistrationNumber]
      ,[CodiceTipoOrdineKey]
      ,[M_QuantitàSpedita]
      ,[M_QuantitàDaSpedire]
      ,[DataRegistrazioneOrdineVendita]
      ,[Importo Lordo Spedito In Valuta]
      ,[Importo Netto Spedito In Valuta]
      ,[Importo Lordo Spedito Euro]
      ,[Importo Netto Spedito Euro]
      ,[Zonakey]
      ,[DataPianificataSpedizione]
      ,[StagioneListinoKey]
      ,[ZonaAgenteKey]
      ,[M_QuantitàSpeditaNonFatturata]
      ,[Importo Spedito Non Fatturato]
      ,[DataConsegnaRichiesta]
      ,[Importo Netto da Spedire Euro]
      ,[FilialeKey]
      ,[LocationKey_CLIENTE]
      ,[Transfer-to Location]
      ,[Rif Ordine Cliente]
      ,[Provvigioni Agente]
      ,[Provvigioni Agente Euro]
      ,[Magento Coupon code]
	  )
	  VALUES (
	
	   [CompanyKey]
      ,[ArticoloKey]
      ,[MagazzinoKey]
      ,[M_Quantità]
      ,[TipoDocumento]
      ,[DocumentoKey]
      ,[Importo Lordo In Valuta]
      ,[Importo Sconto In Valuta]
      ,[Importo IVA In Valuta]
      ,[Importo Netto In Valuta]
      ,[Importo Lordo Euro]
      ,[Importo Sconto Euro]
      ,[Importo IVA Euro]
      ,[Importo Netto Euro]
      ,[OrdineVenditaKey]
      ,[AgenteKey]
      ,[ClienteKey]
      ,[NumeroDocumento]
      ,[OrdineVenditaTestata]
      ,[OrdineVenditaNumeroRiga]
      ,[StatusRiga]
      ,[DataSpedizioneOrdineVendita]
      ,[DataOrdineVendita]
      ,[DataDocumentoOrdineVendita]
      ,[StagioneKey]
      ,[UnitàDiMisuraKey]
      ,[CanaleKey]
      ,[SubcaneleKey]
      ,[Marchio]
      ,[DescrizioneTipoOrdine]
      ,[CodiceStatoVendita]
      ,[DescrizioneStatoVendita]
      ,[TipoVendita]
      ,[Importo Sconto Commerciale In Valuta]
      ,[Importo Sconto Finanziario In Valuta]
      ,[Importo Sconto Commerciale Euro]
      ,[Importo Sconto Finanziario Euro]
      ,[StatoCancellazione]
      ,[Tasso di Cambio]
      ,[CodicePagamento]
      ,[MetodoPagamento]
      ,[VATRegistrationNumber]
      ,[CodiceTipoOrdineKey]
      ,[M_QuantitàSpedita]
      ,[M_QuantitàDaSpedire]
      ,[DataRegistrazioneOrdineVendita]
      ,[Importo Lordo Spedito In Valuta]
      ,[Importo Netto Spedito In Valuta]
      ,[Importo Lordo Spedito Euro]
      ,[Importo Netto Spedito Euro]
      ,[Zonakey]
      ,[DataPianificataSpedizione]
      ,[StagioneListinoKey]
      ,[ZonaAgenteKey]
      ,[M_QuantitàSpeditaNonFatturata]
      ,[Importo Spedito Non Fatturato]
      ,[DataConsegnaRichiesta]
      ,[Importo Netto da Spedire Euro]
      ,[FilialeKey]
      ,[LocationKey_CLIENTE]
      ,[Transfer-to Location]
      ,[Rif Ordine Cliente]
      ,[Provvigioni Agente]
      ,[Provvigioni Agente Euro]
      ,[Magento Coupon code]
	  );</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{6E9FB66A-1B1B-4800-A3BE-06A2C2D5482A}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;MERGE [BI_Model_DWH].[dbo].[FactPrecarico] AS TARGET USING (&#xA;&#xA;SELECT [MagazzinoKey]&#xA;      ,[FornitoreKey]&#xA;      ,[ArticoloKey]&#xA;      ,[UnitàdiMisuraKey]&#xA;      ,[StagioneKey]&#xA;      ,[OrdineAcquistoKey]&#xA;      ,[Posting Date]&#xA;      ,[Document Date]&#xA;      ,[Document Type]&#xA;      ,[Document No_]&#xA;      ,[Description]&#xA;      ,[Quantity]&#xA;      ,[Qty_ per Unit of Measure]&#xA;      ,[Variable Group 01]&#xA;      ,[Variable Code 01]&#xA;      ,[Variable Group 02]&#xA;      ,[Variable Code 02]&#xA;      ,[Model Code]&#xA;      ,[Collection Code]&#xA;      ,[Line Code]&#xA;      ,[Vendor Order No_ LTC Logs]&#xA;      ,[Line No_]&#xA;      ,[Type]&#xA;      ,[No_]&#xA;      ,[Description 2]&#xA;      ,[Unit of Measure]&#xA;      ,[Outstanding Quantity]&#xA;      ,[Qty_ to Receive]&#xA;      ,[Quantity Received]&#xA;      ,[Bolla]&#xA;      ,[RigaBolla]&#xA;      ,[Purchase Order Line No_]&#xA;      ,[Completely Received]&#xA;      ,[Return Qty_ to Ship]&#xA;      ,[Return Qty_ Shipped]&#xA;      ,[Line Assigned to LTC Logs]&#xA;      ,[Line Escaped from LTC Logs]&#xA;      ,[Blocked for Receipt]&#xA;      ,[Quantity in Receipt]&#xA;      ,[Blocked from UserID]&#xA;      ,[Input Vendor Order No_ Logs]&#xA;      ,[First Date Order Sended]&#xA;      ,[Last Date Order Received]&#xA;      ,[Operation Occurred Date]&#xA;      ,[Assortment Variable Group]&#xA;      ,[Constant Assortment Var_Grp_]&#xA;      ,[Constant Variable Code]&#xA;      ,[Assortment Code]&#xA;      ,[Original Line No_]&#xA;      ,[Line Type]&#xA;      ,[No_ of Pairs]&#xA;      ,[Trademark Code]&#xA;      ,[Original Quantity]&#xA;      ,[Company]&#xA;  FROM [BI_Model_Stage].[stg].[vFactPrecarico] fct&#xA;  inner join ( SELECT MAX([MaxTimestamp]) as maxtimestamp from [BI_Model_Stage].cfg.Config_Delta) cfg&#xA;  on fct.timestamp &gt; cfg.maxtimestamp&#xA;     ) AS SOURCE &#xA;  ON SOURCE.[Document No_]= TARGET.[Document No_]&#xA;  AND SOURCE.[Line No_]= TARGET.[Line No_]&#xA;  AND SOURCE.[Company]= TARGET.[Company]&#xA;  AND SOURCE.[Vendor Order No_ LTC Logs] = TARGET.[Vendor Order No_ LTC Logs]&#xA;  AND SOURCE.[Document Type] = TARGET.[Document Type]&#xA;  &#xA;  WHEN MATCHED&#xA;  THEN UPDATE SET &#xA;&#x9;          &#xA;&#x9;   TARGET.[MagazzinoKey]                                    = SOURCE.[MagazzinoKey]                               &#xA;      ,TARGET.[FornitoreKey]                                    = SOURCE.[FornitoreKey]                               &#xA;      ,TARGET.[ArticoloKey]                                     = SOURCE.[ArticoloKey]                                &#xA;      ,TARGET.[UnitàdiMisuraKey]                                = SOURCE.[UnitàdiMisuraKey]                           &#xA;      ,TARGET.[StagioneKey]                                     = SOURCE.[StagioneKey]                                &#xA;      ,TARGET.[OrdineAcquistoKey]                               = SOURCE.[OrdineAcquistoKey]                          &#xA;      ,TARGET.[Posting Date]                                    = SOURCE.[Posting Date]                               &#xA;      ,TARGET.[Document Date]                                   = SOURCE.[Document Date]                                                                                    &#xA;      ,TARGET.[Description]                                     = SOURCE.[Description]                                &#xA;      ,TARGET.[Quantity]                                        = SOURCE.[Quantity]                                   &#xA;      ,TARGET.[Qty_ per Unit of Measure]                        = SOURCE.[Qty_ per Unit of Measure]                   &#xA;      ,TARGET.[Variable Group 01]                               = SOURCE.[Variable Group 01]                          &#xA;      ,TARGET.[Variable Code 01]                                = SOURCE.[Variable Code 01]                           &#xA;      ,TARGET.[Variable Group 02]                               = SOURCE.[Variable Group 02]                          &#xA;      ,TARGET.[Variable Code 02]                                = SOURCE.[Variable Code 02]                           &#xA;      ,TARGET.[Model Code]                                      = SOURCE.[Model Code]                                 &#xA;      ,TARGET.[Collection Code]                                 = SOURCE.[Collection Code]                            &#xA;      ,TARGET.[Line Code]                                       = SOURCE.[Line Code]                                                                                &#xA;      ,TARGET.[Type]                                            = SOURCE.[Type]                                       &#xA;      ,TARGET.[No_]                                             = SOURCE.[No_]                                        &#xA;      ,TARGET.[Description 2]                                   = SOURCE.[Description 2]                              &#xA;      ,TARGET.[Unit of Measure]                                 = SOURCE.[Unit of Measure]                            &#xA;      ,TARGET.[Outstanding Quantity]                            = SOURCE.[Outstanding Quantity]                       &#xA;      ,TARGET.[Qty_ to Receive]                                 = SOURCE.[Qty_ to Receive]                            &#xA;      ,TARGET.[Quantity Received]                               = SOURCE.[Quantity Received]                          &#xA;      ,TARGET.[Bolla]                                           = SOURCE.[Bolla]                                      &#xA;      ,TARGET.[RigaBolla]                                       = SOURCE.[RigaBolla]                                  &#xA;      ,TARGET.[Purchase Order Line No_]                         = SOURCE.[Purchase Order Line No_]                    &#xA;      ,TARGET.[Completely Received]                             = SOURCE.[Completely Received]                        &#xA;      ,TARGET.[Return Qty_ to Ship]                             = SOURCE.[Return Qty_ to Ship]                        &#xA;      ,TARGET.[Return Qty_ Shipped]                             = SOURCE.[Return Qty_ Shipped]                        &#xA;      ,TARGET.[Line Assigned to LTC Logs]                       = SOURCE.[Line Assigned to LTC Logs]                  &#xA;      ,TARGET.[Line Escaped from LTC Logs]                      = SOURCE.[Line Escaped from LTC Logs]                 &#xA;      ,TARGET.[Blocked for Receipt]                             = SOURCE.[Blocked for Receipt]                        &#xA;      ,TARGET.[Quantity in Receipt]                             = SOURCE.[Quantity in Receipt]                        &#xA;      ,TARGET.[Blocked from UserID]                             = SOURCE.[Blocked from UserID]                        &#xA;      ,TARGET.[Input Vendor Order No_ Logs]                     = SOURCE.[Input Vendor Order No_ Logs]                &#xA;      ,TARGET.[First Date Order Sended]                         = SOURCE.[First Date Order Sended]                    &#xA;      ,TARGET.[Last Date Order Received]                        = SOURCE.[Last Date Order Received]                   &#xA;      ,TARGET.[Operation Occurred Date]                         = SOURCE.[Operation Occurred Date]                    &#xA;      ,TARGET.[Assortment Variable Group]                       = SOURCE.[Assortment Variable Group]                  &#xA;      ,TARGET.[Constant Assortment Var_Grp_]                    = SOURCE.[Constant Assortment Var_Grp_]               &#xA;      ,TARGET.[Constant Variable Code]                          = SOURCE.[Constant Variable Code]                     &#xA;      ,TARGET.[Assortment Code]                                 = SOURCE.[Assortment Code]                            &#xA;      ,TARGET.[Original Line No_]                               = SOURCE.[Original Line No_]                          &#xA;      ,TARGET.[Line Type]                                       = SOURCE.[Line Type]                                  &#xA;      ,TARGET.[No_ of Pairs]                                    = SOURCE.[No_ of Pairs]                               &#xA;      ,TARGET.[Trademark Code]                                  = SOURCE.[Trademark Code]                             &#xA;      ,TARGET.[Original Quantity]                               = SOURCE.[Original Quantity]                          &#xA;                                  &#xA;&#x9;  WHEN NOT MATCHED&#xA;&#x9;  THEN INSERT (&#xA;&#x9; &#xA;&#x9;  [MagazzinoKey]&#xA;      ,[FornitoreKey]&#xA;      ,[ArticoloKey]&#xA;      ,[UnitàdiMisuraKey]&#xA;      ,[StagioneKey]&#xA;      ,[OrdineAcquistoKey]&#xA;      ,[Posting Date]&#xA;      ,[Document Date]&#xA;      ,[Document Type]&#xA;      ,[Document No_]&#xA;      ,[Description]&#xA;      ,[Quantity]&#xA;      ,[Qty_ per Unit of Measure]&#xA;      ,[Variable Group 01]&#xA;      ,[Variable Code 01]&#xA;      ,[Variable Group 02]&#xA;      ,[Variable Code 02]&#xA;      ,[Model Code]&#xA;      ,[Collection Code]&#xA;      ,[Line Code]&#xA;      ,[Vendor Order No_ LTC Logs]&#xA;      ,[Line No_]&#xA;      ,[Type]&#xA;      ,[No_]&#xA;      ,[Description 2]&#xA;      ,[Unit of Measure]&#xA;      ,[Outstanding Quantity]&#xA;      ,[Qty_ to Receive]&#xA;      ,[Quantity Received]&#xA;      ,[Bolla]&#xA;      ,[RigaBolla]&#xA;      ,[Purchase Order Line No_]&#xA;      ,[Completely Received]&#xA;      ,[Return Qty_ to Ship]&#xA;      ,[Return Qty_ Shipped]&#xA;      ,[Line Assigned to LTC Logs]&#xA;      ,[Line Escaped from LTC Logs]&#xA;      ,[Blocked for Receipt]&#xA;      ,[Quantity in Receipt]&#xA;      ,[Blocked from UserID]&#xA;      ,[Input Vendor Order No_ Logs]&#xA;      ,[First Date Order Sended]&#xA;      ,[Last Date Order Received]&#xA;      ,[Operation Occurred Date]&#xA;      ,[Assortment Variable Group]&#xA;      ,[Constant Assortment Var_Grp_]&#xA;      ,[Constant Variable Code]&#xA;      ,[Assortment Code]&#xA;      ,[Original Line No_]&#xA;      ,[Line Type]&#xA;      ,[No_ of Pairs]&#xA;      ,[Trademark Code]&#xA;      ,[Original Quantity]&#xA;      ,[Company]&#xA;&#x9;  )&#xA;&#x9;  VALUES (&#xA;&#x9;&#xA;&#x9;   [MagazzinoKey]&#xA;      ,[FornitoreKey]&#xA;      ,[ArticoloKey]&#xA;      ,[UnitàdiMisuraKey]&#xA;      ,[StagioneKey]&#xA;      ,[OrdineAcquistoKey]&#xA;      ,[Posting Date]&#xA;      ,[Document Date]&#xA;      ,[Document Type]&#xA;      ,[Document No_]&#xA;      ,[Description]&#xA;      ,[Quantity]&#xA;      ,[Qty_ per Unit of Measure]&#xA;      ,[Variable Group 01]&#xA;      ,[Variable Code 01]&#xA;      ,[Variable Group 02]&#xA;      ,[Variable Code 02]&#xA;      ,[Model Code]&#xA;      ,[Collection Code]&#xA;      ,[Line Code]&#xA;      ,[Vendor Order No_ LTC Logs]&#xA;      ,[Line No_]&#xA;      ,[Type]&#xA;      ,[No_]&#xA;      ,[Description 2]&#xA;      ,[Unit of Measure]&#xA;      ,[Outstanding Quantity]&#xA;      ,[Qty_ to Receive]&#xA;      ,[Quantity Received]&#xA;      ,[Bolla]&#xA;      ,[RigaBolla]&#xA;      ,[Purchase Order Line No_]&#xA;      ,[Completely Received]&#xA;      ,[Return Qty_ to Ship]&#xA;      ,[Return Qty_ Shipped]&#xA;      ,[Line Assigned to LTC Logs]&#xA;      ,[Line Escaped from LTC Logs]&#xA;      ,[Blocked for Receipt]&#xA;      ,[Quantity in Receipt]&#xA;      ,[Blocked from UserID]&#xA;      ,[Input Vendor Order No_ Logs]&#xA;      ,[First Date Order Sended]&#xA;      ,[Last Date Order Received]&#xA;      ,[Operation Occurred Date]&#xA;      ,[Assortment Variable Group]&#xA;      ,[Constant Assortment Var_Grp_]&#xA;      ,[Constant Variable Code]&#xA;      ,[Assortment Code]&#xA;      ,[Original Line No_]&#xA;      ,[Line Type]&#xA;      ,[No_ of Pairs]&#xA;      ,[Trademark Code]&#xA;      ,[Original Quantity]&#xA;      ,[Company]&#xA;&#x9;  );&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="Populate_FactPrecarico">
      <DTS:VariableValue
        DTS:DataType="8">MERGE [BI_Model_DWH].[dbo].[FactPrecarico] AS TARGET USING (

SELECT [MagazzinoKey]
      ,[FornitoreKey]
      ,[ArticoloKey]
      ,[UnitàdiMisuraKey]
      ,[StagioneKey]
      ,[OrdineAcquistoKey]
      ,[Posting Date]
      ,[Document Date]
      ,[Document Type]
      ,[Document No_]
      ,[Description]
      ,[Quantity]
      ,[Qty_ per Unit of Measure]
      ,[Variable Group 01]
      ,[Variable Code 01]
      ,[Variable Group 02]
      ,[Variable Code 02]
      ,[Model Code]
      ,[Collection Code]
      ,[Line Code]
      ,[Vendor Order No_ LTC Logs]
      ,[Line No_]
      ,[Type]
      ,[No_]
      ,[Description 2]
      ,[Unit of Measure]
      ,[Outstanding Quantity]
      ,[Qty_ to Receive]
      ,[Quantity Received]
      ,[Bolla]
      ,[RigaBolla]
      ,[Purchase Order Line No_]
      ,[Completely Received]
      ,[Return Qty_ to Ship]
      ,[Return Qty_ Shipped]
      ,[Line Assigned to LTC Logs]
      ,[Line Escaped from LTC Logs]
      ,[Blocked for Receipt]
      ,[Quantity in Receipt]
      ,[Blocked from UserID]
      ,[Input Vendor Order No_ Logs]
      ,[First Date Order Sended]
      ,[Last Date Order Received]
      ,[Operation Occurred Date]
      ,[Assortment Variable Group]
      ,[Constant Assortment Var_Grp_]
      ,[Constant Variable Code]
      ,[Assortment Code]
      ,[Original Line No_]
      ,[Line Type]
      ,[No_ of Pairs]
      ,[Trademark Code]
      ,[Original Quantity]
      ,[Company]
  FROM [BI_Model_Stage].[stg].[vFactPrecarico] fct
  inner join ( SELECT MAX([MaxTimestamp]) as maxtimestamp from [BI_Model_Stage].cfg.Config_Delta) cfg
  on fct.timestamp &gt; cfg.maxtimestamp
     ) AS SOURCE 
  ON SOURCE.[Document No_]= TARGET.[Document No_]
  AND SOURCE.[Line No_]= TARGET.[Line No_]
  AND SOURCE.[Company]= TARGET.[Company]
  AND SOURCE.[Vendor Order No_ LTC Logs] = TARGET.[Vendor Order No_ LTC Logs]
  AND SOURCE.[Document Type] = TARGET.[Document Type]
  
  WHEN MATCHED
  THEN UPDATE SET 
	          
	   TARGET.[MagazzinoKey]                                    = SOURCE.[MagazzinoKey]                               
      ,TARGET.[FornitoreKey]                                    = SOURCE.[FornitoreKey]                               
      ,TARGET.[ArticoloKey]                                     = SOURCE.[ArticoloKey]                                
      ,TARGET.[UnitàdiMisuraKey]                                = SOURCE.[UnitàdiMisuraKey]                           
      ,TARGET.[StagioneKey]                                     = SOURCE.[StagioneKey]                                
      ,TARGET.[OrdineAcquistoKey]                               = SOURCE.[OrdineAcquistoKey]                          
      ,TARGET.[Posting Date]                                    = SOURCE.[Posting Date]                               
      ,TARGET.[Document Date]                                   = SOURCE.[Document Date]                                                                                    
      ,TARGET.[Description]                                     = SOURCE.[Description]                                
      ,TARGET.[Quantity]                                        = SOURCE.[Quantity]                                   
      ,TARGET.[Qty_ per Unit of Measure]                        = SOURCE.[Qty_ per Unit of Measure]                   
      ,TARGET.[Variable Group 01]                               = SOURCE.[Variable Group 01]                          
      ,TARGET.[Variable Code 01]                                = SOURCE.[Variable Code 01]                           
      ,TARGET.[Variable Group 02]                               = SOURCE.[Variable Group 02]                          
      ,TARGET.[Variable Code 02]                                = SOURCE.[Variable Code 02]                           
      ,TARGET.[Model Code]                                      = SOURCE.[Model Code]                                 
      ,TARGET.[Collection Code]                                 = SOURCE.[Collection Code]                            
      ,TARGET.[Line Code]                                       = SOURCE.[Line Code]                                                                                
      ,TARGET.[Type]                                            = SOURCE.[Type]                                       
      ,TARGET.[No_]                                             = SOURCE.[No_]                                        
      ,TARGET.[Description 2]                                   = SOURCE.[Description 2]                              
      ,TARGET.[Unit of Measure]                                 = SOURCE.[Unit of Measure]                            
      ,TARGET.[Outstanding Quantity]                            = SOURCE.[Outstanding Quantity]                       
      ,TARGET.[Qty_ to Receive]                                 = SOURCE.[Qty_ to Receive]                            
      ,TARGET.[Quantity Received]                               = SOURCE.[Quantity Received]                          
      ,TARGET.[Bolla]                                           = SOURCE.[Bolla]                                      
      ,TARGET.[RigaBolla]                                       = SOURCE.[RigaBolla]                                  
      ,TARGET.[Purchase Order Line No_]                         = SOURCE.[Purchase Order Line No_]                    
      ,TARGET.[Completely Received]                             = SOURCE.[Completely Received]                        
      ,TARGET.[Return Qty_ to Ship]                             = SOURCE.[Return Qty_ to Ship]                        
      ,TARGET.[Return Qty_ Shipped]                             = SOURCE.[Return Qty_ Shipped]                        
      ,TARGET.[Line Assigned to LTC Logs]                       = SOURCE.[Line Assigned to LTC Logs]                  
      ,TARGET.[Line Escaped from LTC Logs]                      = SOURCE.[Line Escaped from LTC Logs]                 
      ,TARGET.[Blocked for Receipt]                             = SOURCE.[Blocked for Receipt]                        
      ,TARGET.[Quantity in Receipt]                             = SOURCE.[Quantity in Receipt]                        
      ,TARGET.[Blocked from UserID]                             = SOURCE.[Blocked from UserID]                        
      ,TARGET.[Input Vendor Order No_ Logs]                     = SOURCE.[Input Vendor Order No_ Logs]                
      ,TARGET.[First Date Order Sended]                         = SOURCE.[First Date Order Sended]                    
      ,TARGET.[Last Date Order Received]                        = SOURCE.[Last Date Order Received]                   
      ,TARGET.[Operation Occurred Date]                         = SOURCE.[Operation Occurred Date]                    
      ,TARGET.[Assortment Variable Group]                       = SOURCE.[Assortment Variable Group]                  
      ,TARGET.[Constant Assortment Var_Grp_]                    = SOURCE.[Constant Assortment Var_Grp_]               
      ,TARGET.[Constant Variable Code]                          = SOURCE.[Constant Variable Code]                     
      ,TARGET.[Assortment Code]                                 = SOURCE.[Assortment Code]                            
      ,TARGET.[Original Line No_]                               = SOURCE.[Original Line No_]                          
      ,TARGET.[Line Type]                                       = SOURCE.[Line Type]                                  
      ,TARGET.[No_ of Pairs]                                    = SOURCE.[No_ of Pairs]                               
      ,TARGET.[Trademark Code]                                  = SOURCE.[Trademark Code]                             
      ,TARGET.[Original Quantity]                               = SOURCE.[Original Quantity]                          
                                  
	  WHEN NOT MATCHED
	  THEN INSERT (
	 
	  [MagazzinoKey]
      ,[FornitoreKey]
      ,[ArticoloKey]
      ,[UnitàdiMisuraKey]
      ,[StagioneKey]
      ,[OrdineAcquistoKey]
      ,[Posting Date]
      ,[Document Date]
      ,[Document Type]
      ,[Document No_]
      ,[Description]
      ,[Quantity]
      ,[Qty_ per Unit of Measure]
      ,[Variable Group 01]
      ,[Variable Code 01]
      ,[Variable Group 02]
      ,[Variable Code 02]
      ,[Model Code]
      ,[Collection Code]
      ,[Line Code]
      ,[Vendor Order No_ LTC Logs]
      ,[Line No_]
      ,[Type]
      ,[No_]
      ,[Description 2]
      ,[Unit of Measure]
      ,[Outstanding Quantity]
      ,[Qty_ to Receive]
      ,[Quantity Received]
      ,[Bolla]
      ,[RigaBolla]
      ,[Purchase Order Line No_]
      ,[Completely Received]
      ,[Return Qty_ to Ship]
      ,[Return Qty_ Shipped]
      ,[Line Assigned to LTC Logs]
      ,[Line Escaped from LTC Logs]
      ,[Blocked for Receipt]
      ,[Quantity in Receipt]
      ,[Blocked from UserID]
      ,[Input Vendor Order No_ Logs]
      ,[First Date Order Sended]
      ,[Last Date Order Received]
      ,[Operation Occurred Date]
      ,[Assortment Variable Group]
      ,[Constant Assortment Var_Grp_]
      ,[Constant Variable Code]
      ,[Assortment Code]
      ,[Original Line No_]
      ,[Line Type]
      ,[No_ of Pairs]
      ,[Trademark Code]
      ,[Original Quantity]
      ,[Company]
	  )
	  VALUES (
	
	   [MagazzinoKey]
      ,[FornitoreKey]
      ,[ArticoloKey]
      ,[UnitàdiMisuraKey]
      ,[StagioneKey]
      ,[OrdineAcquistoKey]
      ,[Posting Date]
      ,[Document Date]
      ,[Document Type]
      ,[Document No_]
      ,[Description]
      ,[Quantity]
      ,[Qty_ per Unit of Measure]
      ,[Variable Group 01]
      ,[Variable Code 01]
      ,[Variable Group 02]
      ,[Variable Code 02]
      ,[Model Code]
      ,[Collection Code]
      ,[Line Code]
      ,[Vendor Order No_ LTC Logs]
      ,[Line No_]
      ,[Type]
      ,[No_]
      ,[Description 2]
      ,[Unit of Measure]
      ,[Outstanding Quantity]
      ,[Qty_ to Receive]
      ,[Quantity Received]
      ,[Bolla]
      ,[RigaBolla]
      ,[Purchase Order Line No_]
      ,[Completely Received]
      ,[Return Qty_ to Ship]
      ,[Return Qty_ Shipped]
      ,[Line Assigned to LTC Logs]
      ,[Line Escaped from LTC Logs]
      ,[Blocked for Receipt]
      ,[Quantity in Receipt]
      ,[Blocked from UserID]
      ,[Input Vendor Order No_ Logs]
      ,[First Date Order Sended]
      ,[Last Date Order Received]
      ,[Operation Occurred Date]
      ,[Assortment Variable Group]
      ,[Constant Assortment Var_Grp_]
      ,[Constant Variable Code]
      ,[Assortment Code]
      ,[Original Line No_]
      ,[Line Type]
      ,[No_ of Pairs]
      ,[Trademark Code]
      ,[Original Quantity]
      ,[Company]
	  );</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{F4ECAD3C-6DC4-401B-B239-B62CFC07AABD}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;MERGE [BI_Model_DWH].[dbo].[FactResi] AS TARGET USING (&#xA;&#xA;SELECT [ResoSpedizioniKey]&#xA;      ,[Rif Ordine Cliente]&#xA;      ,[CompanyKey]&#xA;      ,[ValutaKey]&#xA;      ,[AgenteKey]&#xA;      ,[ClienteKey]&#xA;      ,[ArticoloKey]&#xA;      ,[MagazzinoKey]&#xA;      ,[StagioneKey]&#xA;      ,[FilialeKey]&#xA;      ,[Zonakey]&#xA;      ,[CanaleKey]&#xA;      ,[SubcaneleKey]&#xA;      ,[Marchio]&#xA;      ,[CodiceStatoVendita]&#xA;      ,[CodiceCategoriaArticolo]&#xA;      ,[TestataResoSpedizione]&#xA;      ,[RigaResoSpedizione]&#xA;      ,[NumeroOrdineReso]&#xA;      ,[NumeroRigaOrdineReso]&#xA;      ,[NumeroOrdineAcquisto]&#xA;      ,[NumeroRigaOrdineAcquisto]&#xA;      ,[Tipo]&#xA;      ,[CodiceTipoOrdine]&#xA;      ,[DescrizioneTipoOrdine]&#xA;      ,[DataOrdine]&#xA;      ,[DataPubblicazione]&#xA;      ,[NomeClienteSpedizione]&#xA;      ,[IndirizzoSpedizione]&#xA;      ,[CittàSpedizione]&#xA;      ,[M_Quantità]&#xA;      ,[Importo Lordo In Valuta]&#xA;      ,[Importo Sconto In Valuta]&#xA;      ,[Importo IVA In Valuta]&#xA;      ,[Importo Lordo Euro]&#xA;      ,[Importo Sconto Euro]&#xA;      ,[Importo IVA Euro]&#xA;      ,[Tasso di Cambio]&#xA;      ,[LocationKey_CLIENTE]&#xA;  FROM [BI_Model_Stage].[stg].[vFactResi] fct&#xA;  inner join ( SELECT MAX([MaxTimestamp]) as maxtimestamp from [BI_Model_Stage].cfg.Config_Delta) cfg&#xA;  on fct.timestamp &gt; cfg.maxtimestamp&#xA;     ) AS SOURCE &#xA;  ON SOURCE.[ResoSpedizioniKey]= TARGET.[ResoSpedizioniKey]&#xA;  &#xA;  &#xA;  WHEN MATCHED&#xA;  THEN UPDATE SET &#xA;&#xA;      TARGET.[Rif Ordine Cliente]                    = SOURCE.[Rif Ordine Cliente]           &#xA;               &#xA;      ,TARGET.[ValutaKey]                             = SOURCE.[ValutaKey]                    &#xA;      ,TARGET.[AgenteKey]                             = SOURCE.[AgenteKey]                    &#xA;      ,TARGET.[ClienteKey]                            = SOURCE.[ClienteKey]                   &#xA;      ,TARGET.[ArticoloKey]                           = SOURCE.[ArticoloKey]                  &#xA;      ,TARGET.[MagazzinoKey]                          = SOURCE.[MagazzinoKey]                 &#xA;      ,TARGET.[StagioneKey]                           = SOURCE.[StagioneKey]                  &#xA;      ,TARGET.[FilialeKey]                            = SOURCE.[FilialeKey]                   &#xA;      ,TARGET.[Zonakey]                               = SOURCE.[Zonakey]                      &#xA;      ,TARGET.[CanaleKey]                             = SOURCE.[CanaleKey]                    &#xA;      ,TARGET.[SubcaneleKey]                          = SOURCE.[SubcaneleKey]                 &#xA;                   &#xA;      ,TARGET.[CodiceStatoVendita]                    = SOURCE.[CodiceStatoVendita]           &#xA;      ,TARGET.[CodiceCategoriaArticolo]               = SOURCE.[CodiceCategoriaArticolo]      &#xA;    &#xA;      ,TARGET.[NumeroOrdineReso]                      = SOURCE.[NumeroOrdineReso]             &#xA;      ,TARGET.[NumeroRigaOrdineReso]                  = SOURCE.[NumeroRigaOrdineReso]         &#xA;      ,TARGET.[NumeroOrdineAcquisto]                  = SOURCE.[NumeroOrdineAcquisto]         &#xA;      ,TARGET.[NumeroRigaOrdineAcquisto]              = SOURCE.[NumeroRigaOrdineAcquisto]     &#xA;      ,TARGET.[Tipo]                                  = SOURCE.[Tipo]                         &#xA;      ,TARGET.[CodiceTipoOrdine]                      = SOURCE.[CodiceTipoOrdine]             &#xA;      ,TARGET.[DescrizioneTipoOrdine]                 = SOURCE.[DescrizioneTipoOrdine]        &#xA;      ,TARGET.[DataOrdine]                            = SOURCE.[DataOrdine]                   &#xA;      ,TARGET.[DataPubblicazione]                     = SOURCE.[DataPubblicazione]            &#xA;      ,TARGET.[NomeClienteSpedizione]                 = SOURCE.[NomeClienteSpedizione]        &#xA;      ,TARGET.[IndirizzoSpedizione]                   = SOURCE.[IndirizzoSpedizione]          &#xA;      ,TARGET.[CittàSpedizione]                       = SOURCE.[CittàSpedizione]              &#xA;      ,TARGET.[M_Quantità]                            = SOURCE.[M_Quantità]                   &#xA;      ,TARGET.[Importo Lordo In Valuta]               = SOURCE.[Importo Lordo In Valuta]      &#xA;      ,TARGET.[Importo Sconto In Valuta]              = SOURCE.[Importo Sconto In Valuta]     &#xA;      ,TARGET.[Importo IVA In Valuta]                 = SOURCE.[Importo IVA In Valuta]        &#xA;      ,TARGET.[Importo Lordo Euro]                    = SOURCE.[Importo Lordo Euro]           &#xA;      ,TARGET.[Importo Sconto Euro]                   = SOURCE.[Importo Sconto Euro]          &#xA;      ,TARGET.[Importo IVA Euro]                      = SOURCE.[Importo IVA Euro]             &#xA;      ,TARGET.[Tasso di Cambio]                       = SOURCE.[Tasso di Cambio]              &#xA;      ,TARGET.[LocationKey_CLIENTE]                   = SOURCE.[LocationKey_CLIENTE]          &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; &#xA;&#x9;  WHEN NOT MATCHED                               &#xA;&#x9;  THEN INSERT (                                  &#xA;&#x9;                           &#xA;&#x9;  [ResoSpedizioniKey]&#xA;      ,[Rif Ordine Cliente]&#xA;      ,[CompanyKey]&#xA;      ,[ValutaKey]&#xA;      ,[AgenteKey]&#xA;      ,[ClienteKey]&#xA;      ,[ArticoloKey]&#xA;      ,[MagazzinoKey]&#xA;      ,[StagioneKey]&#xA;      ,[FilialeKey]&#xA;      ,[Zonakey]&#xA;      ,[CanaleKey]&#xA;      ,[SubcaneleKey]&#xA;      ,[Marchio]&#xA;      ,[CodiceStatoVendita]&#xA;      ,[CodiceCategoriaArticolo]&#xA;      ,[TestataResoSpedizione]&#xA;      ,[RigaResoSpedizione]&#xA;      ,[NumeroOrdineReso]&#xA;      ,[NumeroRigaOrdineReso]&#xA;      ,[NumeroOrdineAcquisto]&#xA;      ,[NumeroRigaOrdineAcquisto]&#xA;      ,[Tipo]&#xA;      ,[CodiceTipoOrdine]&#xA;      ,[DescrizioneTipoOrdine]&#xA;      ,[DataOrdine]&#xA;      ,[DataPubblicazione]&#xA;      ,[NomeClienteSpedizione]&#xA;      ,[IndirizzoSpedizione]&#xA;      ,[CittàSpedizione]&#xA;      ,[M_Quantità]&#xA;      ,[Importo Lordo In Valuta]&#xA;      ,[Importo Sconto In Valuta]&#xA;      ,[Importo IVA In Valuta]&#xA;      ,[Importo Lordo Euro]&#xA;      ,[Importo Sconto Euro]&#xA;      ,[Importo IVA Euro]&#xA;      ,[Tasso di Cambio]&#xA;      ,[LocationKey_CLIENTE]                    &#xA;&#x9;  )&#xA;&#x9;  VALUES (&#xA;&#x9;&#xA;&#x9;   [ResoSpedizioniKey]&#xA;      ,[Rif Ordine Cliente]&#xA;      ,[CompanyKey]&#xA;      ,[ValutaKey]&#xA;      ,[AgenteKey]&#xA;      ,[ClienteKey]&#xA;      ,[ArticoloKey]&#xA;      ,[MagazzinoKey]&#xA;      ,[StagioneKey]&#xA;      ,[FilialeKey]&#xA;      ,[Zonakey]&#xA;      ,[CanaleKey]&#xA;      ,[SubcaneleKey]&#xA;      ,[Marchio]&#xA;      ,[CodiceStatoVendita]&#xA;      ,[CodiceCategoriaArticolo]&#xA;      ,[TestataResoSpedizione]&#xA;      ,[RigaResoSpedizione]&#xA;      ,[NumeroOrdineReso]&#xA;      ,[NumeroRigaOrdineReso]&#xA;      ,[NumeroOrdineAcquisto]&#xA;      ,[NumeroRigaOrdineAcquisto]&#xA;      ,[Tipo]&#xA;      ,[CodiceTipoOrdine]&#xA;      ,[DescrizioneTipoOrdine]&#xA;      ,[DataOrdine]&#xA;      ,[DataPubblicazione]&#xA;      ,[NomeClienteSpedizione]&#xA;      ,[IndirizzoSpedizione]&#xA;      ,[CittàSpedizione]&#xA;      ,[M_Quantità]&#xA;      ,[Importo Lordo In Valuta]&#xA;      ,[Importo Sconto In Valuta]&#xA;      ,[Importo IVA In Valuta]&#xA;      ,[Importo Lordo Euro]&#xA;      ,[Importo Sconto Euro]&#xA;      ,[Importo IVA Euro]&#xA;      ,[Tasso di Cambio]&#xA;      ,[LocationKey_CLIENTE]&#xA;&#x9;  );&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="Populate_FactResi">
      <DTS:VariableValue
        DTS:DataType="8">MERGE [BI_Model_DWH].[dbo].[FactResi] AS TARGET USING (

SELECT [ResoSpedizioniKey]
      ,[Rif Ordine Cliente]
      ,[CompanyKey]
      ,[ValutaKey]
      ,[AgenteKey]
      ,[ClienteKey]
      ,[ArticoloKey]
      ,[MagazzinoKey]
      ,[StagioneKey]
      ,[FilialeKey]
      ,[Zonakey]
      ,[CanaleKey]
      ,[SubcaneleKey]
      ,[Marchio]
      ,[CodiceStatoVendita]
      ,[CodiceCategoriaArticolo]
      ,[TestataResoSpedizione]
      ,[RigaResoSpedizione]
      ,[NumeroOrdineReso]
      ,[NumeroRigaOrdineReso]
      ,[NumeroOrdineAcquisto]
      ,[NumeroRigaOrdineAcquisto]
      ,[Tipo]
      ,[CodiceTipoOrdine]
      ,[DescrizioneTipoOrdine]
      ,[DataOrdine]
      ,[DataPubblicazione]
      ,[NomeClienteSpedizione]
      ,[IndirizzoSpedizione]
      ,[CittàSpedizione]
      ,[M_Quantità]
      ,[Importo Lordo In Valuta]
      ,[Importo Sconto In Valuta]
      ,[Importo IVA In Valuta]
      ,[Importo Lordo Euro]
      ,[Importo Sconto Euro]
      ,[Importo IVA Euro]
      ,[Tasso di Cambio]
      ,[LocationKey_CLIENTE]
  FROM [BI_Model_Stage].[stg].[vFactResi] fct
  inner join ( SELECT MAX([MaxTimestamp]) as maxtimestamp from [BI_Model_Stage].cfg.Config_Delta) cfg
  on fct.timestamp &gt; cfg.maxtimestamp
     ) AS SOURCE 
  ON SOURCE.[ResoSpedizioniKey]= TARGET.[ResoSpedizioniKey]
  
  
  WHEN MATCHED
  THEN UPDATE SET 

      TARGET.[Rif Ordine Cliente]                    = SOURCE.[Rif Ordine Cliente]           
               
      ,TARGET.[ValutaKey]                             = SOURCE.[ValutaKey]                    
      ,TARGET.[AgenteKey]                             = SOURCE.[AgenteKey]                    
      ,TARGET.[ClienteKey]                            = SOURCE.[ClienteKey]                   
      ,TARGET.[ArticoloKey]                           = SOURCE.[ArticoloKey]                  
      ,TARGET.[MagazzinoKey]                          = SOURCE.[MagazzinoKey]                 
      ,TARGET.[StagioneKey]                           = SOURCE.[StagioneKey]                  
      ,TARGET.[FilialeKey]                            = SOURCE.[FilialeKey]                   
      ,TARGET.[Zonakey]                               = SOURCE.[Zonakey]                      
      ,TARGET.[CanaleKey]                             = SOURCE.[CanaleKey]                    
      ,TARGET.[SubcaneleKey]                          = SOURCE.[SubcaneleKey]                 
                   
      ,TARGET.[CodiceStatoVendita]                    = SOURCE.[CodiceStatoVendita]           
      ,TARGET.[CodiceCategoriaArticolo]               = SOURCE.[CodiceCategoriaArticolo]      
    
      ,TARGET.[NumeroOrdineReso]                      = SOURCE.[NumeroOrdineReso]             
      ,TARGET.[NumeroRigaOrdineReso]                  = SOURCE.[NumeroRigaOrdineReso]         
      ,TARGET.[NumeroOrdineAcquisto]                  = SOURCE.[NumeroOrdineAcquisto]         
      ,TARGET.[NumeroRigaOrdineAcquisto]              = SOURCE.[NumeroRigaOrdineAcquisto]     
      ,TARGET.[Tipo]                                  = SOURCE.[Tipo]                         
      ,TARGET.[CodiceTipoOrdine]                      = SOURCE.[CodiceTipoOrdine]             
      ,TARGET.[DescrizioneTipoOrdine]                 = SOURCE.[DescrizioneTipoOrdine]        
      ,TARGET.[DataOrdine]                            = SOURCE.[DataOrdine]                   
      ,TARGET.[DataPubblicazione]                     = SOURCE.[DataPubblicazione]            
      ,TARGET.[NomeClienteSpedizione]                 = SOURCE.[NomeClienteSpedizione]        
      ,TARGET.[IndirizzoSpedizione]                   = SOURCE.[IndirizzoSpedizione]          
      ,TARGET.[CittàSpedizione]                       = SOURCE.[CittàSpedizione]              
      ,TARGET.[M_Quantità]                            = SOURCE.[M_Quantità]                   
      ,TARGET.[Importo Lordo In Valuta]               = SOURCE.[Importo Lordo In Valuta]      
      ,TARGET.[Importo Sconto In Valuta]              = SOURCE.[Importo Sconto In Valuta]     
      ,TARGET.[Importo IVA In Valuta]                 = SOURCE.[Importo IVA In Valuta]        
      ,TARGET.[Importo Lordo Euro]                    = SOURCE.[Importo Lordo Euro]           
      ,TARGET.[Importo Sconto Euro]                   = SOURCE.[Importo Sconto Euro]          
      ,TARGET.[Importo IVA Euro]                      = SOURCE.[Importo IVA Euro]             
      ,TARGET.[Tasso di Cambio]                       = SOURCE.[Tasso di Cambio]              
      ,TARGET.[LocationKey_CLIENTE]                   = SOURCE.[LocationKey_CLIENTE]          
													 
	  WHEN NOT MATCHED                               
	  THEN INSERT (                                  
	                           
	  [ResoSpedizioniKey]
      ,[Rif Ordine Cliente]
      ,[CompanyKey]
      ,[ValutaKey]
      ,[AgenteKey]
      ,[ClienteKey]
      ,[ArticoloKey]
      ,[MagazzinoKey]
      ,[StagioneKey]
      ,[FilialeKey]
      ,[Zonakey]
      ,[CanaleKey]
      ,[SubcaneleKey]
      ,[Marchio]
      ,[CodiceStatoVendita]
      ,[CodiceCategoriaArticolo]
      ,[TestataResoSpedizione]
      ,[RigaResoSpedizione]
      ,[NumeroOrdineReso]
      ,[NumeroRigaOrdineReso]
      ,[NumeroOrdineAcquisto]
      ,[NumeroRigaOrdineAcquisto]
      ,[Tipo]
      ,[CodiceTipoOrdine]
      ,[DescrizioneTipoOrdine]
      ,[DataOrdine]
      ,[DataPubblicazione]
      ,[NomeClienteSpedizione]
      ,[IndirizzoSpedizione]
      ,[CittàSpedizione]
      ,[M_Quantità]
      ,[Importo Lordo In Valuta]
      ,[Importo Sconto In Valuta]
      ,[Importo IVA In Valuta]
      ,[Importo Lordo Euro]
      ,[Importo Sconto Euro]
      ,[Importo IVA Euro]
      ,[Tasso di Cambio]
      ,[LocationKey_CLIENTE]                    
	  )
	  VALUES (
	
	   [ResoSpedizioniKey]
      ,[Rif Ordine Cliente]
      ,[CompanyKey]
      ,[ValutaKey]
      ,[AgenteKey]
      ,[ClienteKey]
      ,[ArticoloKey]
      ,[MagazzinoKey]
      ,[StagioneKey]
      ,[FilialeKey]
      ,[Zonakey]
      ,[CanaleKey]
      ,[SubcaneleKey]
      ,[Marchio]
      ,[CodiceStatoVendita]
      ,[CodiceCategoriaArticolo]
      ,[TestataResoSpedizione]
      ,[RigaResoSpedizione]
      ,[NumeroOrdineReso]
      ,[NumeroRigaOrdineReso]
      ,[NumeroOrdineAcquisto]
      ,[NumeroRigaOrdineAcquisto]
      ,[Tipo]
      ,[CodiceTipoOrdine]
      ,[DescrizioneTipoOrdine]
      ,[DataOrdine]
      ,[DataPubblicazione]
      ,[NomeClienteSpedizione]
      ,[IndirizzoSpedizione]
      ,[CittàSpedizione]
      ,[M_Quantità]
      ,[Importo Lordo In Valuta]
      ,[Importo Sconto In Valuta]
      ,[Importo IVA In Valuta]
      ,[Importo Lordo Euro]
      ,[Importo Sconto Euro]
      ,[Importo IVA Euro]
      ,[Tasso di Cambio]
      ,[LocationKey_CLIENTE]
	  );</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{89B44E94-58DF-4557-8AC2-1615DE334C65}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;MERGE [BI_Model_DWH].[dbo].[FactSpeditoNonFatturato] AS TARGET USING (&#xA;&#xA;SELECT [OrdineVenditaKey]&#xA;      ,[Order No_]&#xA;      ,[Line No_]&#xA;      ,[ImportoSpeditoNonFatturato]&#xA;      ,[QuantitàSpeditaNonFatturata]&#xA;      ,[Posting Date]&#xA;      ,[AgenteKey]&#xA;      ,[CanaleKey]&#xA;      ,[SubcanaleKey]&#xA;      ,[StagioneKey]&#xA;      ,[ArticoloKey]&#xA;      ,[ClienteKey]&#xA;      ,[chiave_spedito]&#xA;  FROM [BI_Model_Stage].[stg].[vFactSpeditoNonFatturato] fct&#xA;  inner join ( SELECT MAX([MaxTimestamp]) as maxtimestamp from [BI_Model_Stage].cfg.Config_Delta) cfg&#xA;  on fct.timestamp &gt; cfg.maxtimestamp&#xA;     ) AS SOURCE &#xA;  ON SOURCE.[chiave_spedito]= TARGET.[chiave_spedito]&#xA;  &#xA;  &#xA;  WHEN MATCHED&#xA;  THEN UPDATE SET &#xA;&#x9;        &#xA;       TARGET.[Order No_]                        = SOURCE.[Order No_]                   &#xA;      ,TARGET.[Line No_]                         = SOURCE.[Line No_]                    &#xA;      ,TARGET.[ImportoSpeditoNonFatturato]       = SOURCE.[ImportoSpeditoNonFatturato]  &#xA;      ,TARGET.[QuantitàSpeditaNonFatturata]      = SOURCE.[QuantitàSpeditaNonFatturata] &#xA;      ,TARGET.[Posting Date]                     = SOURCE.[Posting Date]                &#xA;      ,TARGET.[AgenteKey]                        = SOURCE.[AgenteKey]                   &#xA;      ,TARGET.[CanaleKey]                        = SOURCE.[CanaleKey]                   &#xA;      ,TARGET.[SubcanaleKey]                     = SOURCE.[SubcanaleKey]                &#xA;      ,TARGET.[StagioneKey]                      = SOURCE.[StagioneKey]                 &#xA;      ,TARGET.[ArticoloKey]                      = SOURCE.[ArticoloKey]                 &#xA;      ,TARGET.[ClienteKey]                       = SOURCE.[ClienteKey]                  &#xA;&#x9;  &#xA;&#x9;  WHEN NOT MATCHED&#xA;&#x9;  THEN INSERT (&#xA;&#xA;&#x9;  [OrdineVenditaKey]&#xA;      ,[Order No_]&#xA;      ,[Line No_]&#xA;      ,[ImportoSpeditoNonFatturato]&#xA;      ,[QuantitàSpeditaNonFatturata]&#xA;      ,[Posting Date]&#xA;      ,[AgenteKey]&#xA;      ,[CanaleKey]&#xA;      ,[SubcanaleKey]&#xA;      ,[StagioneKey]&#xA;      ,[ArticoloKey]&#xA;      ,[ClienteKey]&#xA;&#x9;  ,[chiave_spedito]&#xA;&#x9;  )&#xA;&#x9;  VALUES (&#xA;&#x9;&#xA;&#x9;   [OrdineVenditaKey]&#xA;      ,[Order No_]&#xA;      ,[Line No_]&#xA;      ,[ImportoSpeditoNonFatturato]&#xA;      ,[QuantitàSpeditaNonFatturata]&#xA;      ,[Posting Date]&#xA;      ,[AgenteKey]&#xA;      ,[CanaleKey]&#xA;      ,[SubcanaleKey]&#xA;      ,[StagioneKey]&#xA;      ,[ArticoloKey]&#xA;      ,[ClienteKey]&#xA;&#x9;  ,[chiave_spedito]&#xA;&#x9;  );&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="Populate_FactSpeditoNonFatturato">
      <DTS:VariableValue
        DTS:DataType="8">MERGE [BI_Model_DWH].[dbo].[FactSpeditoNonFatturato] AS TARGET USING (

SELECT [OrdineVenditaKey]
      ,[Order No_]
      ,[Line No_]
      ,[ImportoSpeditoNonFatturato]
      ,[QuantitàSpeditaNonFatturata]
      ,[Posting Date]
      ,[AgenteKey]
      ,[CanaleKey]
      ,[SubcanaleKey]
      ,[StagioneKey]
      ,[ArticoloKey]
      ,[ClienteKey]
      ,[chiave_spedito]
  FROM [BI_Model_Stage].[stg].[vFactSpeditoNonFatturato] fct
  inner join ( SELECT MAX([MaxTimestamp]) as maxtimestamp from [BI_Model_Stage].cfg.Config_Delta) cfg
  on fct.timestamp &gt; cfg.maxtimestamp
     ) AS SOURCE 
  ON SOURCE.[chiave_spedito]= TARGET.[chiave_spedito]
  
  
  WHEN MATCHED
  THEN UPDATE SET 
	        
       TARGET.[Order No_]                        = SOURCE.[Order No_]                   
      ,TARGET.[Line No_]                         = SOURCE.[Line No_]                    
      ,TARGET.[ImportoSpeditoNonFatturato]       = SOURCE.[ImportoSpeditoNonFatturato]  
      ,TARGET.[QuantitàSpeditaNonFatturata]      = SOURCE.[QuantitàSpeditaNonFatturata] 
      ,TARGET.[Posting Date]                     = SOURCE.[Posting Date]                
      ,TARGET.[AgenteKey]                        = SOURCE.[AgenteKey]                   
      ,TARGET.[CanaleKey]                        = SOURCE.[CanaleKey]                   
      ,TARGET.[SubcanaleKey]                     = SOURCE.[SubcanaleKey]                
      ,TARGET.[StagioneKey]                      = SOURCE.[StagioneKey]                 
      ,TARGET.[ArticoloKey]                      = SOURCE.[ArticoloKey]                 
      ,TARGET.[ClienteKey]                       = SOURCE.[ClienteKey]                  
	  
	  WHEN NOT MATCHED
	  THEN INSERT (

	  [OrdineVenditaKey]
      ,[Order No_]
      ,[Line No_]
      ,[ImportoSpeditoNonFatturato]
      ,[QuantitàSpeditaNonFatturata]
      ,[Posting Date]
      ,[AgenteKey]
      ,[CanaleKey]
      ,[SubcanaleKey]
      ,[StagioneKey]
      ,[ArticoloKey]
      ,[ClienteKey]
	  ,[chiave_spedito]
	  )
	  VALUES (
	
	   [OrdineVenditaKey]
      ,[Order No_]
      ,[Line No_]
      ,[ImportoSpeditoNonFatturato]
      ,[QuantitàSpeditaNonFatturata]
      ,[Posting Date]
      ,[AgenteKey]
      ,[CanaleKey]
      ,[SubcanaleKey]
      ,[StagioneKey]
      ,[ArticoloKey]
      ,[ClienteKey]
	  ,[chiave_spedito]
	  );</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{438675BE-4E09-4AA9-B22F-8EAB065EA4B3}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;MERGE [BI_Model_DWH].[dbo].[FactSpedizioni_NUOVO2] AS TARGET USING (&#xA;&#xA;SELECT TIMESTAMP&#xA;&#x9;  ,[ArticoloKey]&#xA;      ,[MagazzinoKey]&#xA;      ,[M_Quantità]&#xA;      ,[Importo Lordo In Valuta]&#xA;      ,[Importo Sconto In Valuta]&#xA;      ,[Importo IVA In Valuta]&#xA;      ,[Importo Lordo Euro]&#xA;      ,[Importo Sconto Euro]&#xA;      ,[Importo IVA Euro]&#xA;      ,[AgenteKey]&#xA;      ,[ClienteKey]&#xA;      ,[SpedizioniKey]&#xA;      ,[ValutaKey]&#xA;      ,[CodiceCategoriaArticolo]&#xA;      ,[NumeroSpedizione]&#xA;      ,[NumeroRigaSpedizione]&#xA;      ,[NumeroOrdine]&#xA;      ,[NumeroRigaOrdine]&#xA;      ,[NumeroOrdineAcquisto]&#xA;      ,[NumeroRigaOrdineAcquisto]&#xA;      ,[Tipo]&#xA;      ,[DataOrdine]&#xA;      ,[DataSpedizione]&#xA;      ,[DataScadenza]&#xA;      ,[DataPublicazione]&#xA;      ,[DataPianificataConsegna]&#xA;      ,[DataPianificataSpedizione]&#xA;      ,[DataRichiestaConsegna]&#xA;      ,[CompanyKey]&#xA;      ,[Marchio]&#xA;      ,[StagioneKey]&#xA;      ,[CanaleKey]&#xA;      ,[SubcaneleKey]&#xA;      ,[Tasso di Cambio]&#xA;      ,[DescrizioneTipoOrdine]&#xA;      ,[NomeClienteSpedizione]&#xA;      ,[IndirizzoSpedizione]&#xA;      ,[CittàSpedizione]&#xA;      ,[CodiceTipoOrdineKey]&#xA;      ,[Zonakey]&#xA;      ,[CodiceStatoVendita]&#xA;      ,[M_Quantità_SpeditaNonFatturata]&#xA;      ,[M_Quantità_Fatturata]&#xA;      ,[Importo Lordo In Valuta_speditoNonFaturato]&#xA;      ,[Importo Sconto In Valuta_speditoNonFaturato]&#xA;      ,[Importo IVA In Valuta_speditoNonFaturato]&#xA;      ,[Importo Lordo In euro_speditoNonFaturato]&#xA;      ,[Importo Sconto In euro_speditoNonFaturato]&#xA;      ,[Importo IVA In euro_speditoNonFaturato]&#xA;      ,[FilialeKey]&#xA;      ,[LocationKey_CLIENTE]&#xA;      ,[Rif Ordine Cliente]&#xA;      ,[Tipo Operazione CDV]&#xA;      &#xA;  FROM [BI_Model_Stage].[stg].[vFactSpedizioni_NUOVO2] fct&#xA;  inner join ( SELECT MAX([MaxTimestamp]) as maxtimestamp from [BI_Model_Stage].cfg.Config_Delta) cfg&#xA;  on fct.timestamp &gt; cfg.maxtimestamp&#xA;     ) AS SOURCE &#xA;  ON SOURCE.[SpedizioniKey]= TARGET.[SpedizioniKey]&#xA;  &#xA;  &#xA;  WHEN MATCHED&#xA;  THEN UPDATE SET &#xA;&#x9;        &#xA;       TARGET.[ArticoloKey]                                       = SOURCE.[ArticoloKey]                                 &#xA;      ,TARGET.[MagazzinoKey]                                      = SOURCE.[MagazzinoKey]                                &#xA;      ,TARGET.[M_Quantità]                                        = SOURCE.[M_Quantità]                                  &#xA;      ,TARGET.[Importo Lordo In Valuta]                           = SOURCE.[Importo Lordo In Valuta]                     &#xA;      ,TARGET.[Importo Sconto In Valuta]                          = SOURCE.[Importo Sconto In Valuta]                    &#xA;      ,TARGET.[Importo IVA In Valuta]                             = SOURCE.[Importo IVA In Valuta]                       &#xA;      ,TARGET.[Importo Lordo Euro]                                = SOURCE.[Importo Lordo Euro]                          &#xA;      ,TARGET.[Importo Sconto Euro]                               = SOURCE.[Importo Sconto Euro]                         &#xA;      ,TARGET.[Importo IVA Euro]                                  = SOURCE.[Importo IVA Euro]                            &#xA;      ,TARGET.[AgenteKey]                                         = SOURCE.[AgenteKey]                                   &#xA;      ,TARGET.[ClienteKey]                                        = SOURCE.[ClienteKey]                                  &#xA;                                    &#xA;      ,TARGET.[ValutaKey]                                         = SOURCE.[ValutaKey]                                   &#xA;      ,TARGET.[CodiceCategoriaArticolo]                           = SOURCE.[CodiceCategoriaArticolo]                                 &#xA;      ,TARGET.[Tipo]                                              = SOURCE.[Tipo]                                        &#xA;      ,TARGET.[DataOrdine]                                        = SOURCE.[DataOrdine]                                  &#xA;      ,TARGET.[DataSpedizione]                                    = SOURCE.[DataSpedizione]                              &#xA;      ,TARGET.[DataScadenza]                                      = SOURCE.[DataScadenza]                                &#xA;      ,TARGET.[DataPublicazione]                                  = SOURCE.[DataPublicazione]                            &#xA;      ,TARGET.[DataPianificataConsegna]                           = SOURCE.[DataPianificataConsegna]                     &#xA;      ,TARGET.[DataPianificataSpedizione]                         = SOURCE.[DataPianificataSpedizione]                   &#xA;      ,TARGET.[DataRichiestaConsegna]                             = SOURCE.[DataRichiestaConsegna]                       &#xA;                                      &#xA;      ,TARGET.[Marchio]                                           = SOURCE.[Marchio]                                     &#xA;      ,TARGET.[StagioneKey]                                       = SOURCE.[StagioneKey]                                 &#xA;      ,TARGET.[CanaleKey]                                         = SOURCE.[CanaleKey]                                   &#xA;      ,TARGET.[SubcaneleKey]                                      = SOURCE.[SubcaneleKey]                                &#xA;      ,TARGET.[Tasso di Cambio]                                   = SOURCE.[Tasso di Cambio]                             &#xA;      ,TARGET.[DescrizioneTipoOrdine]                             = SOURCE.[DescrizioneTipoOrdine]                       &#xA;      ,TARGET.[NomeClienteSpedizione]                             = SOURCE.[NomeClienteSpedizione]                       &#xA;      ,TARGET.[IndirizzoSpedizione]                               = SOURCE.[IndirizzoSpedizione]                         &#xA;      ,TARGET.[CittàSpedizione]                                   = SOURCE.[CittàSpedizione]                             &#xA;      ,TARGET.[CodiceTipoOrdineKey]                               = SOURCE.[CodiceTipoOrdineKey]                         &#xA;      ,TARGET.[Zonakey]                                           = SOURCE.[Zonakey]                                     &#xA;      ,TARGET.[CodiceStatoVendita]                                = SOURCE.[CodiceStatoVendita]                          &#xA;      ,TARGET.[M_Quantità_SpeditaNonFatturata]                    = SOURCE.[M_Quantità_SpeditaNonFatturata]              &#xA;      ,TARGET.[M_Quantità_Fatturata]                              = SOURCE.[M_Quantità_Fatturata]                        &#xA;      ,TARGET.[Importo Lordo In Valuta_speditoNonFaturato]        = SOURCE.[Importo Lordo In Valuta_speditoNonFaturato]  &#xA;      ,TARGET.[Importo Sconto In Valuta_speditoNonFaturato]       = SOURCE.[Importo Sconto In Valuta_speditoNonFaturato] &#xA;      ,TARGET.[Importo IVA In Valuta_speditoNonFaturato]          = SOURCE.[Importo IVA In Valuta_speditoNonFaturato]    &#xA;      ,TARGET.[Importo Lordo In euro_speditoNonFaturato]          = SOURCE.[Importo Lordo In euro_speditoNonFaturato]    &#xA;      ,TARGET.[Importo Sconto In euro_speditoNonFaturato]         = SOURCE.[Importo Sconto In euro_speditoNonFaturato]   &#xA;      ,TARGET.[Importo IVA In euro_speditoNonFaturato]            = SOURCE.[Importo IVA In euro_speditoNonFaturato]      &#xA;      ,TARGET.[FilialeKey]                                        = SOURCE.[FilialeKey]                                  &#xA;      ,TARGET.[LocationKey_CLIENTE]                               = SOURCE.[LocationKey_CLIENTE]                         &#xA;      ,TARGET.[Rif Ordine Cliente]                                = SOURCE.[Rif Ordine Cliente]                          &#xA;      ,TARGET.[Tipo Operazione CDV]                               = SOURCE.[Tipo Operazione CDV]                         &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  &#xA;&#x9;  WHEN NOT MATCHED&#xA;&#x9;  THEN INSERT (&#xA;&#xA;&#x9;  [ArticoloKey]&#xA;      ,[MagazzinoKey]&#xA;      ,[M_Quantità]&#xA;      ,[Importo Lordo In Valuta]&#xA;      ,[Importo Sconto In Valuta]&#xA;      ,[Importo IVA In Valuta]&#xA;      ,[Importo Lordo Euro]&#xA;      ,[Importo Sconto Euro]&#xA;      ,[Importo IVA Euro]&#xA;      ,[AgenteKey]&#xA;      ,[ClienteKey]&#xA;      ,[SpedizioniKey]&#xA;      ,[ValutaKey]&#xA;      ,[CodiceCategoriaArticolo]&#xA;      ,[NumeroSpedizione]&#xA;      ,[NumeroRigaSpedizione]&#xA;      ,[NumeroOrdine]&#xA;      ,[NumeroRigaOrdine]&#xA;      ,[NumeroOrdineAcquisto]&#xA;      ,[NumeroRigaOrdineAcquisto]&#xA;      ,[Tipo]&#xA;      ,[DataOrdine]&#xA;      ,[DataSpedizione]&#xA;      ,[DataScadenza]&#xA;      ,[DataPublicazione]&#xA;      ,[DataPianificataConsegna]&#xA;      ,[DataPianificataSpedizione]&#xA;      ,[DataRichiestaConsegna]&#xA;      ,[CompanyKey]&#xA;      ,[Marchio]&#xA;      ,[StagioneKey]&#xA;      ,[CanaleKey]&#xA;      ,[SubcaneleKey]&#xA;      ,[Tasso di Cambio]&#xA;      ,[DescrizioneTipoOrdine]&#xA;      ,[NomeClienteSpedizione]&#xA;      ,[IndirizzoSpedizione]&#xA;      ,[CittàSpedizione]&#xA;      ,[CodiceTipoOrdineKey]&#xA;      ,[Zonakey]&#xA;      ,[CodiceStatoVendita]&#xA;      ,[M_Quantità_SpeditaNonFatturata]&#xA;      ,[M_Quantità_Fatturata]&#xA;      ,[Importo Lordo In Valuta_speditoNonFaturato]&#xA;      ,[Importo Sconto In Valuta_speditoNonFaturato]&#xA;      ,[Importo IVA In Valuta_speditoNonFaturato]&#xA;      ,[Importo Lordo In euro_speditoNonFaturato]&#xA;      ,[Importo Sconto In euro_speditoNonFaturato]&#xA;      ,[Importo IVA In euro_speditoNonFaturato]&#xA;      ,[FilialeKey]&#xA;      ,[LocationKey_CLIENTE]&#xA;      ,[Rif Ordine Cliente]&#xA;      ,[Tipo Operazione CDV]&#xA;&#x9;  )&#xA;&#x9;  VALUES (&#xA;&#x9;&#xA;&#x9;   [ArticoloKey]&#xA;      ,[MagazzinoKey]&#xA;      ,[M_Quantità]&#xA;      ,[Importo Lordo In Valuta]&#xA;      ,[Importo Sconto In Valuta]&#xA;      ,[Importo IVA In Valuta]&#xA;      ,[Importo Lordo Euro]&#xA;      ,[Importo Sconto Euro]&#xA;      ,[Importo IVA Euro]&#xA;      ,[AgenteKey]&#xA;      ,[ClienteKey]&#xA;      ,[SpedizioniKey]&#xA;      ,[ValutaKey]&#xA;      ,[CodiceCategoriaArticolo]&#xA;      ,[NumeroSpedizione]&#xA;      ,[NumeroRigaSpedizione]&#xA;      ,[NumeroOrdine]&#xA;      ,[NumeroRigaOrdine]&#xA;      ,[NumeroOrdineAcquisto]&#xA;      ,[NumeroRigaOrdineAcquisto]&#xA;      ,[Tipo]&#xA;      ,[DataOrdine]&#xA;      ,[DataSpedizione]&#xA;      ,[DataScadenza]&#xA;      ,[DataPublicazione]&#xA;      ,[DataPianificataConsegna]&#xA;      ,[DataPianificataSpedizione]&#xA;      ,[DataRichiestaConsegna]&#xA;      ,[CompanyKey]&#xA;      ,[Marchio]&#xA;      ,[StagioneKey]&#xA;      ,[CanaleKey]&#xA;      ,[SubcaneleKey]&#xA;      ,[Tasso di Cambio]&#xA;      ,[DescrizioneTipoOrdine]&#xA;      ,[NomeClienteSpedizione]&#xA;      ,[IndirizzoSpedizione]&#xA;      ,[CittàSpedizione]&#xA;      ,[CodiceTipoOrdineKey]&#xA;      ,[Zonakey]&#xA;      ,[CodiceStatoVendita]&#xA;      ,[M_Quantità_SpeditaNonFatturata]&#xA;      ,[M_Quantità_Fatturata]&#xA;      ,[Importo Lordo In Valuta_speditoNonFaturato]&#xA;      ,[Importo Sconto In Valuta_speditoNonFaturato]&#xA;      ,[Importo IVA In Valuta_speditoNonFaturato]&#xA;      ,[Importo Lordo In euro_speditoNonFaturato]&#xA;      ,[Importo Sconto In euro_speditoNonFaturato]&#xA;      ,[Importo IVA In euro_speditoNonFaturato]&#xA;      ,[FilialeKey]&#xA;      ,[LocationKey_CLIENTE]&#xA;      ,[Rif Ordine Cliente]&#xA;      ,[Tipo Operazione CDV]&#xA;&#x9;  );&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="Populate_FactSpedizioni">
      <DTS:VariableValue
        DTS:DataType="8">MERGE [BI_Model_DWH].[dbo].[FactSpedizioni_NUOVO2] AS TARGET USING (

SELECT TIMESTAMP
	  ,[ArticoloKey]
      ,[MagazzinoKey]
      ,[M_Quantità]
      ,[Importo Lordo In Valuta]
      ,[Importo Sconto In Valuta]
      ,[Importo IVA In Valuta]
      ,[Importo Lordo Euro]
      ,[Importo Sconto Euro]
      ,[Importo IVA Euro]
      ,[AgenteKey]
      ,[ClienteKey]
      ,[SpedizioniKey]
      ,[ValutaKey]
      ,[CodiceCategoriaArticolo]
      ,[NumeroSpedizione]
      ,[NumeroRigaSpedizione]
      ,[NumeroOrdine]
      ,[NumeroRigaOrdine]
      ,[NumeroOrdineAcquisto]
      ,[NumeroRigaOrdineAcquisto]
      ,[Tipo]
      ,[DataOrdine]
      ,[DataSpedizione]
      ,[DataScadenza]
      ,[DataPublicazione]
      ,[DataPianificataConsegna]
      ,[DataPianificataSpedizione]
      ,[DataRichiestaConsegna]
      ,[CompanyKey]
      ,[Marchio]
      ,[StagioneKey]
      ,[CanaleKey]
      ,[SubcaneleKey]
      ,[Tasso di Cambio]
      ,[DescrizioneTipoOrdine]
      ,[NomeClienteSpedizione]
      ,[IndirizzoSpedizione]
      ,[CittàSpedizione]
      ,[CodiceTipoOrdineKey]
      ,[Zonakey]
      ,[CodiceStatoVendita]
      ,[M_Quantità_SpeditaNonFatturata]
      ,[M_Quantità_Fatturata]
      ,[Importo Lordo In Valuta_speditoNonFaturato]
      ,[Importo Sconto In Valuta_speditoNonFaturato]
      ,[Importo IVA In Valuta_speditoNonFaturato]
      ,[Importo Lordo In euro_speditoNonFaturato]
      ,[Importo Sconto In euro_speditoNonFaturato]
      ,[Importo IVA In euro_speditoNonFaturato]
      ,[FilialeKey]
      ,[LocationKey_CLIENTE]
      ,[Rif Ordine Cliente]
      ,[Tipo Operazione CDV]
      
  FROM [BI_Model_Stage].[stg].[vFactSpedizioni_NUOVO2] fct
  inner join ( SELECT MAX([MaxTimestamp]) as maxtimestamp from [BI_Model_Stage].cfg.Config_Delta) cfg
  on fct.timestamp &gt; cfg.maxtimestamp
     ) AS SOURCE 
  ON SOURCE.[SpedizioniKey]= TARGET.[SpedizioniKey]
  
  
  WHEN MATCHED
  THEN UPDATE SET 
	        
       TARGET.[ArticoloKey]                                       = SOURCE.[ArticoloKey]                                 
      ,TARGET.[MagazzinoKey]                                      = SOURCE.[MagazzinoKey]                                
      ,TARGET.[M_Quantità]                                        = SOURCE.[M_Quantità]                                  
      ,TARGET.[Importo Lordo In Valuta]                           = SOURCE.[Importo Lordo In Valuta]                     
      ,TARGET.[Importo Sconto In Valuta]                          = SOURCE.[Importo Sconto In Valuta]                    
      ,TARGET.[Importo IVA In Valuta]                             = SOURCE.[Importo IVA In Valuta]                       
      ,TARGET.[Importo Lordo Euro]                                = SOURCE.[Importo Lordo Euro]                          
      ,TARGET.[Importo Sconto Euro]                               = SOURCE.[Importo Sconto Euro]                         
      ,TARGET.[Importo IVA Euro]                                  = SOURCE.[Importo IVA Euro]                            
      ,TARGET.[AgenteKey]                                         = SOURCE.[AgenteKey]                                   
      ,TARGET.[ClienteKey]                                        = SOURCE.[ClienteKey]                                  
                                    
      ,TARGET.[ValutaKey]                                         = SOURCE.[ValutaKey]                                   
      ,TARGET.[CodiceCategoriaArticolo]                           = SOURCE.[CodiceCategoriaArticolo]                                 
      ,TARGET.[Tipo]                                              = SOURCE.[Tipo]                                        
      ,TARGET.[DataOrdine]                                        = SOURCE.[DataOrdine]                                  
      ,TARGET.[DataSpedizione]                                    = SOURCE.[DataSpedizione]                              
      ,TARGET.[DataScadenza]                                      = SOURCE.[DataScadenza]                                
      ,TARGET.[DataPublicazione]                                  = SOURCE.[DataPublicazione]                            
      ,TARGET.[DataPianificataConsegna]                           = SOURCE.[DataPianificataConsegna]                     
      ,TARGET.[DataPianificataSpedizione]                         = SOURCE.[DataPianificataSpedizione]                   
      ,TARGET.[DataRichiestaConsegna]                             = SOURCE.[DataRichiestaConsegna]                       
                                      
      ,TARGET.[Marchio]                                           = SOURCE.[Marchio]                                     
      ,TARGET.[StagioneKey]                                       = SOURCE.[StagioneKey]                                 
      ,TARGET.[CanaleKey]                                         = SOURCE.[CanaleKey]                                   
      ,TARGET.[SubcaneleKey]                                      = SOURCE.[SubcaneleKey]                                
      ,TARGET.[Tasso di Cambio]                                   = SOURCE.[Tasso di Cambio]                             
      ,TARGET.[DescrizioneTipoOrdine]                             = SOURCE.[DescrizioneTipoOrdine]                       
      ,TARGET.[NomeClienteSpedizione]                             = SOURCE.[NomeClienteSpedizione]                       
      ,TARGET.[IndirizzoSpedizione]                               = SOURCE.[IndirizzoSpedizione]                         
      ,TARGET.[CittàSpedizione]                                   = SOURCE.[CittàSpedizione]                             
      ,TARGET.[CodiceTipoOrdineKey]                               = SOURCE.[CodiceTipoOrdineKey]                         
      ,TARGET.[Zonakey]                                           = SOURCE.[Zonakey]                                     
      ,TARGET.[CodiceStatoVendita]                                = SOURCE.[CodiceStatoVendita]                          
      ,TARGET.[M_Quantità_SpeditaNonFatturata]                    = SOURCE.[M_Quantità_SpeditaNonFatturata]              
      ,TARGET.[M_Quantità_Fatturata]                              = SOURCE.[M_Quantità_Fatturata]                        
      ,TARGET.[Importo Lordo In Valuta_speditoNonFaturato]        = SOURCE.[Importo Lordo In Valuta_speditoNonFaturato]  
      ,TARGET.[Importo Sconto In Valuta_speditoNonFaturato]       = SOURCE.[Importo Sconto In Valuta_speditoNonFaturato] 
      ,TARGET.[Importo IVA In Valuta_speditoNonFaturato]          = SOURCE.[Importo IVA In Valuta_speditoNonFaturato]    
      ,TARGET.[Importo Lordo In euro_speditoNonFaturato]          = SOURCE.[Importo Lordo In euro_speditoNonFaturato]    
      ,TARGET.[Importo Sconto In euro_speditoNonFaturato]         = SOURCE.[Importo Sconto In euro_speditoNonFaturato]   
      ,TARGET.[Importo IVA In euro_speditoNonFaturato]            = SOURCE.[Importo IVA In euro_speditoNonFaturato]      
      ,TARGET.[FilialeKey]                                        = SOURCE.[FilialeKey]                                  
      ,TARGET.[LocationKey_CLIENTE]                               = SOURCE.[LocationKey_CLIENTE]                         
      ,TARGET.[Rif Ordine Cliente]                                = SOURCE.[Rif Ordine Cliente]                          
      ,TARGET.[Tipo Operazione CDV]                               = SOURCE.[Tipo Operazione CDV]                         
																  
	  WHEN NOT MATCHED
	  THEN INSERT (

	  [ArticoloKey]
      ,[MagazzinoKey]
      ,[M_Quantità]
      ,[Importo Lordo In Valuta]
      ,[Importo Sconto In Valuta]
      ,[Importo IVA In Valuta]
      ,[Importo Lordo Euro]
      ,[Importo Sconto Euro]
      ,[Importo IVA Euro]
      ,[AgenteKey]
      ,[ClienteKey]
      ,[SpedizioniKey]
      ,[ValutaKey]
      ,[CodiceCategoriaArticolo]
      ,[NumeroSpedizione]
      ,[NumeroRigaSpedizione]
      ,[NumeroOrdine]
      ,[NumeroRigaOrdine]
      ,[NumeroOrdineAcquisto]
      ,[NumeroRigaOrdineAcquisto]
      ,[Tipo]
      ,[DataOrdine]
      ,[DataSpedizione]
      ,[DataScadenza]
      ,[DataPublicazione]
      ,[DataPianificataConsegna]
      ,[DataPianificataSpedizione]
      ,[DataRichiestaConsegna]
      ,[CompanyKey]
      ,[Marchio]
      ,[StagioneKey]
      ,[CanaleKey]
      ,[SubcaneleKey]
      ,[Tasso di Cambio]
      ,[DescrizioneTipoOrdine]
      ,[NomeClienteSpedizione]
      ,[IndirizzoSpedizione]
      ,[CittàSpedizione]
      ,[CodiceTipoOrdineKey]
      ,[Zonakey]
      ,[CodiceStatoVendita]
      ,[M_Quantità_SpeditaNonFatturata]
      ,[M_Quantità_Fatturata]
      ,[Importo Lordo In Valuta_speditoNonFaturato]
      ,[Importo Sconto In Valuta_speditoNonFaturato]
      ,[Importo IVA In Valuta_speditoNonFaturato]
      ,[Importo Lordo In euro_speditoNonFaturato]
      ,[Importo Sconto In euro_speditoNonFaturato]
      ,[Importo IVA In euro_speditoNonFaturato]
      ,[FilialeKey]
      ,[LocationKey_CLIENTE]
      ,[Rif Ordine Cliente]
      ,[Tipo Operazione CDV]
	  )
	  VALUES (
	
	   [ArticoloKey]
      ,[MagazzinoKey]
      ,[M_Quantità]
      ,[Importo Lordo In Valuta]
      ,[Importo Sconto In Valuta]
      ,[Importo IVA In Valuta]
      ,[Importo Lordo Euro]
      ,[Importo Sconto Euro]
      ,[Importo IVA Euro]
      ,[AgenteKey]
      ,[ClienteKey]
      ,[SpedizioniKey]
      ,[ValutaKey]
      ,[CodiceCategoriaArticolo]
      ,[NumeroSpedizione]
      ,[NumeroRigaSpedizione]
      ,[NumeroOrdine]
      ,[NumeroRigaOrdine]
      ,[NumeroOrdineAcquisto]
      ,[NumeroRigaOrdineAcquisto]
      ,[Tipo]
      ,[DataOrdine]
      ,[DataSpedizione]
      ,[DataScadenza]
      ,[DataPublicazione]
      ,[DataPianificataConsegna]
      ,[DataPianificataSpedizione]
      ,[DataRichiestaConsegna]
      ,[CompanyKey]
      ,[Marchio]
      ,[StagioneKey]
      ,[CanaleKey]
      ,[SubcaneleKey]
      ,[Tasso di Cambio]
      ,[DescrizioneTipoOrdine]
      ,[NomeClienteSpedizione]
      ,[IndirizzoSpedizione]
      ,[CittàSpedizione]
      ,[CodiceTipoOrdineKey]
      ,[Zonakey]
      ,[CodiceStatoVendita]
      ,[M_Quantità_SpeditaNonFatturata]
      ,[M_Quantità_Fatturata]
      ,[Importo Lordo In Valuta_speditoNonFaturato]
      ,[Importo Sconto In Valuta_speditoNonFaturato]
      ,[Importo IVA In Valuta_speditoNonFaturato]
      ,[Importo Lordo In euro_speditoNonFaturato]
      ,[Importo Sconto In euro_speditoNonFaturato]
      ,[Importo IVA In euro_speditoNonFaturato]
      ,[FilialeKey]
      ,[LocationKey_CLIENTE]
      ,[Rif Ordine Cliente]
      ,[Tipo Operazione CDV]
	  );</DTS:VariableValue>
    </DTS:Variable>
  </DTS:Variables>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Contabilità"
      DTS:CreationName="STOCK:SEQUENCE"
      DTS:Description="Contenitore Sequenza"
      DTS:DTSID="{90211C1D-8886-4776-80A3-4D3AA42E6C5E}"
      DTS:ExecutableType="STOCK:SEQUENCE"
      DTS:LocaleID="-1"
      DTS:ObjectName="Contabilità">
      <DTS:Variables />
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\Contabilità\FactAcquisto_Costi_Accessori_preventivi"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Attività Esegui SQL"
          DTS:DTSID="{0A4008F8-70F0-4BC8-95B4-65E4C5BB1B09}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="FactAcquisto_Costi_Accessori_preventivi"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{01E748CB-DAFD-4EA7-920E-23E68DAB645E}"
              SQLTask:SqlStatementSource="INSERT INTO [BI_Model_DWH].[dbo].[FactAcquisto_Costi_Accessori_preventivi]&#xA;           ([Tipo Costo]&#xA;      ,[Season Code]&#xA;      ,[Currency Code]&#xA;      ,[Country_Region Code]&#xA;      ,[Exchange Rate Amount]&#xA;      ,[Costo Unitario Euro]&#xA;      ,[Costo Unitario in Valuta]&#xA;      ,[Marchio]&#xA;      ,[Company]&#xA;      ,[model item no_])&#xA;&#x9;  &#xA;&#x9;  SELECT  [Tipo Costo]&#xA;      ,[Season Code]&#xA;      ,[Currency Code]&#xA;      ,[Country_Region Code]&#xA;      ,[Exchange Rate Amount]&#xA;      ,[Costo Unitario Euro]&#xA;      ,[Costo Unitario in Valuta]&#xA;      ,[Marchio]&#xA;      ,[Company]&#xA;      ,[model item no_]&#xA;        FROM [BI_Model_Stage].[stg].[vFactAcquisto_Costi_Accessori_preventivi] WITH (NOLOCK)" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Contabilità\FactAffidamentoClienti"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Attività Esegui SQL"
          DTS:DTSID="{DC5355A7-9F1D-4905-977C-5CE3E4C84EE1}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="FactAffidamentoClienti"
          DTS:ThreadHint="1">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{01E748CB-DAFD-4EA7-920E-23E68DAB645E}"
              SQLTask:SqlStatementSource="INSERT INTO [dbo].[FactAffidamentoClienti]&#xA;           ([ClienteKey]&#xA;           ,[Amount]&#xA;           ,[Company]&#xA;           ,[timestamp]&#xA;           ,[Company Code]&#xA;           ,[Update Date]&#xA;           ,[Status]&#xA;           ,[Starting Date]&#xA;           ,[Data Visura Protesti]&#xA;           ,[Limit of Credit _]&#xA;           ,[Situation]&#xA;           ,[Memo]&#xA;           ,[Extra Credit]&#xA;           ,[Data Extra Credit]&#xA;           ,[Active]&#xA;           ,[Cerved Credit]&#xA;           ,[Memo 2]&#xA;           ,[Payment Times]&#xA;           ,[Negative Events]&#xA;           ,[Econ-Financial Situation]&#xA;           ,[Risk no consultations]&#xA;           ,[Revenues]&#xA;           ,[Purchases]&#xA;           ,[Mol]&#xA;           ,[Useful Loss]&#xA;           ,[Net Assets]&#xA;           ,[No_ Employees]&#xA;           ,[No_ Requests Last 12 Months]&#xA;           ,[Cash Flow]&#xA;           ,[Ebitda]&#xA;           ,[Inventories]&#xA;           ,[Payables to ML Banks Term]&#xA;           ,[Payables to Banks BT]&#xA;           ,[Payables to Vendors]&#xA;           ,[Other Liabilities]&#xA;           ,[Current Ratio]&#xA;           ,[Net Circular Capital]&#xA;           ,[Protests]&#xA;           ,[Preg Cons]&#xA;           ,[Email Certified]&#xA;           ,[Start Activity]&#xA;           ,[Secondary Seats No_]&#xA;           ,[Ateco Code]&#xA;           ,[Consistence Properties]&#xA;           ,[Insert Date]&#xA;           ,[Receipt Date]&#xA;           ,[Due Date])&#xA;    &#xA;&#x9;select &#xA;&#x9;[ClienteKey]&#xA;           ,[Amount]&#xA;           ,[Company]&#xA;           ,[timestamp]&#xA;           ,[Company Code]&#xA;           ,[Update Date]&#xA;           ,[Status]&#xA;           ,[Starting Date]&#xA;           ,[Data Visura Protesti]&#xA;           ,[Limit of Credit _]&#xA;           ,[Situation]&#xA;           ,[Memo]&#xA;           ,[Extra Credit]&#xA;           ,[Data Extra Credit]&#xA;           ,[Active]&#xA;           ,[Cerved Credit]&#xA;           ,[Memo 2]&#xA;           ,[Payment Times]&#xA;           ,[Negative Events]&#xA;           ,[Econ-Financial Situation]&#xA;           ,[Risk no consultations]&#xA;           ,[Revenues]&#xA;           ,[Purchases]&#xA;           ,[Mol]&#xA;           ,[Useful Loss]&#xA;           ,[Net Assets]&#xA;           ,[No_ Employees]&#xA;           ,[No_ Requests Last 12 Months]&#xA;           ,[Cash Flow]&#xA;           ,[Ebitda]&#xA;           ,[Inventories]&#xA;           ,[Payables to ML Banks Term]&#xA;           ,[Payables to Banks BT]&#xA;           ,[Payables to Vendors]&#xA;           ,[Other Liabilities]&#xA;           ,[Current Ratio]&#xA;           ,[Net Circular Capital]&#xA;           ,[Protests]&#xA;           ,[Preg Cons]&#xA;           ,[Email Certified]&#xA;           ,[Start Activity]&#xA;           ,[Secondary Seats No_]&#xA;           ,[Ateco Code]&#xA;           ,[Consistence Properties]&#xA;           ,[Insert Date]&#xA;           ,[Receipt Date]&#xA;           ,[Due Date]&#xA; from [BI_Model_Stage].[stg].[vFactAffidamentoClienti]&#xA;&#x9;WITH (NOLOCK)&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Contabilità\FactCogeManutenzione"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Attività Esegui SQL"
          DTS:DTSID="{D7AC3AA8-E086-4A43-A878-4C28869A5194}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="FactCogeManutenzione"
          DTS:ThreadHint="2">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{01E748CB-DAFD-4EA7-920E-23E68DAB645E}"
              SQLTask:SqlStatementSource="INSERT INTO [BI_Model_DWH].[dbo].[FactCOGEManutenzione]&#xA;           ([Gen_ Bus_ Posting Group]&#xA;      ,[ContoKey]&#xA;      ,[StagioneKey]&#xA;      ,[Tax Area Code]&#xA;      ,[Tax Liable]&#xA;      ,[VAT Bus_ Posting Group]&#xA;      ,[Dimension Set ID]&#xA;      ,[Posting Date]&#xA;      ,[Bal_ Account No_]&#xA;      ,[Reason Code]&#xA;      ,[Bal_ Account Type]&#xA;      ,[Document Date]&#xA;      ,[Source Code]&#xA;      ,[SourceType]&#xA;      ,[Source No_]&#xA;      ,[Document Type]&#xA;      ,[Document No_]&#xA;      ,[Description]&#xA;      ,[Amount]&#xA;      ,[System-Created Entry]&#xA;      ,[Job No_]&#xA;      ,[Quantity]&#xA;      ,[VAT Amount]&#xA;      ,[Business Unit Code]&#xA;      ,[Journal Batch Name]&#xA;      ,[Gen_ Posting Type]&#xA;      ,[Gen_ Prod_ Posting Group]&#xA;      ,[Debit Amount]&#xA;      ,[Credit Amount]&#xA;      ,[External Document No_]&#xA;      ,[Tax Group Code]&#xA;      ,[Use Tax]&#xA;      ,[VAT Prod_ Posting Group]&#xA;      ,[IC Partner Code]&#xA;      ,[Prod_ Order No_]&#xA;      ,[Due Date]&#xA;      ,[Letter No_]&#xA;      ,[Journal Template Name]&#xA;      ,[Line No_]&#xA;      ,[Account Type]&#xA;      ,[VAT _]&#xA;      ,[Currency Code]&#xA;      ,[Amount (LCY)]&#xA;      ,[Balance (LCY)]&#xA;      ,[Currency Factor]&#xA;      ,[Sales_Purch_ (LCY)]&#xA;      ,[Profit (LCY)]&#xA;      ,[Inv_ Discount (LCY)]&#xA;      ,[Bill-to_Pay-to No_]&#xA;      ,[Posting Group]&#xA;      ,[Marchio]&#xA;      ,[Salespers__Purch_ Code]&#xA;      ,[On Hold]&#xA;      ,[Applies-to Doc_ Type]&#xA;      ,[Applies-to Doc_ No_]&#xA;      ,[Pmt_ Discount Date]&#xA;      ,[Payment Discount _]&#xA;      ,[VAT Posting]&#xA;      ,[Payment Terms Code]&#xA;      ,[Applies-to ID]&#xA;      ,[Recurring Method]&#xA;      ,[Expiration Date]&#xA;      ,[Recurring Frequency]&#xA;      ,[VAT Calculation Type]&#xA;      ,[EU 3-Party Trade]&#xA;      ,[Allow Application]&#xA;      ,[Bal_ Gen_ Posting Type]&#xA;      ,[Bal_ Gen_ Bus_ Posting Group]&#xA;      ,[Bal_ Gen_ Prod_ Posting Group]&#xA;      ,[Bal_ VAT Calculation Type]&#xA;      ,[Bal_ VAT _]&#xA;      ,[Bal_ VAT Amount]&#xA;      ,[Bank Payment Type]&#xA;      ,[VAT Base Amount]&#xA;      ,[Bal_ VAT Base Amount]&#xA;      ,[Correction]&#xA;      ,[Check Printed]&#xA;      ,[Posting No_ Series]&#xA;      ,[Bal_ Tax Area Code]&#xA;      ,[Bal_ Tax Liable]&#xA;      ,[Bal_ Tax Group Code]&#xA;      ,[Bal_ Use Tax]&#xA;      ,[Bal_ VAT Bus_ Posting Group]&#xA;      ,[Bal_ VAT Prod_ Posting Group]&#xA;      ,[Additional-Currency Posting]&#xA;      ,[FA Add_-Currency Factor]&#xA;      ,[Source Currency Code]&#xA;      ,[Source Currency Amount]&#xA;      ,[Source Curr_ VAT Base Amount]&#xA;      ,[Source Curr_ VAT Amount]&#xA;      ,[VAT Base Discount _]&#xA;      ,[VAT Amount (LCY)]&#xA;      ,[VAT Base Amount (LCY)]&#xA;      ,[Bal_ VAT Amount (LCY)]&#xA;      ,[Bal_ VAT Base Amount (LCY)]&#xA;      ,[Reversing Entry]&#xA;      ,[Allow Zero-Amount Posting]&#xA;      ,[Ship-to_Order Address Code]&#xA;      ,[VAT Difference]&#xA;      ,[Bal_ VAT Difference]&#xA;      ,[IC Direction]&#xA;      ,[IC Partner G_L Acc_ No_]&#xA;      ,[IC Partner Transaction No_]&#xA;      ,[Sell-to_Buy-from No_]&#xA;      ,[VAT Registration No_]&#xA;      ,[Country_Region Code]&#xA;      ,[Prepayment]&#xA;      ,[Financial Void]&#xA;      ,[Incoming Document Entry No_]&#xA;      ,[Creditor No_]&#xA;      ,[Payment Reference]&#xA;      ,[Payment Method Code]&#xA;      ,[Applies-to Ext_ Doc_ No_]&#xA;      ,[Recipient Bank Account]&#xA;      ,[Message to Recipient]&#xA;      ,[Exported to Payment File]&#xA;      ,[Credit Card No_]&#xA;      ,[Job Task No_]&#xA;      ,[Job Unit Price (LCY)]&#xA;      ,[Job Total Price (LCY)]&#xA;      ,[Job Quantity]&#xA;      ,[Job Unit Cost (LCY)]&#xA;      ,[Job Line Discount _]&#xA;      ,[Job Line Disc_ Amount (LCY)]&#xA;      ,[Job Unit Of Measure Code]&#xA;      ,[Job Line Type]&#xA;      ,[Job Unit Price]&#xA;      ,[Job Total Price]&#xA;      ,[Job Unit Cost]&#xA;      ,[Job Total Cost]&#xA;      ,[Job Line Discount Amount]&#xA;      ,[Job Line Amount]&#xA;      ,[Job Total Cost (LCY)]&#xA;      ,[Job Line Amount (LCY)]&#xA;      ,[Job Currency Factor]&#xA;      ,[Job Currency Code]&#xA;      ,[Job Planning Line No_]&#xA;      ,[Job Remaining Qty_]&#xA;      ,[Direct Debit Mandate ID]&#xA;      ,[Data Exch_ Entry No_]&#xA;      ,[Payer Information]&#xA;      ,[Transaction Information]&#xA;      ,[Data Exch_ Line No_]&#xA;      ,[Applied Automatically]&#xA;      ,[Deferral Code]&#xA;      ,[Deferral Line No_]&#xA;      ,[Campaign No_]&#xA;      ,[FA Posting Date]&#xA;      ,[FA Posting Type]&#xA;      ,[Depreciation Book Code]&#xA;      ,[Salvage Value]&#xA;      ,[No_ of Depreciation Days]&#xA;      ,[Depr_ until FA Posting Date]&#xA;      ,[Depr_ Acquisition Cost]&#xA;      ,[Maintenance Code]&#xA;      ,[Insurance No_]&#xA;      ,[Budgeted FA No_]&#xA;      ,[Duplicate in Depreciation Book]&#xA;      ,[Use Duplication List]&#xA;      ,[FA Reclassification Entry]&#xA;      ,[FA Error Entry No_]&#xA;      ,[Index Entry]&#xA;      ,[Source Line No_]&#xA;      ,[Comment]&#xA;      ,[VAT Identifier]&#xA;      ,[Fiscal Code]&#xA;      ,[Deductible _]&#xA;      ,[Bal_ Deductible _]&#xA;      ,[Operation Occurred Date]&#xA;      ,[Reverse Sales VAT No_ Series]&#xA;      ,[Reverse Sales VAT No_]&#xA;      ,[Closing Balance Sheet]&#xA;      ,[Activity Code]&#xA;      ,[Service Tariff No_]&#xA;      ,[Transport Method]&#xA;      ,[Include in VAT Transac_ Rep_]&#xA;      ,[Resident]&#xA;      ,[Individual Person]&#xA;      ,[Related Entry No_]&#xA;      ,[First Name]&#xA;      ,[Last Name]&#xA;      ,[Date of Birth]&#xA;      ,[Tax Representative Type]&#xA;      ,[Tax Representative No_]&#xA;      ,[Place of Birth]&#xA;      ,[Refers to Period]&#xA;      ,[Contract No_]&#xA;      ,[Applies-to Occurrence No_]&#xA;      ,[Bank Receipt]&#xA;      ,[Cumulative Bank Receipts]&#xA;      ,[Document Type to Close]&#xA;      ,[Document No_ to Close]&#xA;      ,[Document Occurrence to Close]&#xA;      ,[Allow Issue]&#xA;      ,[Bill No_]&#xA;      ,[Competence Line]&#xA;      ,[Balance line competence]&#xA;      ,[Created from Accruals_Payable]&#xA;      ,[Ignore Direct Posting]&#xA;      ,[No Check Dimension]&#xA;      ,[Des_Rec_ Journal Template Name]&#xA;      ,[Des_ Rec_ Journal Batch Name]&#xA;      ,[Destin_ Journal Template Name]&#xA;      ,[Destin_ Journal Batch Name]&#xA;      ,[Account Type EXAC]&#xA;      ,[Bal_ Account Type EXAC]&#xA;      ,[Recurring]&#xA;      ,[Company])&#xA;   &#xA;   SELECT  [Gen_ Bus_ Posting Group]&#xA;      ,[ContoKey]&#xA;      ,[StagioneKey]&#xA;      ,[Tax Area Code]&#xA;      ,[Tax Liable]&#xA;      ,[VAT Bus_ Posting Group]&#xA;      ,[Dimension Set ID]&#xA;      ,[Posting Date]&#xA;      ,[Bal_ Account No_]&#xA;      ,[Reason Code]&#xA;      ,[Bal_ Account Type]&#xA;      ,[Document Date]&#xA;      ,[Source Code]&#xA;      ,[SourceType]&#xA;      ,[Source No_]&#xA;      ,[Document Type]&#xA;      ,[Document No_]&#xA;      ,[Description]&#xA;      ,[Amount]&#xA;      ,[System-Created Entry]&#xA;      ,[Job No_]&#xA;      ,[Quantity]&#xA;      ,[VAT Amount]&#xA;      ,[Business Unit Code]&#xA;      ,[Journal Batch Name]&#xA;      ,[Gen_ Posting Type]&#xA;      ,[Gen_ Prod_ Posting Group]&#xA;      ,[Debit Amount]&#xA;      ,[Credit Amount]&#xA;      ,[External Document No_]&#xA;      ,[Tax Group Code]&#xA;      ,[Use Tax]&#xA;      ,[VAT Prod_ Posting Group]&#xA;      ,[IC Partner Code]&#xA;      ,[Prod_ Order No_]&#xA;      ,[Due Date]&#xA;      ,[Letter No_]&#xA;      ,[Journal Template Name]&#xA;      ,[Line No_]&#xA;      ,[Account Type]&#xA;      ,[VAT _]&#xA;      ,[Currency Code]&#xA;      ,[Amount (LCY)]&#xA;      ,[Balance (LCY)]&#xA;      ,[Currency Factor]&#xA;      ,[Sales_Purch_ (LCY)]&#xA;      ,[Profit (LCY)]&#xA;      ,[Inv_ Discount (LCY)]&#xA;      ,[Bill-to_Pay-to No_]&#xA;      ,[Posting Group]&#xA;      ,[Marchio]&#xA;      ,[Salespers__Purch_ Code]&#xA;      ,[On Hold]&#xA;      ,[Applies-to Doc_ Type]&#xA;      ,[Applies-to Doc_ No_]&#xA;      ,[Pmt_ Discount Date]&#xA;      ,[Payment Discount _]&#xA;      ,[VAT Posting]&#xA;      ,[Payment Terms Code]&#xA;      ,[Applies-to ID]&#xA;      ,[Recurring Method]&#xA;      ,[Expiration Date]&#xA;      ,[Recurring Frequency]&#xA;      ,[VAT Calculation Type]&#xA;      ,[EU 3-Party Trade]&#xA;      ,[Allow Application]&#xA;      ,[Bal_ Gen_ Posting Type]&#xA;      ,[Bal_ Gen_ Bus_ Posting Group]&#xA;      ,[Bal_ Gen_ Prod_ Posting Group]&#xA;      ,[Bal_ VAT Calculation Type]&#xA;      ,[Bal_ VAT _]&#xA;      ,[Bal_ VAT Amount]&#xA;      ,[Bank Payment Type]&#xA;      ,[VAT Base Amount]&#xA;      ,[Bal_ VAT Base Amount]&#xA;      ,[Correction]&#xA;      ,[Check Printed]&#xA;      ,[Posting No_ Series]&#xA;      ,[Bal_ Tax Area Code]&#xA;      ,[Bal_ Tax Liable]&#xA;      ,[Bal_ Tax Group Code]&#xA;      ,[Bal_ Use Tax]&#xA;      ,[Bal_ VAT Bus_ Posting Group]&#xA;      ,[Bal_ VAT Prod_ Posting Group]&#xA;      ,[Additional-Currency Posting]&#xA;      ,[FA Add_-Currency Factor]&#xA;      ,[Source Currency Code]&#xA;      ,[Source Currency Amount]&#xA;      ,[Source Curr_ VAT Base Amount]&#xA;      ,[Source Curr_ VAT Amount]&#xA;      ,[VAT Base Discount _]&#xA;      ,[VAT Amount (LCY)]&#xA;      ,[VAT Base Amount (LCY)]&#xA;      ,[Bal_ VAT Amount (LCY)]&#xA;      ,[Bal_ VAT Base Amount (LCY)]&#xA;      ,[Reversing Entry]&#xA;      ,[Allow Zero-Amount Posting]&#xA;      ,[Ship-to_Order Address Code]&#xA;      ,[VAT Difference]&#xA;      ,[Bal_ VAT Difference]&#xA;      ,[IC Direction]&#xA;      ,[IC Partner G_L Acc_ No_]&#xA;      ,[IC Partner Transaction No_]&#xA;      ,[Sell-to_Buy-from No_]&#xA;      ,[VAT Registration No_]&#xA;      ,[Country_Region Code]&#xA;      ,[Prepayment]&#xA;      ,[Financial Void]&#xA;      ,[Incoming Document Entry No_]&#xA;      ,[Creditor No_]&#xA;      ,[Payment Reference]&#xA;      ,[Payment Method Code]&#xA;      ,[Applies-to Ext_ Doc_ No_]&#xA;      ,[Recipient Bank Account]&#xA;      ,[Message to Recipient]&#xA;      ,[Exported to Payment File]&#xA;      ,[Credit Card No_]&#xA;      ,[Job Task No_]&#xA;      ,[Job Unit Price (LCY)]&#xA;      ,[Job Total Price (LCY)]&#xA;      ,[Job Quantity]&#xA;      ,[Job Unit Cost (LCY)]&#xA;      ,[Job Line Discount _]&#xA;      ,[Job Line Disc_ Amount (LCY)]&#xA;      ,[Job Unit Of Measure Code]&#xA;      ,[Job Line Type]&#xA;      ,[Job Unit Price]&#xA;      ,[Job Total Price]&#xA;      ,[Job Unit Cost]&#xA;      ,[Job Total Cost]&#xA;      ,[Job Line Discount Amount]&#xA;      ,[Job Line Amount]&#xA;      ,[Job Total Cost (LCY)]&#xA;      ,[Job Line Amount (LCY)]&#xA;      ,[Job Currency Factor]&#xA;      ,[Job Currency Code]&#xA;      ,[Job Planning Line No_]&#xA;      ,[Job Remaining Qty_]&#xA;      ,[Direct Debit Mandate ID]&#xA;      ,[Data Exch_ Entry No_]&#xA;      ,[Payer Information]&#xA;      ,[Transaction Information]&#xA;      ,[Data Exch_ Line No_]&#xA;      ,[Applied Automatically]&#xA;      ,[Deferral Code]&#xA;      ,[Deferral Line No_]&#xA;      ,[Campaign No_]&#xA;      ,[FA Posting Date]&#xA;      ,[FA Posting Type]&#xA;      ,[Depreciation Book Code]&#xA;      ,[Salvage Value]&#xA;      ,[No_ of Depreciation Days]&#xA;      ,[Depr_ until FA Posting Date]&#xA;      ,[Depr_ Acquisition Cost]&#xA;      ,[Maintenance Code]&#xA;      ,[Insurance No_]&#xA;      ,[Budgeted FA No_]&#xA;      ,[Duplicate in Depreciation Book]&#xA;      ,[Use Duplication List]&#xA;      ,[FA Reclassification Entry]&#xA;      ,[FA Error Entry No_]&#xA;      ,[Index Entry]&#xA;      ,[Source Line No_]&#xA;      ,[Comment]&#xA;      ,[VAT Identifier]&#xA;      ,[Fiscal Code]&#xA;      ,[Deductible _]&#xA;      ,[Bal_ Deductible _]&#xA;      ,[Operation Occurred Date]&#xA;      ,[Reverse Sales VAT No_ Series]&#xA;      ,[Reverse Sales VAT No_]&#xA;      ,[Closing Balance Sheet]&#xA;      ,[Activity Code]&#xA;      ,[Service Tariff No_]&#xA;      ,[Transport Method]&#xA;      ,[Include in VAT Transac_ Rep_]&#xA;      ,[Resident]&#xA;      ,[Individual Person]&#xA;      ,[Related Entry No_]&#xA;      ,[First Name]&#xA;      ,[Last Name]&#xA;      ,[Date of Birth]&#xA;      ,[Tax Representative Type]&#xA;      ,[Tax Representative No_]&#xA;      ,[Place of Birth]&#xA;      ,[Refers to Period]&#xA;      ,[Contract No_]&#xA;      ,[Applies-to Occurrence No_]&#xA;      ,[Bank Receipt]&#xA;      ,[Cumulative Bank Receipts]&#xA;      ,[Document Type to Close]&#xA;      ,[Document No_ to Close]&#xA;      ,[Document Occurrence to Close]&#xA;      ,[Allow Issue]&#xA;      ,[Bill No_]&#xA;      ,[Competence Line]&#xA;      ,[Balance line competence]&#xA;      ,[Created from Accruals_Payable]&#xA;      ,[Ignore Direct Posting]&#xA;      ,[No Check Dimension]&#xA;      ,[Des_Rec_ Journal Template Name]&#xA;      ,[Des_ Rec_ Journal Batch Name]&#xA;      ,[Destin_ Journal Template Name]&#xA;      ,[Destin_ Journal Batch Name]&#xA;      ,[Account Type EXAC]&#xA;      ,[Bal_ Account Type EXAC]&#xA;      ,[Recurring]&#xA;      ,[Company]&#xA;        FROM [BI_Model_Stage].[stg].[vFactCOGEManutenzione] WITH (NOLOCK)" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Contabilità\FactExtraContabili"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Attività Esegui SQL"
          DTS:DTSID="{C2C207F7-8654-4910-AFBD-EC922BFA3DFD}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="FactExtraContabili"
          DTS:ThreadHint="3">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{01E748CB-DAFD-4EA7-920E-23E68DAB645E}"
              SQLTask:SqlStatementSource="INSERT INTO [BI_Model_DWH].[dbo].[FactExtraContabili]&#xA;           ([Gen_ Bus_ Posting Group]&#xA;      ,[Shortcut Dimension 3 Code]&#xA;      ,[CanaleKey]&#xA;      ,[StagioneKey]&#xA;      ,[Shortcut Dimension 5 Code]&#xA;      ,[Collezione]&#xA;      ,[PccdcKey]&#xA;      ,[SubcanaleKey]&#xA;      ,[Tax Area Code]&#xA;      ,[Tax Liable]&#xA;      ,[VAT Bus_ Posting Group]&#xA;      ,[Posting Date]&#xA;      ,[Bal_ Account No_]&#xA;      ,[Reason Code]&#xA;      ,[Bal_ Account Type]&#xA;      ,[Document Date]&#xA;      ,[No_ Series]&#xA;      ,[User ID]&#xA;      ,[Source Code]&#xA;      ,[Entry No_]&#xA;      ,[Document Type]&#xA;      ,[Document No_]&#xA;      ,[Description]&#xA;      ,[Amount]&#xA;      ,[Global Dimension 1 Code]&#xA;      ,[Marchio]&#xA;      ,[System-Created Entry]&#xA;      ,[Prior-Year Entry]&#xA;      ,[Job No_]&#xA;      ,[Quantity]&#xA;      ,[VAT Amount]&#xA;      ,[Business Unit Code]&#xA;      ,[Journal Batch Name]&#xA;      ,[Gen_ Posting Type]&#xA;      ,[Gen_ Prod_ Posting Group]&#xA;      ,[Transaction No_]&#xA;      ,[Debit Amount]&#xA;      ,[Credit Amount]&#xA;      ,[External Document No_]&#xA;      ,[Source Type]&#xA;      ,[Source No_]&#xA;      ,[Tax Group Code]&#xA;      ,[Use Tax]&#xA;      ,[VAT Prod_ Posting Group]&#xA;      ,[Close Income Statement Dim_ ID]&#xA;      ,[IC Partner Code]&#xA;      ,[Reversed]&#xA;      ,[Reversed by Entry No_]&#xA;      ,[Reversed Entry No_]&#xA;      ,[Prod_ Order No_]&#xA;      ,[Official Date]&#xA;      ,[Positive]&#xA;      ,[Due Date]&#xA;      ,[Letter No_]&#xA;      ,[Not Process]&#xA;      ,[Stagione]&#xA;      ,[Journal Line No_]&#xA;      ,[Journal Template Name]&#xA;      ,[G_L Register No_]&#xA;      ,[Tipo Operazione CDV]&#xA;      ,[Company]&#xA;      ,[ContoKey])&#xA;   &#xA;   SELECT  [Gen_ Bus_ Posting Group]&#xA;      ,[Shortcut Dimension 3 Code]&#xA;      ,[CanaleKey]&#xA;      ,[StagioneKey]&#xA;      ,[Shortcut Dimension 5 Code]&#xA;      ,[Collezione]&#xA;      ,[PccdcKey]&#xA;      ,[SubcanaleKey]&#xA;      ,[Tax Area Code]&#xA;      ,[Tax Liable]&#xA;      ,[VAT Bus_ Posting Group]&#xA;      ,[Posting Date]&#xA;      ,[Bal_ Account No_]&#xA;      ,[Reason Code]&#xA;      ,[Bal_ Account Type]&#xA;      ,[Document Date]&#xA;      ,[No_ Series]&#xA;      ,[User ID]&#xA;      ,[Source Code]&#xA;      ,[Entry No_]&#xA;      ,[Document Type]&#xA;      ,[Document No_]&#xA;      ,[Description]&#xA;      ,[Amount]&#xA;      ,[Global Dimension 1 Code]&#xA;      ,[Marchio]&#xA;      ,[System-Created Entry]&#xA;      ,[Prior-Year Entry]&#xA;      ,[Job No_]&#xA;      ,[Quantity]&#xA;      ,[VAT Amount]&#xA;      ,[Business Unit Code]&#xA;      ,[Journal Batch Name]&#xA;      ,[Gen_ Posting Type]&#xA;      ,[Gen_ Prod_ Posting Group]&#xA;      ,[Transaction No_]&#xA;      ,[Debit Amount]&#xA;      ,[Credit Amount]&#xA;      ,[External Document No_]&#xA;      ,[Source Type]&#xA;      ,[Source No_]&#xA;      ,[Tax Group Code]&#xA;      ,[Use Tax]&#xA;      ,[VAT Prod_ Posting Group]&#xA;      ,[Close Income Statement Dim_ ID]&#xA;      ,[IC Partner Code]&#xA;      ,[Reversed]&#xA;      ,[Reversed by Entry No_]&#xA;      ,[Reversed Entry No_]&#xA;      ,[Prod_ Order No_]&#xA;      ,[Official Date]&#xA;      ,[Positive]&#xA;      ,[Due Date]&#xA;      ,[Letter No_]&#xA;      ,[Not Process]&#xA;      ,[Stagione]&#xA;      ,[Journal Line No_]&#xA;      ,[Journal Template Name]&#xA;      ,[G_L Register No_]&#xA;      ,[Tipo Operazione CDV]&#xA;      ,[Company]&#xA;      ,[ContoKey]&#xA;        FROM [BI_Model_Stage].[stg].[vFactExtraContabili] WITH (NOLOCK)" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Contabilità\truncate"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Attività Esegui SQL"
          DTS:DTSID="{235D0721-E8BB-44B5-A4BD-959F18C1B496}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="truncate"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{01E748CB-DAFD-4EA7-920E-23E68DAB645E}"
              SQLTask:SqlStatementSource="TRUNCATE TABLE [BI_Model_DWH].[dbo].[FactAcquisto_Costi_Accessori_preventivi]" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Contabilità\truncate 4"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Attività Esegui SQL"
          DTS:DTSID="{5DCEBD00-B32F-4668-8217-0ED016BD5AD9}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="truncate 4"
          DTS:ThreadHint="3">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{01E748CB-DAFD-4EA7-920E-23E68DAB645E}"
              SQLTask:SqlStatementSource="TRUNCATE TABLE [BI_Model_DWH].[dbo].[FactExtraContabili]" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Contabilità\truncate 5"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Attività Esegui SQL"
          DTS:DTSID="{7A0ADD42-29AC-4AE4-90F5-AC59E23F66AC}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="truncate 5"
          DTS:ThreadHint="2">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{01E748CB-DAFD-4EA7-920E-23E68DAB645E}"
              SQLTask:SqlStatementSource="TRUNCATE TABLE [BI_Model_DWH].[dbo].[FactCOGEManutenzione]" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Contabilità\truncate 6"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Attività Esegui SQL"
          DTS:DTSID="{DC7FE45E-2C4D-4A6B-AFF9-3B1541DFF775}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="truncate 6"
          DTS:ThreadHint="1">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{01E748CB-DAFD-4EA7-920E-23E68DAB645E}"
              SQLTask:SqlStatementSource="TRUNCATE TABLE [BI_Model_DWH].[dbo].[FactAffidamentoClienti]" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:PrecedenceConstraints>
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Contabilità.PrecedenceConstraints[Vincolo]"
          DTS:CreationName=""
          DTS:DTSID="{35ED09AA-6116-47FB-9A2B-88CCE803A265}"
          DTS:From="Package\Contabilità\truncate"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Vincolo"
          DTS:To="Package\Contabilità\FactAcquisto_Costi_Accessori_preventivi" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Contabilità.PrecedenceConstraints[Vincolo 2 1]"
          DTS:CreationName=""
          DTS:DTSID="{1E4D725E-5BC8-4D81-90B5-C37491988F73}"
          DTS:From="Package\Contabilità\truncate 4"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Vincolo 2 1"
          DTS:To="Package\Contabilità\FactExtraContabili" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Contabilità.PrecedenceConstraints[Vincolo 2 1 1]"
          DTS:CreationName=""
          DTS:DTSID="{185CBB0A-5771-412B-B335-9115B0B5CD3E}"
          DTS:From="Package\Contabilità\truncate 5"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Vincolo 2 1 1"
          DTS:To="Package\Contabilità\FactCogeManutenzione" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Contabilità.PrecedenceConstraints[Vincolo 6]"
          DTS:CreationName=""
          DTS:DTSID="{91562442-46C9-49A5-8D29-C606D31841C3}"
          DTS:From="Package\Contabilità\truncate 6"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Vincolo 6"
          DTS:To="Package\Contabilità\FactAffidamentoClienti" />
      </DTS:PrecedenceConstraints>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Data Aggiornamento"
      DTS:CreationName="STOCK:SEQUENCE"
      DTS:Description="Contenitore Sequenza"
      DTS:DTSID="{F9677583-006D-447E-974A-DBA67ED009F1}"
      DTS:ExecutableType="STOCK:SEQUENCE"
      DTS:LocaleID="-1"
      DTS:ObjectName="Data Aggiornamento">
      <DTS:Variables />
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\Data Aggiornamento\Populate Data Aggiornamento"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Attività Esegui SQL"
          DTS:DTSID="{1873845F-9ADA-42E7-A808-4F17B83F9EA4}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Populate Data Aggiornamento"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; © 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{01E748CB-DAFD-4EA7-920E-23E68DAB645E}"
              SQLTask:SqlStatementSource="insert into [cfg].[DataUltimoAggiornamento] (  [DataOraUltimoAggiornamento] ) values (getdate())&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Data Aggiornamento\Truncate Data Aggiornamento"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Attività Esegui SQL"
          DTS:DTSID="{5863EB28-717B-4FCE-801D-C607E4D0C613}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Truncate Data Aggiornamento"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; © 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{01E748CB-DAFD-4EA7-920E-23E68DAB645E}"
              SQLTask:SqlStatementSource="truncate table [cfg].[DataUltimoAggiornamento]" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:PrecedenceConstraints>
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Data Aggiornamento.PrecedenceConstraints[Vincolo]"
          DTS:CreationName=""
          DTS:DTSID="{BCD96FE7-94A8-43D7-A9BF-3DC5B527ABD9}"
          DTS:From="Package\Data Aggiornamento\Truncate Data Aggiornamento"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Vincolo"
          DTS:To="Package\Data Aggiornamento\Populate Data Aggiornamento" />
      </DTS:PrecedenceConstraints>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Execute Update DimData"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Attività Esegui SQL"
      DTS:DTSID="{C8B047FB-54A4-4351-A0DE-3196E205F495}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Execute Update DimData"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; © 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{01E748CB-DAFD-4EA7-920E-23E68DAB645E}"
          SQLTask:SqlStatementSource="exec dbo.UpdateDimData" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Procedure in parallelo"
      DTS:CreationName="STOCK:SEQUENCE"
      DTS:Description="Contenitore Sequenza"
      DTS:DTSID="{1c6502cb-94e1-4be1-b2f0-2d4f55fe0cf1}"
      DTS:ExecutableType="STOCK:SEQUENCE"
      DTS:LocaleID="-1"
      DTS:ObjectName="Procedure in parallelo">
      <DTS:Variables />
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\Procedure in parallelo\SP_DELTA_MAIN_FACT_000"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Attività Esegui SQL"
          DTS:DTSID="{ea699ddc-943b-485e-a0cb-1cbfbb005a88}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="SP_DELTA_MAIN_FACT_000"
          DTS:ThreadHint="1">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{01E748CB-DAFD-4EA7-920E-23E68DAB645E}"
              SQLTask:SqlStatementSource="EXECUTE [dbo].[SP_DELTA_MAIN_FACT_000]" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Procedure in parallelo\SP_DELTA_MAIN_FACT_000_2parte"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Attività Esegui SQL"
          DTS:DTSID="{5f0d33b7-6839-4871-9bf3-56b84c19e81a}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="SP_DELTA_MAIN_FACT_000_2parte"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{01E748CB-DAFD-4EA7-920E-23E68DAB645E}"
              SQLTask:SqlStatementSource="EXECUTE [dbo].[SP_DELTA_MAIN_FACT_000_2parte] " xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Procedure in parallelo\SP_DELTA_MAIN_FACT_001"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Attività Esegui SQL"
          DTS:DTSID="{D02EA00C-FB09-41D1-BB6E-9E9EAF412884}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="SP_DELTA_MAIN_FACT_001"
          DTS:ThreadHint="2">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{01E748CB-DAFD-4EA7-920E-23E68DAB645E}"
              SQLTask:SqlStatementSource="EXECUTE [dbo].[SP_DELTA_MAIN_FACT_001]" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\SP_DELTA_MAIN_FACT_002"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Attività Esegui SQL"
      DTS:DTSID="{046AF44D-82E5-4AFE-9146-682224319CF7}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="SP_DELTA_MAIN_FACT_002"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{01E748CB-DAFD-4EA7-920E-23E68DAB645E}"
          SQLTask:SqlStatementSource="EXECUTE [dbo].[SP_DELTA_MAIN_FACT_002]" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Vincolo]"
      DTS:CreationName=""
      DTS:DTSID="{E84141E8-E889-4B68-A61F-89CAE6285D1F}"
      DTS:From="Package\Procedure in parallelo"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Vincolo"
      DTS:To="Package\SP_DELTA_MAIN_FACT_002" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Vincolo 1]"
      DTS:CreationName=""
      DTS:DTSID="{B95BFA20-F60E-48CA-B168-AAC308AB70DE}"
      DTS:From="Package\Data Aggiornamento"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Vincolo 1"
      DTS:To="Package\Execute Update DimData" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Vincolo 2]"
      DTS:CreationName=""
      DTS:DTSID="{D27FE452-6AC6-4557-8F80-FD6926FBD8C2}"
      DTS:From="Package\SP_DELTA_MAIN_FACT_002"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Vincolo 2"
      DTS:To="Package\Data Aggiornamento" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Vincolo 3]"
      DTS:CreationName=""
      DTS:DTSID="{4BD944D5-A252-49E1-BBE7-075760CFB209}"
      DTS:From="Package\Contabilità"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Vincolo 3"
      DTS:To="Package\Procedure in parallelo" />
  </DTS:PrecedenceConstraints>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--Questa sezione CDATA contiene le informazioni sul layout del pacchetto e include informazioni quali coordinate (x,y), larghezza e altezza.-->
<!--Se si modifica manualmente la sezione e si commette un errore, è possibile eliminarla. -->
<!--Sarà comunque possibile caricare manualmente il pacchetto, ma le informazioni precedenti sul layout verranno perse e gli elementi verranno nuovamente disposti nell'area di progettazione all'interno dell'apposita finestra.-->
<Objects
  Version="8">
  <!--Ogni nodo seguente conterrà proprietà che non influiscono sul comportamento di runtime.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="32" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="278.666666666667,42"
          Id="Package\Contabilità\FactAcquisto_Costi_Accessori_preventivi"
          TopLeft="5.4999999999998,107.833333333333" />
        <NodeLayout
          Size="185.333333333334,42.6666666666667"
          Id="Package\Contabilità\FactAffidamentoClienti"
          TopLeft="1023.16666666667,107.5" />
        <NodeLayout
          Size="278.666666666667,42"
          Id="Package\Contabilità\FactCogeManutenzione"
          TopLeft="683.5,107.833333333333" />
        <NodeLayout
          Size="278.666666666667,42"
          Id="Package\Contabilità\FactExtraContabili"
          TopLeft="344.5,107.833333333333" />
        <NodeLayout
          Size="118.666666666667,42"
          Id="Package\Contabilità\truncate"
          TopLeft="85.4999999999998,5.5" />
        <NodeLayout
          Size="127.333333333334,42"
          Id="Package\Contabilità\truncate 4"
          TopLeft="420.166666666666,5.5" />
        <NodeLayout
          Size="127.333333333334,42"
          Id="Package\Contabilità\truncate 5"
          TopLeft="759.166666666667,5.49999999999989" />
        <NodeLayout
          Size="118.666666666667,42"
          Id="Package\Contabilità\truncate 6"
          TopLeft="1056.5,5.49999999999989" />
        <EdgeLayout
          Id="Package\Contabilità.PrecedenceConstraints[Vincolo]"
          TopLeft="144.833333333333,47.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60.3333333333334"
              Start="0,0"
              End="0,52.8333333333334">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.8333333333334" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Contabilità.PrecedenceConstraints[Vincolo 2 1]"
          TopLeft="483.833333333333,47.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60.3333333333334"
              Start="0,0"
              End="0,52.8333333333334">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.8333333333334" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Contabilità.PrecedenceConstraints[Vincolo 2 1 1]"
          TopLeft="822.833333333333,47.4999999999999">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60.3333333333334"
              Start="0,0"
              End="0,52.8333333333334">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.8333333333334" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Contabilità.PrecedenceConstraints[Vincolo 6]"
          TopLeft="1115.83333333333,47.4999999999999">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="1214,205.333333333334"
          Size="1214,248"
          Id="Package\Contabilità"
          TopLeft="5.50000000000011,5.5" />
        <NodeLayout
          Size="221.333333333334,42.6666666666667"
          Id="Package\Data Aggiornamento\Populate Data Aggiornamento"
          TopLeft="5.50000000000001,107.5" />
        <NodeLayout
          Size="221.333333333334,42"
          Id="Package\Data Aggiornamento\Truncate Data Aggiornamento"
          TopLeft="5.50000000000001,5.5" />
        <EdgeLayout
          Id="Package\Data Aggiornamento.PrecedenceConstraints[Vincolo]"
          TopLeft="116.166666666667,47.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="232.666666666667,205.333333333334"
          Size="232.666666666667,248"
          Id="Package\Data Aggiornamento"
          TopLeft="496.166666666667,622.166666666667" />
        <NodeLayout
          Size="197.333333333334,42"
          Id="Package\Execute Update DimData"
          TopLeft="513.833333333333,930.166666666667" />
        <NodeLayout
          Size="213.333333333334,42.6666666666667"
          Id="Package\Procedure in parallelo\SP_DELTA_MAIN_FACT_000"
          TopLeft="5.49999999999996,5.50000000000004" />
        <NodeLayout
          Size="249.333333333334,42.6666666666667"
          Id="Package\Procedure in parallelo\SP_DELTA_MAIN_FACT_000_2parte"
          TopLeft="279.5,5.49999999999993" />
        <NodeLayout
          Size="213.333333333334,42.6666666666667"
          Id="Package\Procedure in parallelo\SP_DELTA_MAIN_FACT_001"
          TopLeft="589.5,5.49999999999993" />
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="808,103.333333333334"
          Size="808,146"
          Id="Package\Procedure in parallelo"
          TopLeft="208.5,313.5" />
        <NodeLayout
          Size="213.333333333334,42.6666666666667"
          Id="Package\SP_DELTA_MAIN_FACT_002"
          TopLeft="505.833333333333,519.5" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Vincolo]"
          TopLeft="612.5,459.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Vincolo 1]"
          TopLeft="612.5,870.166666666667">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Vincolo 2]"
          TopLeft="612.5,562.166666666667">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60.0000000000001"
              Start="0,0"
              End="0,52.5000000000001">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5000000000001" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Vincolo 3]"
          TopLeft="612.5,253.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>